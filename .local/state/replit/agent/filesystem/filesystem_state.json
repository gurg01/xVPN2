{"file_contents":{"replit.md":{"content":"# replit.md\n\n## Overview\n\nxVPN is a mobile VPN client application built with Expo (React Native), an Express proxy server, and a FastAPI (Python) backend. It offers a dark-themed UI for simulating VPN connectivity, featuring server selection across 50 global locations, live telemetry, connection management, a world map visualization, and various settings like protocol selection, kill switch, auto-connect, biometric lock, DNS leak protection, and ad blocker. The application also includes a premium subscription system. It simulates VPN connection states and network statistics rather than providing actual VPN tunneling.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend (Expo / React Native)\n\n- **Framework**: Expo SDK 54 with React Native 0.81, utilizing the new architecture and React Compiler.\n- **Routing**: File-based routing with `expo-router` v6, supporting typed routes and a tab-based layout with fade animations.\n- **Authentication**: Login/Signup flow with `expo-secure-store` (SecureStore) for persistent sessions. Falls back to AsyncStorage on web. Users stay logged in until they sign out. Auth gate wraps the entire app.\n- **Biometric Gate**: Uses `expo-local-authentication` for Face ID/fingerprint lock on app launch and resume. Shows a full-screen lock overlay until authenticated. Configurable via Settings.\n- **State Management**: VPN connection state, client-side fingerprint shield settings, and server-side data fetching (using `@tanstack/react-query`) are managed through React Contexts and AsyncStorage.\n- **UI Design**: Features a dark cyberpunk/futuristic theme with glass-morphism effects, animated elements (orbs, SVG visualizations), and guarded haptic feedback. Key components include `NoiseBackground`, `GlassCard`, `PowerButton`, `WorldMap`, and `LiveTelemetry`.\n- **Animations**: `react-native-reanimated` v4 is used for smooth animations and transitions, including a full-screen \"Radar Scanning\" effect.\n- **Fonts**: Custom Google Fonts: Space Grotesk and Orbitron.\n- **Platform Support**: Supports iOS, Android, and Web, with platform-specific adaptations.\n\n### Backend (FastAPI / Python)\n\n- **Framework**: FastAPI on Python 3.11 with Uvicorn.\n- **Authentication**: JWT-based system with bcrypt hashing for user registration, login, token refresh, and profile management. All VPN-related endpoints require authentication.\n- **API Endpoints**: Comprehensive set of API endpoints for authentication, simulated VPN connection management, status updates, server listings, security checks, disconnection, obfuscation configuration, kill switch management, multi-hop VPN, fingerprint shield configuration, and a no-logs policy.\n- **Database**: Uses SQLite via SQLAlchemy for User and ServerLog models. User profiles store preferences, subscription tier, and session stats. Server logs are purged every 5 minutes without identifying data.\n- **Session Management**: In-memory tracking of active VPN connections and kill switch registry.\n- **Kill Switch Engine**: Monitors heartbeats, auto-terminates inactive sessions, and engages network locks via simulated firewall rules.\n- **Multi-Hop (Double VPN)**: Simulates routing traffic through two server nodes with dual encryption layers, offering pre-configured privacy-optimized routes.\n- **Fingerprinting Shield**: Strips/normalizes identifying headers, spoofs canvas, WebGL, audio context, screen resolution, timezone, font enumeration, TCP OS fingerprint, TLS JA3 hash, and HTTP/2 SETTINGS.\n- **Obfuscation Engine**: Includes residential proxy middleware (simulating routing through residential IPs) and stealth mode (wrapping WireGuard traffic in Shadowsocks, V2Ray VMess, or obfs4 to mimic HTTPS traffic).\n\n### Express Proxy Server\n\n- **Framework**: Express v5 with Node.js and TypeScript.\n- **Proxy**: Proxies all `/api` routes to the FastAPI backend using `http-proxy-middleware`.\n- **CORS**: Configured to allow Replit domains and localhost for development.\n- **Static Serving**: Serves a pre-built Expo web bundle in production; otherwise, a landing page is displayed.\n\n### Database (Drizzle ORM)\n\n- **ORM**: Drizzle ORM configured for PostgreSQL, with schema defined in `shared/schema.ts` for a `users` table.\n- **Migrations**: Managed via a `./migrations` directory.\n- **Note**: The database setup is in place, but current storage is in-memory.\n\n### Build & Development\n\n- **Dev mode**: Runs Expo dev server, Express proxy, and FastAPI concurrently.\n- **Production build**: Expo web is statically built, and the Express server serves this build.\n\n## External Dependencies\n\n- **Database**: PostgreSQL via `pg` driver (configured for Drizzle ORM).\n- **AsyncStorage**: `@react-native-async-storage/async-storage` for client-side persistence.\n- **Expo Services**: Modules for haptics, image handling, gradients, blur effects, SVG, location, and web browser functionality.\n- **Python**: FastAPI, Uvicorn, Pydantic.\n- **Environment Variables**: `DATABASE_URL`, `REPLIT_DEV_DOMAIN`, `EXPO_PUBLIC_DOMAIN`, `REPLIT_DOMAINS`.","path":null,"size_bytes":5075,"size_tokens":null},"shared/shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n","path":null,"size_bytes":594,"size_tokens":null},"lib/fingerprint-shield.ts":{"content":"import { Platform } from 'react-native';\n\nconst CITY_TIMEZONES: Record<string, { tz: string; offset: number }> = {\n  'New York': { tz: 'America/New_York', offset: -5 },\n  'Los Angeles': { tz: 'America/Los_Angeles', offset: -8 },\n  'Dallas, TX': { tz: 'America/Chicago', offset: -6 },\n  'Miami, FL': { tz: 'America/New_York', offset: -5 },\n  'Chicago, IL': { tz: 'America/Chicago', offset: -6 },\n  'Seattle, WA': { tz: 'America/Los_Angeles', offset: -8 },\n  'Atlanta, GA': { tz: 'America/New_York', offset: -5 },\n  'Denver, CO': { tz: 'America/Denver', offset: -7 },\n  'Phoenix, AZ': { tz: 'America/Phoenix', offset: -7 },\n  'San Francisco, CA': { tz: 'America/Los_Angeles', offset: -8 },\n  'Washington, DC': { tz: 'America/New_York', offset: -5 },\n  'Houston, TX': { tz: 'America/Chicago', offset: -6 },\n  'Toronto': { tz: 'America/Toronto', offset: -5 },\n  'Vancouver': { tz: 'America/Vancouver', offset: -8 },\n  'Montreal': { tz: 'America/Toronto', offset: -5 },\n  'London': { tz: 'Europe/London', offset: 0 },\n  'Manchester': { tz: 'Europe/London', offset: 0 },\n  'Frankfurt': { tz: 'Europe/Berlin', offset: 1 },\n  'Berlin': { tz: 'Europe/Berlin', offset: 1 },\n  'Paris': { tz: 'Europe/Paris', offset: 1 },\n  'Marseille': { tz: 'Europe/Paris', offset: 1 },\n  'Amsterdam': { tz: 'Europe/Amsterdam', offset: 1 },\n  'Zurich': { tz: 'Europe/Zurich', offset: 1 },\n  'Stockholm': { tz: 'Europe/Stockholm', offset: 1 },\n  'Oslo': { tz: 'Europe/Oslo', offset: 1 },\n  'Copenhagen': { tz: 'Europe/Copenhagen', offset: 1 },\n  'Madrid': { tz: 'Europe/Madrid', offset: 1 },\n  'Milan': { tz: 'Europe/Rome', offset: 1 },\n  'Vienna': { tz: 'Europe/Vienna', offset: 1 },\n  'Warsaw': { tz: 'Europe/Warsaw', offset: 1 },\n  'Dublin': { tz: 'Europe/Dublin', offset: 0 },\n  'Tokyo': { tz: 'Asia/Tokyo', offset: 9 },\n  'Osaka': { tz: 'Asia/Tokyo', offset: 9 },\n  'Singapore': { tz: 'Asia/Singapore', offset: 8 },\n  'Seoul': { tz: 'Asia/Seoul', offset: 9 },\n  'Hong Kong': { tz: 'Asia/Hong_Kong', offset: 8 },\n  'Taipei': { tz: 'Asia/Taipei', offset: 8 },\n  'Sydney': { tz: 'Australia/Sydney', offset: 11 },\n  'Melbourne': { tz: 'Australia/Melbourne', offset: 11 },\n  'Auckland': { tz: 'Pacific/Auckland', offset: 13 },\n  'Sao Paulo': { tz: 'America/Sao_Paulo', offset: -3 },\n  'Mexico City': { tz: 'America/Mexico_City', offset: -6 },\n  'Buenos Aires': { tz: 'America/Argentina/Buenos_Aires', offset: -3 },\n  'Mumbai': { tz: 'Asia/Kolkata', offset: 5.5 },\n  'Chennai': { tz: 'Asia/Kolkata', offset: 5.5 },\n  'Dubai': { tz: 'Asia/Dubai', offset: 4 },\n  'Tel Aviv': { tz: 'Asia/Jerusalem', offset: 2 },\n  'Johannesburg': { tz: 'Africa/Johannesburg', offset: 2 },\n  'Bucharest': { tz: 'Europe/Bucharest', offset: 2 },\n  'Prague': { tz: 'Europe/Prague', offset: 1 },\n};\n\nconst SERVER_TIMEZONES: Record<string, string> = {\n  'US': 'America/New_York',\n  'GB': 'Europe/London',\n  'DE': 'Europe/Berlin',\n  'JP': 'Asia/Tokyo',\n  'SG': 'Asia/Singapore',\n  'AU': 'Australia/Sydney',\n  'CA': 'America/Toronto',\n  'NL': 'Europe/Amsterdam',\n  'CH': 'Europe/Zurich',\n  'FR': 'Europe/Paris',\n  'KR': 'Asia/Seoul',\n  'BR': 'America/Sao_Paulo',\n  'IN': 'Asia/Kolkata',\n  'SE': 'Europe/Stockholm',\n  'NO': 'Europe/Oslo',\n  'DK': 'Europe/Copenhagen',\n  'ES': 'Europe/Madrid',\n  'IT': 'Europe/Rome',\n  'AT': 'Europe/Vienna',\n  'PL': 'Europe/Warsaw',\n  'IE': 'Europe/Dublin',\n  'HK': 'Asia/Hong_Kong',\n  'TW': 'Asia/Taipei',\n  'NZ': 'Pacific/Auckland',\n  'MX': 'America/Mexico_City',\n  'AR': 'America/Argentina/Buenos_Aires',\n  'AE': 'Asia/Dubai',\n  'IL': 'Asia/Jerusalem',\n  'ZA': 'Africa/Johannesburg',\n  'RO': 'Europe/Bucharest',\n  'CZ': 'Europe/Prague',\n};\n\nconst SERVER_TIMEZONE_OFFSETS: Record<string, number> = {\n  'US': -5,\n  'GB': 0,\n  'DE': 1,\n  'JP': 9,\n  'SG': 8,\n  'AU': 11,\n  'CA': -5,\n  'NL': 1,\n  'CH': 1,\n  'FR': 1,\n  'KR': 9,\n  'BR': -3,\n  'IN': 5.5,\n  'SE': 1,\n  'NO': 1,\n  'DK': 1,\n  'ES': 1,\n  'IT': 1,\n  'AT': 1,\n  'PL': 1,\n  'IE': 0,\n  'HK': 8,\n  'TW': 8,\n  'NZ': 13,\n  'MX': -6,\n  'AR': -3,\n  'AE': 4,\n  'IL': 2,\n  'ZA': 2,\n  'RO': 2,\n  'CZ': 1,\n};\n\nconst USER_AGENTS = {\n  windows_chrome: [\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36',\n  ],\n  windows_firefox: [\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0',\n  ],\n  mac_safari: [\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 14_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Safari/605.1.15',\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Safari/605.1.15',\n  ],\n  mac_chrome: [\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36',\n  ],\n  iphone_safari: [\n    'Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1',\n    'Mozilla/5.0 (iPhone; CPU iPhone OS 17_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1',\n  ],\n};\n\nexport type UserAgentProfile = keyof typeof USER_AGENTS;\n\nexport const USER_AGENT_LABELS: Record<UserAgentProfile, string> = {\n  windows_chrome: 'Windows / Chrome',\n  windows_firefox: 'Windows / Firefox',\n  mac_safari: 'Mac / Safari',\n  mac_chrome: 'Mac / Chrome',\n  iphone_safari: 'iPhone / Safari',\n};\n\nexport interface FingerprintShieldState {\n  webrtcMask: boolean;\n  timezoneSpoofing: boolean;\n  canvasNoise: boolean;\n  userAgentRotation: boolean;\n  activeUserAgent: UserAgentProfile;\n  spoofedTimezone: string | null;\n  currentUserAgentString: string | null;\n  canvasNoiseLevel: number;\n}\n\nexport const DEFAULT_SHIELD_STATE: FingerprintShieldState = {\n  webrtcMask: true,\n  timezoneSpoofing: true,\n  canvasNoise: true,\n  userAgentRotation: false,\n  activeUserAgent: 'windows_chrome',\n  spoofedTimezone: null,\n  currentUserAgentString: null,\n  canvasNoiseLevel: 0.02,\n};\n\nexport function getTimezoneForServer(serverFlag: string, city?: string): string {\n  if (city) {\n    const cityData = CITY_TIMEZONES[city];\n    if (cityData) return cityData.tz;\n  }\n  return SERVER_TIMEZONES[serverFlag] || 'America/New_York';\n}\n\nexport function getTimezoneOffsetForServer(serverFlag: string, city?: string): number {\n  if (city) {\n    const cityData = CITY_TIMEZONES[city];\n    if (cityData) return cityData.offset;\n  }\n  const offset = SERVER_TIMEZONE_OFFSETS[serverFlag];\n  return offset !== undefined ? offset : -5;\n}\n\nexport function getRandomUserAgent(profile: UserAgentProfile): string {\n  const agents = USER_AGENTS[profile];\n  return agents[Math.floor(Math.random() * agents.length)];\n}\n\nexport function rotateUserAgent(currentProfile: UserAgentProfile): UserAgentProfile {\n  const profiles = Object.keys(USER_AGENTS) as UserAgentProfile[];\n  const currentIndex = profiles.indexOf(currentProfile);\n  return profiles[(currentIndex + 1) % profiles.length];\n}\n\nexport function generateCanvasNoise(noiseLevel: number = 0.02): number[] {\n  const noiseData: number[] = [];\n  for (let i = 0; i < 16; i++) {\n    noiseData.push((Math.random() - 0.5) * 2 * noiseLevel * 255);\n  }\n  return noiseData;\n}\n\nexport interface WebRTCLeakStatus {\n  blocked: boolean;\n  localIpHidden: boolean;\n  stunBlocked: boolean;\n  turnBlocked: boolean;\n  mdnsEnabled: boolean;\n}\n\nexport function getWebRTCLeakStatus(maskEnabled: boolean): WebRTCLeakStatus {\n  if (maskEnabled) {\n    return {\n      blocked: true,\n      localIpHidden: true,\n      stunBlocked: true,\n      turnBlocked: true,\n      mdnsEnabled: true,\n    };\n  }\n  return {\n    blocked: false,\n    localIpHidden: false,\n    stunBlocked: false,\n    turnBlocked: false,\n    mdnsEnabled: false,\n  };\n}\n\nexport interface CanvasProtectionStatus {\n  noiseInjected: boolean;\n  noiseLevel: number;\n  hashRandomized: boolean;\n  gpuInfoMasked: boolean;\n}\n\nexport function getCanvasProtectionStatus(enabled: boolean, noiseLevel: number): CanvasProtectionStatus {\n  if (enabled) {\n    return {\n      noiseInjected: true,\n      noiseLevel,\n      hashRandomized: true,\n      gpuInfoMasked: true,\n    };\n  }\n  return {\n    noiseInjected: false,\n    noiseLevel: 0,\n    hashRandomized: false,\n    gpuInfoMasked: false,\n  };\n}\n\nexport interface TimezoneProtectionStatus {\n  spoofed: boolean;\n  originalTimezone: string;\n  spoofedTimezone: string | null;\n  offsetMatch: boolean;\n  intlApiPatched: boolean;\n  dateApiPatched: boolean;\n}\n\nexport function getTimezoneProtectionStatus(\n  enabled: boolean,\n  serverFlag: string | null\n): TimezoneProtectionStatus {\n  const original = Intl.DateTimeFormat().resolvedOptions().timeZone;\n  if (enabled && serverFlag) {\n    const spoofed = getTimezoneForServer(serverFlag);\n    return {\n      spoofed: true,\n      originalTimezone: original,\n      spoofedTimezone: spoofed,\n      offsetMatch: true,\n      intlApiPatched: true,\n      dateApiPatched: true,\n    };\n  }\n  return {\n    spoofed: false,\n    originalTimezone: original,\n    spoofedTimezone: null,\n    offsetMatch: false,\n    intlApiPatched: false,\n    dateApiPatched: false,\n  };\n}\n\nexport interface ShieldSummary {\n  totalProtections: number;\n  activeProtections: number;\n  protectionLevel: 'none' | 'basic' | 'moderate' | 'maximum';\n  webrtc: WebRTCLeakStatus;\n  canvas: CanvasProtectionStatus;\n  timezone: TimezoneProtectionStatus;\n  userAgent: {\n    rotated: boolean;\n    profile: UserAgentProfile;\n    currentString: string | null;\n  };\n}\n\nexport function getShieldSummary(\n  state: FingerprintShieldState,\n  serverFlag: string | null\n): ShieldSummary {\n  const webrtc = getWebRTCLeakStatus(state.webrtcMask);\n  const canvas = getCanvasProtectionStatus(state.canvasNoise, state.canvasNoiseLevel);\n  const timezone = getTimezoneProtectionStatus(state.timezoneSpoofing, serverFlag);\n\n  const activeCount = [state.webrtcMask, state.timezoneSpoofing, state.canvasNoise, state.userAgentRotation].filter(Boolean).length;\n\n  let level: ShieldSummary['protectionLevel'] = 'none';\n  if (activeCount === 4) level = 'maximum';\n  else if (activeCount >= 2) level = 'moderate';\n  else if (activeCount >= 1) level = 'basic';\n\n  return {\n    totalProtections: 4,\n    activeProtections: activeCount,\n    protectionLevel: level,\n    webrtc,\n    canvas,\n    timezone,\n    userAgent: {\n      rotated: state.userAgentRotation,\n      profile: state.activeUserAgent,\n      currentString: state.currentUserAgentString,\n    },\n  };\n}\n","path":null,"size_bytes":10816,"size_tokens":null},"components/components/LiveTelemetry.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withRepeat,\n  withTiming,\n  Easing,\n  interpolate,\n} from 'react-native-reanimated';\nimport { Ionicons } from '@expo/vector-icons';\nimport { GlassCard } from '@/components/GlassCard';\nimport Colors from '@/constants/colors';\n\ninterface LiveTelemetryProps {\n  isConnected: boolean;\n  downloadSpeed: number;\n  uploadSpeed: number;\n  sessionDuration: number;\n  ping: number;\n  dataUsed: number;\n}\n\nfunction formatDuration(seconds: number): string {\n  const h = Math.floor(seconds / 3600);\n  const m = Math.floor((seconds % 3600) / 60);\n  const s = seconds % 60;\n  return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\n}\n\nfunction AnimatedBar({ value, maxValue, color }: { value: number; maxValue: number; color: string }) {\n  const barPulse = useSharedValue(0.6);\n\n  useEffect(() => {\n    if (value > 0) {\n      barPulse.value = withRepeat(withTiming(1, { duration: 800, easing: Easing.inOut(Easing.ease) }), -1, true);\n    } else {\n      barPulse.value = withTiming(0.3);\n    }\n  }, [value > 0]);\n\n  const barStyle = useAnimatedStyle(() => ({\n    opacity: barPulse.value,\n  }));\n\n  const progress = Math.min(value / maxValue, 1);\n  const barCount = 12;\n  const activeBars = Math.round(progress * barCount);\n\n  return (\n    <View style={barStyles.container}>\n      {Array.from({ length: barCount }).map((_, i) => (\n        <Animated.View\n          key={i}\n          style={[\n            barStyles.bar,\n            {\n              backgroundColor: i < activeBars ? color : 'rgba(255,255,255,0.06)',\n              height: 4 + (i * 1.5),\n            },\n            i < activeBars ? barStyle : undefined,\n          ]}\n        />\n      ))}\n    </View>\n  );\n}\n\nconst barStyles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    gap: 2,\n    height: 24,\n  },\n  bar: {\n    width: 3,\n    borderRadius: 1.5,\n    minHeight: 4,\n  },\n});\n\nfunction TelemetryCard({ icon, iconColor, label, value, unit, barValue, barMax, barColor }: {\n  icon: string;\n  iconColor: string;\n  label: string;\n  value: string;\n  unit: string;\n  barValue: number;\n  barMax: number;\n  barColor: string;\n}) {\n  return (\n    <GlassCard style={telStyles.card} intensity=\"low\">\n      <View style={telStyles.topRow}>\n        <View style={telStyles.iconWrap}>\n          <Ionicons name={icon as any} size={14} color={iconColor} />\n        </View>\n        <AnimatedBar value={barValue} maxValue={barMax} color={barColor} />\n      </View>\n      <View style={telStyles.valueRow}>\n        <Text style={[telStyles.value, { color: iconColor }]}>{value}</Text>\n        <Text style={telStyles.unit}>{unit}</Text>\n      </View>\n      <Text style={telStyles.label}>{label}</Text>\n    </GlassCard>\n  );\n}\n\nconst telStyles = StyleSheet.create({\n  card: {\n    flex: 1,\n    padding: 12,\n  },\n  topRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-end',\n    marginBottom: 8,\n  },\n  iconWrap: {\n    width: 26,\n    height: 26,\n    borderRadius: 8,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  valueRow: {\n    flexDirection: 'row',\n    alignItems: 'baseline',\n    gap: 3,\n  },\n  value: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 18,\n  },\n  unit: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 10,\n    color: '#FFFFFF',\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  label: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 10,\n    color: Colors.dark.accent,\n    marginTop: 2,\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n});\n\nexport function LiveTelemetry({ isConnected, downloadSpeed, uploadSpeed, sessionDuration, ping, dataUsed }: LiveTelemetryProps) {\n  return (\n    <View style={styles.container}>\n      <View style={styles.row}>\n        <TelemetryCard\n          icon=\"arrow-down\"\n          iconColor={Colors.dark.accent}\n          label=\"Download\"\n          value={isConnected ? downloadSpeed.toFixed(1) : '0.0'}\n          unit=\"Mbps\"\n          barValue={isConnected ? downloadSpeed : 0}\n          barMax={150}\n          barColor={Colors.dark.accent}\n        />\n        <TelemetryCard\n          icon=\"arrow-up\"\n          iconColor={Colors.dark.accentPurple}\n          label=\"Upload\"\n          value={isConnected ? uploadSpeed.toFixed(1) : '0.0'}\n          unit=\"Mbps\"\n          barValue={isConnected ? uploadSpeed : 0}\n          barMax={60}\n          barColor={Colors.dark.accentPurple}\n        />\n      </View>\n      <View style={styles.row}>\n        <TelemetryCard\n          icon=\"time-outline\"\n          iconColor={Colors.dark.accentCoral}\n          label=\"Session\"\n          value={isConnected ? formatDuration(sessionDuration) : '00:00:00'}\n          unit=\"\"\n          barValue={isConnected ? Math.min(sessionDuration, 3600) : 0}\n          barMax={3600}\n          barColor={Colors.dark.accentCoral}\n        />\n        <TelemetryCard\n          icon=\"pulse-outline\"\n          iconColor={Colors.dark.warning}\n          label=\"Latency\"\n          value={isConnected ? ping.toString() : '0'}\n          unit=\"ms\"\n          barValue={isConnected ? ping : 0}\n          barMax={200}\n          barColor={Colors.dark.warning}\n        />\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    paddingHorizontal: 20,\n    gap: 10,\n  },\n  row: {\n    flexDirection: 'row',\n    gap: 10,\n  },\n});\n","path":null,"size_bytes":5751,"size_tokens":null},"components/components/SecuritySuitePanel.tsx":{"content":"import React, { useEffect, useState } from 'react';\nimport { View, Text, StyleSheet, Modal, Pressable, ScrollView, Switch, Platform, Dimensions } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withTiming,\n  withSpring,\n  Easing,\n  SlideInRight,\n  SlideOutRight,\n} from 'react-native-reanimated';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport Svg, { Line, Circle, Rect } from 'react-native-svg';\nimport * as Haptics from 'expo-haptics';\nimport { GlassCard } from '@/components/GlassCard';\nimport { useVpn } from '@/lib/vpn-context';\nimport Colors from '@/constants/colors';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\nconst PANEL_WIDTH = Math.min(SCREEN_WIDTH * 0.92, 400);\n\nconst PROTOCOLS = ['WireGuard', 'OpenVPN', 'Stealth'];\n\ninterface SecuritySuitePanelProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\nfunction MultiHopVisual({ entry, exit, enabled }: { entry: string; exit: string; enabled: boolean }) {\n  const opacity = enabled ? 1 : 0.3;\n  const lineColor = enabled ? Colors.dark.accentPurple : 'rgba(255,255,255,0.1)';\n  const nodeActiveColor = enabled ? Colors.dark.accent : 'rgba(255,255,255,0.15)';\n  const hopColor = enabled ? Colors.dark.accentPurple : 'rgba(255,255,255,0.1)';\n\n  return (\n    <View style={[hopStyles.container, { opacity }]}>\n      <View style={hopStyles.row}>\n        <View style={hopStyles.nodeColumn}>\n          <View style={[hopStyles.node, { borderColor: nodeActiveColor }]}>\n            <MaterialCommunityIcons name=\"laptop\" size={16} color={nodeActiveColor} />\n          </View>\n          <Text style={hopStyles.nodeLabel}>You</Text>\n        </View>\n\n        <View style={hopStyles.lineSection}>\n          <Svg height={24} width={60}>\n            <Line x1={0} y1={12} x2={60} y2={12} stroke={lineColor} strokeWidth={1.5} strokeDasharray=\"4 3\" />\n            <Circle cx={20} cy={12} r={2} fill={lineColor} />\n            <Circle cx={40} cy={12} r={2} fill={lineColor} />\n          </Svg>\n          <Text style={[hopStyles.lineLabel, { color: lineColor }]}>AES-256</Text>\n        </View>\n\n        <View style={hopStyles.nodeColumn}>\n          <View style={[hopStyles.node, { borderColor: hopColor, backgroundColor: enabled ? 'rgba(195,0,255,0.08)' : 'transparent' }]}>\n            <Ionicons name=\"server-outline\" size={14} color={hopColor} />\n          </View>\n          <Text style={[hopStyles.nodeLabel, { color: hopColor }]} numberOfLines={1}>{entry}</Text>\n        </View>\n\n        <View style={hopStyles.lineSection}>\n          <Svg height={24} width={60}>\n            <Line x1={0} y1={12} x2={60} y2={12} stroke={hopColor} strokeWidth={1.5} strokeDasharray=\"4 3\" />\n            <Circle cx={20} cy={12} r={2} fill={hopColor} />\n            <Circle cx={40} cy={12} r={2} fill={hopColor} />\n          </Svg>\n          <Text style={[hopStyles.lineLabel, { color: hopColor }]}>ChaCha20</Text>\n        </View>\n\n        <View style={hopStyles.nodeColumn}>\n          <View style={[hopStyles.node, { borderColor: nodeActiveColor, backgroundColor: enabled ? 'rgba(0,240,255,0.08)' : 'transparent' }]}>\n            <Ionicons name=\"globe-outline\" size={14} color={nodeActiveColor} />\n          </View>\n          <Text style={[hopStyles.nodeLabel, { color: nodeActiveColor }]} numberOfLines={1}>{exit}</Text>\n        </View>\n      </View>\n    </View>\n  );\n}\n\nconst hopStyles = StyleSheet.create({\n  container: {\n    paddingVertical: 12,\n    paddingHorizontal: 4,\n  },\n  row: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  nodeColumn: {\n    alignItems: 'center',\n    gap: 4,\n    width: 52,\n  },\n  node: {\n    width: 38,\n    height: 38,\n    borderRadius: 12,\n    borderWidth: 1.5,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  nodeLabel: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    textAlign: 'center',\n  },\n  lineSection: {\n    alignItems: 'center',\n    gap: 2,\n    flex: 1,\n  },\n  lineLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 6,\n    letterSpacing: 1,\n  },\n});\n\nfunction HopServerSelector({ servers, selectedId, onSelect, label }: {\n  servers: { id: string; name: string; city: string }[];\n  selectedId: string | undefined;\n  onSelect: (id: string) => void;\n  label: string;\n}) {\n  const [expanded, setExpanded] = useState(false);\n  const selected = servers.find(s => s.id === selectedId);\n\n  return (\n    <View style={selectorStyles.container}>\n      <Text style={selectorStyles.label}>{label}</Text>\n      <Pressable\n        style={selectorStyles.trigger}\n        onPress={() => {\n          Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n          setExpanded(!expanded);\n        }}\n      >\n        <Text style={selectorStyles.triggerText}>{selected ? `${selected.name} - ${selected.city}` : 'Select'}</Text>\n        <Ionicons name={expanded ? 'chevron-up' : 'chevron-down'} size={14} color={Colors.dark.textMuted} />\n      </Pressable>\n      {expanded && (\n        <View style={selectorStyles.list}>\n          {servers.map(s => (\n            <Pressable\n              key={s.id}\n              style={[selectorStyles.option, s.id === selectedId && selectorStyles.optionActive]}\n              onPress={() => {\n                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                onSelect(s.id);\n                setExpanded(false);\n              }}\n            >\n              <Text style={[selectorStyles.optionText, s.id === selectedId && selectorStyles.optionTextActive]}>{s.name}</Text>\n              <Text style={selectorStyles.optionCity}>{s.city}</Text>\n            </Pressable>\n          ))}\n        </View>\n      )}\n    </View>\n  );\n}\n\nconst selectorStyles = StyleSheet.create({\n  container: {\n    gap: 6,\n  },\n  label: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    letterSpacing: 2,\n    marginLeft: 4,\n  },\n  trigger: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.06)',\n    borderRadius: 10,\n    paddingHorizontal: 12,\n    paddingVertical: 10,\n  },\n  triggerText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  list: {\n    backgroundColor: 'rgba(255,255,255,0.03)',\n    borderRadius: 10,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.05)',\n    maxHeight: 150,\n  },\n  option: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    paddingVertical: 8,\n    paddingHorizontal: 12,\n    borderRadius: 8,\n  },\n  optionActive: {\n    backgroundColor: 'rgba(195,0,255,0.08)',\n  },\n  optionText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  optionTextActive: {\n    color: Colors.dark.accentPurple,\n  },\n  optionCity: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n  },\n});\n\nexport function SecuritySuitePanel({ visible, onClose }: SecuritySuitePanelProps) {\n  const insets = useSafeAreaInsets();\n  const {\n    killSwitch, setKillSwitch,\n    protocol, setProtocol,\n    doubleVpn, setDoubleVpn,\n    doubleVpnServer, setDoubleVpnServer,\n    selectedServer, servers,\n  } = useVpn();\n  const topPadding = Platform.OS === 'web' ? 67 : insets.top;\n  const bottomPadding = Platform.OS === 'web' ? 34 : insets.bottom;\n  const slideX = useSharedValue(PANEL_WIDTH);\n\n  useEffect(() => {\n    if (visible) {\n      slideX.value = withSpring(0, { damping: 20, stiffness: 200 });\n    } else {\n      slideX.value = withTiming(PANEL_WIDTH, { duration: 250 });\n    }\n  }, [visible]);\n\n  const panelAnimStyle = useAnimatedStyle(() => ({\n    transform: [{ translateX: slideX.value }],\n  }));\n\n  const entryServer = selectedServer?.name || 'Server 1';\n  const exitServer = doubleVpnServer?.name || 'Server 2';\n\n  const otherServers = servers.filter(s => s.id !== selectedServer?.id);\n\n  return (\n    <Modal\n      visible={visible}\n      transparent\n      animationType=\"fade\"\n      onRequestClose={onClose}\n      statusBarTranslucent\n    >\n      <View style={styles.overlay}>\n        <Pressable style={styles.backdropTouch} onPress={onClose} />\n        <Animated.View style={[styles.panel, panelAnimStyle, { paddingTop: topPadding + 12, paddingBottom: bottomPadding + 12 }]}>\n          <View style={styles.panelHeader}>\n            <View style={styles.panelTitleRow}>\n              <MaterialCommunityIcons name=\"shield-lock\" size={20} color={Colors.dark.accent} />\n              <Text style={styles.panelTitle}>Security Suite</Text>\n            </View>\n            <Pressable onPress={onClose} hitSlop={12}>\n              <Ionicons name=\"close\" size={22} color={Colors.dark.textSecondary} />\n            </Pressable>\n          </View>\n\n          <ScrollView showsVerticalScrollIndicator={false} contentContainerStyle={styles.panelContent}>\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={killSwitch ? Colors.dark.accentCoral : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(255,46,99,0.1)' }]}>\n                    <Ionicons name=\"warning\" size={16} color={Colors.dark.accentCoral} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>Kill Switch</Text>\n                    <Text style={styles.sectionDesc}>Instantly blocks all traffic if the VPN connection drops unexpectedly</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={killSwitch}\n                  onValueChange={(v) => {\n                    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n                    setKillSwitch(v);\n                  }}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(255,46,99,0.3)' }}\n                  thumbColor={killSwitch ? Colors.dark.accentCoral : '#555'}\n                />\n              </View>\n              {killSwitch && (\n                <View style={styles.warningBanner}>\n                  <Ionicons name=\"warning\" size={12} color={Colors.dark.accentCoral} />\n                  <Text style={styles.warningText}>All internet traffic will halt if VPN disconnects</Text>\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={doubleVpn ? Colors.dark.accentPurple : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(195,0,255,0.1)' }]}>\n                    <MaterialCommunityIcons name=\"vector-polyline\" size={16} color={Colors.dark.accentPurple} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>Double VPN</Text>\n                    <Text style={styles.sectionDesc}>Route traffic through two servers for extra encryption layers</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={doubleVpn}\n                  onValueChange={(v) => {\n                    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n                    setDoubleVpn(v);\n                  }}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(195,0,255,0.3)' }}\n                  thumbColor={doubleVpn ? Colors.dark.accentPurple : '#555'}\n                />\n              </View>\n\n              <View style={styles.hopDivider} />\n              <Text style={styles.hopSectionLabel}>MULTI-HOP PATH</Text>\n              <MultiHopVisual entry={entryServer} exit={exitServer} enabled={doubleVpn} />\n\n              {doubleVpn && (\n                <View style={styles.hopServerSelect}>\n                  <HopServerSelector\n                    servers={otherServers}\n                    selectedId={doubleVpnServer?.id}\n                    onSelect={(id) => {\n                      const s = servers.find(srv => srv.id === id) || null;\n                      setDoubleVpnServer(s);\n                    }}\n                    label=\"EXIT NODE\"\n                  />\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={Colors.dark.accent}>\n              <View style={styles.protocolHeader}>\n                <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(0,240,255,0.1)' }]}>\n                  <Ionicons name=\"shield-checkmark\" size={16} color={Colors.dark.accent} />\n                </View>\n                <View style={styles.sectionTextGroup}>\n                  <Text style={styles.sectionTitle}>Protocol</Text>\n                  <Text style={styles.sectionDesc}>Select your tunnel encryption protocol</Text>\n                </View>\n              </View>\n\n              <View style={styles.protocolGrid}>\n                {PROTOCOLS.map(p => {\n                  const isActive = protocol === p;\n                  const icon = p === 'WireGuard' ? 'flash' : p === 'OpenVPN' ? 'lock-closed' : 'eye-off';\n                  const desc = p === 'WireGuard' ? 'Fastest & modern' : p === 'OpenVPN' ? 'Battle-tested' : 'Bypass censorship';\n                  return (\n                    <Pressable\n                      key={p}\n                      style={[styles.protocolCard, isActive && styles.protocolCardActive]}\n                      onPress={() => {\n                        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                        setProtocol(p);\n                      }}\n                    >\n                      <Ionicons name={icon as any} size={18} color={isActive ? Colors.dark.accent : Colors.dark.textMuted} />\n                      <Text style={[styles.protocolName, isActive && styles.protocolNameActive]}>{p}</Text>\n                      <Text style={styles.protocolDesc}>{desc}</Text>\n                      {isActive && (\n                        <View style={styles.protocolCheck}>\n                          <Ionicons name=\"checkmark-circle\" size={14} color={Colors.dark.accent} />\n                        </View>\n                      )}\n                    </Pressable>\n                  );\n                })}\n              </View>\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"low\">\n              <View style={styles.encryptionRow}>\n                <MaterialCommunityIcons name=\"shield-key-outline\" size={18} color={Colors.dark.success} />\n                <View style={styles.sectionTextGroup}>\n                  <Text style={styles.sectionTitle}>Encryption Status</Text>\n                  <Text style={styles.sectionDesc}>AES-256-GCM with Perfect Forward Secrecy</Text>\n                </View>\n                <View style={styles.militaryBadge}>\n                  <Text style={styles.militaryBadgeText}>MILITARY</Text>\n                </View>\n              </View>\n            </GlassCard>\n          </ScrollView>\n        </Animated.View>\n      </View>\n    </Modal>\n  );\n}\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n  },\n  backdropTouch: {\n    flex: 1,\n  },\n  panel: {\n    width: PANEL_WIDTH,\n    backgroundColor: '#0F0F0F',\n    borderLeftWidth: 1,\n    borderColor: 'rgba(255,255,255,0.06)',\n    paddingHorizontal: 16,\n  },\n  panelHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n  panelTitleRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  panelTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 16,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  panelContent: {\n    gap: 14,\n    paddingBottom: 20,\n  },\n  sectionCard: {\n    padding: 16,\n  },\n  sectionRow: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    justifyContent: 'space-between',\n  },\n  sectionLeft: {\n    flexDirection: 'row',\n    flex: 1,\n    gap: 10,\n    marginRight: 10,\n  },\n  sectionIconWrap: {\n    width: 34,\n    height: 34,\n    borderRadius: 10,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  sectionTextGroup: {\n    flex: 1,\n  },\n  sectionTitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    color: Colors.dark.text,\n  },\n  sectionDesc: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.textMuted,\n    marginTop: 3,\n    lineHeight: 16,\n  },\n  warningBanner: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n    backgroundColor: 'rgba(255,46,99,0.06)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,46,99,0.12)',\n    borderRadius: 10,\n    padding: 10,\n    marginTop: 12,\n  },\n  warningText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.accentCoral,\n    flex: 1,\n  },\n  hopDivider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    marginTop: 14,\n  },\n  hopSectionLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    letterSpacing: 3,\n    marginTop: 12,\n    marginLeft: 4,\n  },\n  hopServerSelect: {\n    marginTop: 8,\n  },\n  protocolHeader: {\n    flexDirection: 'row',\n    gap: 10,\n    marginBottom: 14,\n  },\n  protocolGrid: {\n    gap: 8,\n  },\n  protocolCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 10,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.05)',\n    borderRadius: 12,\n    padding: 12,\n  },\n  protocolCardActive: {\n    borderColor: 'rgba(0,240,255,0.25)',\n    backgroundColor: 'rgba(0,240,255,0.04)',\n  },\n  protocolName: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 13,\n    color: Colors.dark.textSecondary,\n  },\n  protocolNameActive: {\n    color: Colors.dark.accent,\n  },\n  protocolDesc: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n    flex: 1,\n  },\n  protocolCheck: {\n    marginLeft: 'auto',\n  },\n  encryptionRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 10,\n  },\n  militaryBadge: {\n    backgroundColor: 'rgba(0,230,118,0.1)',\n    borderWidth: 1,\n    borderColor: 'rgba(0,230,118,0.2)',\n    paddingHorizontal: 8,\n    paddingVertical: 3,\n    borderRadius: 8,\n  },\n  militaryBadgeText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 7,\n    color: Colors.dark.success,\n    letterSpacing: 2,\n  },\n});\n","path":null,"size_bytes":18835,"size_tokens":null},"app/(tabs)/_layout.tsx":{"content":"import { isLiquidGlassAvailable } from \"expo-glass-effect\";\nimport { Tabs } from \"expo-router\";\nimport { NativeTabs, Icon, Label } from \"expo-router/unstable-native-tabs\";\nimport { BlurView } from \"expo-blur\";\nimport { Platform, StyleSheet, View } from \"react-native\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport React from \"react\";\nimport Colors from \"@/constants/colors\";\n\nfunction NativeTabLayout() {\n  return (\n    <NativeTabs>\n      <NativeTabs.Trigger name=\"index\">\n        <Icon sf={{ default: \"shield\", selected: \"shield.fill\" }} />\n        <Label>Connect</Label>\n      </NativeTabs.Trigger>\n      <NativeTabs.Trigger name=\"servers\">\n        <Icon sf={{ default: \"globe\", selected: \"globe\" }} />\n        <Label>Servers</Label>\n      </NativeTabs.Trigger>\n      <NativeTabs.Trigger name=\"stats\">\n        <Icon sf={{ default: \"chart.bar\", selected: \"chart.bar.fill\" }} />\n        <Label>Stats</Label>\n      </NativeTabs.Trigger>\n      <NativeTabs.Trigger name=\"settings\">\n        <Icon sf={{ default: \"gearshape\", selected: \"gearshape.fill\" }} />\n        <Label>Settings</Label>\n      </NativeTabs.Trigger>\n    </NativeTabs>\n  );\n}\n\nfunction ClassicTabLayout() {\n  const isWeb = Platform.OS === \"web\";\n  const isIOS = Platform.OS === \"ios\";\n\n  return (\n    <Tabs\n      sceneStyle={{ backgroundColor: '#0F0F0F' }}\n      screenOptions={{\n        headerShown: false,\n        animation: 'none',\n        tabBarActiveTintColor: Colors.dark.accent,\n        tabBarInactiveTintColor: Colors.dark.textMuted,\n        tabBarStyle: {\n          position: \"absolute\",\n          backgroundColor: isIOS ? \"transparent\" : Colors.dark.backgroundSecondary,\n          borderTopWidth: 0,\n          borderTopColor: \"rgba(255,255,255,0.06)\",\n          elevation: 0,\n          ...(isWeb ? { height: 84, borderTopWidth: 1, borderTopColor: 'rgba(255,255,255,0.06)' } : {}),\n        },\n        tabBarBackground: () =>\n          isIOS ? (\n            <BlurView\n              intensity={80}\n              tint=\"dark\"\n              style={StyleSheet.absoluteFill}\n            />\n          ) : isWeb ? (\n            <View style={[StyleSheet.absoluteFill, { backgroundColor: Colors.dark.backgroundSecondary }]} />\n          ) : null,\n        tabBarLabelStyle: {\n          fontFamily: 'SpaceGrotesk_400Regular',\n          fontSize: 10,\n        },\n      }}\n    >\n      <Tabs.Screen\n        name=\"index\"\n        options={{\n          title: \"Connect\",\n          tabBarIcon: ({ color, size }) => (\n            <Ionicons name=\"shield\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tabs.Screen\n        name=\"servers\"\n        options={{\n          title: \"Servers\",\n          tabBarIcon: ({ color, size }) => (\n            <Ionicons name=\"globe-outline\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tabs.Screen\n        name=\"stats\"\n        options={{\n          title: \"Stats\",\n          tabBarIcon: ({ color, size }) => (\n            <Ionicons name=\"stats-chart\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tabs.Screen\n        name=\"settings\"\n        options={{\n          title: \"Settings\",\n          tabBarIcon: ({ color, size }) => (\n            <Ionicons name=\"settings-outline\" size={size} color={color} />\n          ),\n        }}\n      />\n    </Tabs>\n  );\n}\n\nexport default function TabLayout() {\n  if (isLiquidGlassAvailable()) {\n    return <NativeTabLayout />;\n  }\n  return <ClassicTabLayout />;\n}\n","path":null,"size_bytes":3451,"size_tokens":null},"scripts/scripts/build.js":{"content":"const fs = require(\"fs\");\nconst path = require(\"path\");\nconst { spawn } = require(\"child_process\");\nconst { Readable } = require(\"stream\");\nconst { pipeline } = require(\"stream/promises\");\n\nlet metroProcess = null;\n\nfunction exitWithError(message) {\n  console.error(message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n}\n\nfunction setupSignalHandlers() {\n  const cleanup = () => {\n    if (metroProcess) {\n      console.log(\"Cleaning up Metro process...\");\n      metroProcess.kill();\n    }\n    process.exit(0);\n  };\n\n  process.on(\"SIGINT\", cleanup);\n  process.on(\"SIGTERM\", cleanup);\n  process.on(\"SIGHUP\", cleanup);\n}\n\nfunction stripProtocol(domain) {\n  let urlString = domain.trim();\n\n  if (!/^https?:\\/\\//i.test(urlString)) {\n    urlString = `https://${urlString}`;\n  }\n\n  return new URL(urlString).host;\n}\n\nfunction getDeploymentDomain() {\n  // Check Replit deployment environment variables first\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    return stripProtocol(process.env.REPLIT_INTERNAL_APP_DOMAIN);\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    return stripProtocol(process.env.REPLIT_DEV_DOMAIN);\n  }\n\n  if (process.env.EXPO_PUBLIC_DOMAIN) {\n    return stripProtocol(process.env.EXPO_PUBLIC_DOMAIN);\n  }\n\n  console.error(\n    \"ERROR: No deployment domain found. Set REPLIT_INTERNAL_APP_DOMAIN, REPLIT_DEV_DOMAIN, or EXPO_PUBLIC_DOMAIN\",\n  );\n  process.exit(1);\n}\n\nfunction prepareDirectories(timestamp) {\n  console.log(\"Preparing build directories...\");\n\n  if (fs.existsSync(\"static-build\")) {\n    fs.rmSync(\"static-build\", { recursive: true });\n  }\n\n  const dirs = [\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"ios\"),\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"android\"),\n    path.join(\"static-build\", \"ios\"),\n    path.join(\"static-build\", \"android\"),\n  ];\n\n  for (const dir of dirs) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  console.log(\"Build:\", timestamp);\n}\n\nfunction clearMetroCache() {\n  console.log(\"Clearing Metro cache...\");\n\n  const cacheDirs = [\n    ...fs.globSync(\".metro-cache\"),\n    ...fs.globSync(\"node_modules/.cache/metro\"),\n  ];\n\n  for (const dir of cacheDirs) {\n    fs.rmSync(dir, { recursive: true, force: true });\n  }\n\n  console.log(\"Cache cleared\");\n}\n\nasync function checkMetroHealth() {\n  try {\n    const response = await fetch(\"http://localhost:8081/status\", {\n      signal: AbortSignal.timeout(5000),\n    });\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\nasync function startMetro(expoPublicDomain) {\n  const isRunning = await checkMetroHealth();\n  if (isRunning) {\n    console.log(\"Metro already running\");\n    return;\n  }\n\n  console.log(\"Starting Metro...\");\n  console.log(`Setting EXPO_PUBLIC_DOMAIN=${expoPublicDomain}`);\n  const env = {\n    ...process.env,\n    EXPO_PUBLIC_DOMAIN: expoPublicDomain,\n  };\n  metroProcess = spawn(\"npm\", [\"run\", \"expo:start:static:build\"], {\n    stdio: [\"ignore\", \"pipe\", \"pipe\"],\n    detached: false,\n    env,\n  });\n\n  if (metroProcess.stdout) {\n    metroProcess.stdout.on(\"data\", (data) => {\n      const output = data.toString().trim();\n      if (output) console.log(`[Metro] ${output}`);\n    });\n  }\n  if (metroProcess.stderr) {\n    metroProcess.stderr.on(\"data\", (data) => {\n      const output = data.toString().trim();\n      if (output) console.error(`[Metro Error] ${output}`);\n    });\n  }\n\n  for (let i = 0; i < 60; i++) {\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n\n    const healthy = await checkMetroHealth();\n    if (healthy) {\n      console.log(\"Metro ready\");\n      return;\n    }\n  }\n\n  console.error(\"Metro timeout\");\n  process.exit(1);\n}\n\nasync function downloadFile(url, outputPath) {\n  const controller = new AbortController();\n  const fiveMinMS = 5 * 60 * 1_000;\n  const timeoutId = setTimeout(() => controller.abort(), fiveMinMS);\n\n  try {\n    console.log(`Downloading: ${url}`);\n    const response = await fetch(url, { signal: controller.signal });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const file = fs.createWriteStream(outputPath);\n    await pipeline(Readable.fromWeb(response.body), file);\n\n    const fileSize = fs.statSync(outputPath).size;\n\n    if (fileSize === 0) {\n      fs.unlinkSync(outputPath);\n      throw new Error(\"Downloaded file is empty\");\n    }\n  } catch (error) {\n    if (fs.existsSync(outputPath)) {\n      fs.unlinkSync(outputPath);\n    }\n\n    if (error.name === \"AbortError\") {\n      throw new Error(`Download timeout after 5m: ${url}`);\n    }\n    throw error;\n  } finally {\n    clearTimeout(timeoutId);\n  }\n}\n\nasync function downloadBundle(platform, timestamp) {\n  // For expo-router apps, the entry is node_modules/expo-router/entry\n  const url = new URL(\"http://localhost:8081/node_modules/expo-router/entry.bundle\");\n  url.searchParams.set(\"platform\", platform);\n  url.searchParams.set(\"dev\", \"false\");\n  url.searchParams.set(\"hot\", \"false\");\n  url.searchParams.set(\"lazy\", \"false\");\n  url.searchParams.set(\"minify\", \"true\");\n\n  const output = path.join(\n    \"static-build\",\n    timestamp,\n    \"_expo\",\n    \"static\",\n    \"js\",\n    platform,\n    \"bundle.js\",\n  );\n\n  console.log(`Fetching ${platform} bundle...`);\n  await downloadFile(url.toString(), output);\n  console.log(`${platform} bundle ready`);\n}\n\nasync function downloadManifest(platform) {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), 300_000);\n\n  try {\n    console.log(`Fetching ${platform} manifest...`);\n    const response = await fetch(\"http://localhost:8081/manifest\", {\n      headers: { \"expo-platform\": platform },\n      signal: controller.signal,\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const manifest = await response.json();\n    console.log(`${platform} manifest ready`);\n    return manifest;\n  } catch (error) {\n    if (error.name === \"AbortError\") {\n      throw new Error(\n        `Manifest download timeout after 5m for platform: ${platform}`,\n      );\n    }\n    throw error;\n  } finally {\n    clearTimeout(timeoutId);\n  }\n}\n\nasync function downloadBundlesAndManifests(timestamp) {\n  console.log(\"Downloading bundles and manifests...\");\n  console.log(\"This may take several minutes for production builds...\");\n\n  try {\n    const results = await Promise.allSettled([\n      downloadBundle(\"ios\", timestamp),\n      downloadBundle(\"android\", timestamp),\n      downloadManifest(\"ios\"),\n      downloadManifest(\"android\"),\n    ]);\n\n    const failures = results\n      .map((result, index) => ({ result, index }))\n      .filter(({ result }) => result.status === \"rejected\");\n\n    if (failures.length > 0) {\n      const errorMessages = failures.map(({ result, index }) => {\n        const names = [\n          \"iOS bundle\",\n          \"Android bundle\",\n          \"iOS manifest\",\n          \"Android manifest\",\n        ];\n        return `  - ${names[index]}: ${result.reason?.message || result.reason}`;\n      });\n\n      exitWithError(`Download failed:\\n${errorMessages.join(\"\\n\")}`);\n    }\n\n    const iosManifest =\n      results[2].status === \"fulfilled\" ? results[2].value : null;\n    const androidManifest =\n      results[3].status === \"fulfilled\" ? results[3].value : null;\n\n    console.log(\"All downloads completed successfully\");\n    return { ios: iosManifest, android: androidManifest };\n  } catch (error) {\n    exitWithError(`Unexpected download error: ${error.message}`);\n  }\n}\n\nfunction extractAssets(timestamp) {\n  const bundles = {\n    ios: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"ios\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n    android: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"android\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n  };\n\n  const assetsMap = new Map();\n  const assetPattern =\n    /httpServerLocation:\"([^\"]+)\"[^}]*hash:\"([^\"]+)\"[^}]*name:\"([^\"]+)\"[^}]*type:\"([^\"]+)\"/g;\n\n  const extractFromBundle = (bundle, platform) => {\n    for (const match of bundle.matchAll(assetPattern)) {\n      const originalPath = match[1];\n      const filename = match[3] + \".\" + match[4];\n\n      const tempUrl = new URL(`http://localhost:8081${originalPath}`);\n      const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n      if (!unstablePath) {\n        throw new Error(`Asset missing unstable_path: ${originalPath}`);\n      }\n\n      const decodedPath = decodeURIComponent(unstablePath);\n      const key = path.posix.join(decodedPath, filename);\n\n      if (!assetsMap.has(key)) {\n        const asset = {\n          url: path.posix.join(\"/\", decodedPath, filename),\n          originalPath: originalPath,\n          filename: filename,\n          relativePath: decodedPath,\n          hash: match[2],\n          platforms: new Set(),\n        };\n\n        assetsMap.set(key, asset);\n      }\n      assetsMap.get(key).platforms.add(platform);\n    }\n  };\n\n  extractFromBundle(bundles.ios, \"ios\");\n  extractFromBundle(bundles.android, \"android\");\n\n  return Array.from(assetsMap.values());\n}\n\nasync function downloadAssets(assets, timestamp) {\n  if (assets.length === 0) {\n    return 0;\n  }\n\n  console.log(\"Downloading assets...\");\n  let successCount = 0;\n  const failures = [];\n\n  const downloadPromises = assets.map(async (asset) => {\n    const platform = Array.from(asset.platforms)[0];\n\n    const tempUrl = new URL(`http://localhost:8081${asset.originalPath}`);\n    const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n    if (!unstablePath) {\n      throw new Error(`Asset missing unstable_path: ${asset.originalPath}`);\n    }\n\n    const decodedPath = decodeURIComponent(unstablePath);\n    const metroUrl = new URL(\n      `http://localhost:8081${path.posix.join(\"/assets\", decodedPath, asset.filename)}`,\n    );\n    metroUrl.searchParams.set(\"platform\", platform);\n    metroUrl.searchParams.set(\"hash\", asset.hash);\n\n    const outputDir = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      asset.relativePath,\n    );\n    fs.mkdirSync(outputDir, { recursive: true });\n    const output = path.join(outputDir, asset.filename);\n\n    try {\n      await downloadFile(metroUrl.toString(), output);\n      successCount++;\n    } catch (error) {\n      failures.push({\n        filename: asset.filename,\n        error: error.message,\n        url: metroUrl.toString(),\n      });\n    }\n  });\n\n  await Promise.all(downloadPromises);\n\n  if (failures.length > 0) {\n    const errorMsg =\n      `Failed to download ${failures.length} asset(s):\\n` +\n      failures\n        .map((f) => `  - ${f.filename}: ${f.error} (${f.url})`)\n        .join(\"\\n\");\n    exitWithError(errorMsg);\n  }\n\n  console.log(`Downloaded ${successCount} assets`);\n  return successCount;\n}\n\nfunction updateBundleUrls(timestamp, baseUrl) {\n  const updateForPlatform = (platform) => {\n    const bundlePath = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      platform,\n      \"bundle.js\",\n    );\n    let bundle = fs.readFileSync(bundlePath, \"utf-8\");\n\n    bundle = bundle.replace(\n      /httpServerLocation:\"(\\/[^\"]+)\"/g,\n      (_match, capturedPath) => {\n        const tempUrl = new URL(`http://localhost:8081${capturedPath}`);\n        const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n        if (!unstablePath) {\n          throw new Error(\n            `Asset missing unstable_path in bundle: ${capturedPath}`,\n          );\n        }\n\n        const decodedPath = decodeURIComponent(unstablePath);\n        return `httpServerLocation:\"${baseUrl}/${timestamp}/_expo/static/js/${decodedPath}\"`;\n      },\n    );\n\n    fs.writeFileSync(bundlePath, bundle);\n  };\n\n  updateForPlatform(\"ios\");\n  updateForPlatform(\"android\");\n  console.log(\"Updated bundle URLs\");\n}\n\nfunction updateManifests(manifests, timestamp, baseUrl, assetsByHash) {\n  const updateForPlatform = (platform, manifest) => {\n    if (!manifest.launchAsset || !manifest.extra) {\n      exitWithError(`Malformed manifest for ${platform}`);\n    }\n\n    manifest.launchAsset.url = `${baseUrl}/${timestamp}/_expo/static/js/${platform}/bundle.js`;\n    manifest.launchAsset.key = `bundle-${timestamp}`;\n    manifest.createdAt = new Date(\n      Number(timestamp.split(\"-\")[0]),\n    ).toISOString();\n    manifest.extra.expoClient.hostUri =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.debuggerHost =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.packagerOpts.dev = false;\n\n    if (manifest.assets && manifest.assets.length > 0) {\n      manifest.assets.forEach((asset) => {\n        if (!asset.url) return;\n\n        const hash = asset.hash;\n        if (!hash) return;\n\n        const assetInfo = assetsByHash.get(hash);\n        if (!assetInfo) return;\n\n        asset.url = `${baseUrl}/${timestamp}/_expo/static/js/${assetInfo.relativePath}/${assetInfo.filename}`;\n      });\n    }\n\n    fs.writeFileSync(\n      path.join(\"static-build\", platform, \"manifest.json\"),\n      JSON.stringify(manifest, null, 2),\n    );\n  };\n\n  updateForPlatform(\"ios\", manifests.ios);\n  updateForPlatform(\"android\", manifests.android);\n  console.log(\"Manifests updated\");\n}\n\nasync function main() {\n  console.log(\"Building static Expo Go deployment...\");\n\n  setupSignalHandlers();\n\n  const domain = getDeploymentDomain();\n  const baseUrl = `https://${domain}`;\n  const timestamp = `${Date.now()}-${process.pid}`;\n\n  prepareDirectories(timestamp);\n  clearMetroCache();\n\n  await startMetro(domain);\n\n  const downloadTimeout = 300000;\n  const downloadPromise = downloadBundlesAndManifests(timestamp);\n  const timeoutPromise = new Promise((_, reject) => {\n    setTimeout(() => {\n      reject(\n        new Error(\n          `Overall download timeout after ${downloadTimeout / 1000} seconds. ` +\n            \"Metro may be struggling to generate bundles. Check Metro logs above.\",\n        ),\n      );\n    }, downloadTimeout);\n  });\n\n  const manifests = await Promise.race([downloadPromise, timeoutPromise]);\n\n  console.log(\"Processing assets...\");\n  const assets = extractAssets(timestamp);\n  console.log(\"Found\", assets.length, \"unique asset(s)\");\n\n  const assetsByHash = new Map();\n  for (const asset of assets) {\n    assetsByHash.set(asset.hash, {\n      relativePath: asset.relativePath,\n      filename: asset.filename,\n    });\n  }\n\n  const assetCount = await downloadAssets(assets, timestamp);\n\n  if (assetCount > 0) {\n    updateBundleUrls(timestamp, baseUrl);\n  }\n\n  console.log(\"Updating manifests and creating landing page...\");\n  updateManifests(manifests, timestamp, baseUrl, assetsByHash);\n\n  console.log(\"Build complete! Deploy to:\", baseUrl);\n\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(0);\n}\n\nmain().catch((error) => {\n  console.error(\"Build failed:\", error.message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n});\n","path":null,"size_bytes":15011,"size_tokens":null},"components/components/HapticButton.tsx":{"content":"import React, { useCallback } from 'react';\nimport { Pressable, ViewStyle, StyleProp } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withSpring,\n} from 'react-native-reanimated';\nimport * as Haptics from 'expo-haptics';\n\ninterface HapticButtonProps {\n  onPress: () => void;\n  children: React.ReactNode;\n  style?: StyleProp<ViewStyle>;\n  scaleDown?: number;\n  hapticStyle?: Haptics.ImpactFeedbackStyle;\n  disabled?: boolean;\n  testID?: string;\n  hitSlop?: number;\n}\n\nexport function HapticButton({\n  onPress,\n  children,\n  style,\n  scaleDown = 0.95,\n  hapticStyle = Haptics.ImpactFeedbackStyle.Light,\n  disabled = false,\n  testID,\n  hitSlop,\n}: HapticButtonProps) {\n  const scale = useSharedValue(1);\n\n  const animStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = useCallback(() => {\n    scale.value = withSpring(scaleDown, { damping: 15, stiffness: 300 });\n  }, [scaleDown]);\n\n  const handlePressOut = useCallback(() => {\n    scale.value = withSpring(1, { damping: 10, stiffness: 200 });\n  }, []);\n\n  const handlePress = useCallback(() => {\n    if (disabled) return;\n    Haptics.impactAsync(hapticStyle);\n    onPress();\n  }, [disabled, hapticStyle, onPress]);\n\n  return (\n    <Pressable\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      onPress={handlePress}\n      disabled={disabled}\n      testID={testID}\n      hitSlop={hitSlop}\n    >\n      <Animated.View style={[style, animStyle]}>\n        {children}\n      </Animated.View>\n    </Pressable>\n  );\n}\n","path":null,"size_bytes":1565,"size_tokens":null},"backend/database.py":{"content":"import os\nfrom sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker, DeclarativeBase\n\nDATABASE_URL = os.environ.get(\"SQLITE_DATABASE_URL\", \"sqlite:///./backend/xvpn.db\")\n\nengine = create_engine(DATABASE_URL, connect_args={\"check_same_thread\": False})\nSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\n\n\nclass Base(DeclarativeBase):\n    pass\n\n\ndef get_db():\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n\n\ndef init_db():\n    from backend.models import User, ServerLog\n    Base.metadata.create_all(bind=engine)\n","path":null,"size_bytes":590,"size_tokens":null},"app/_layout.tsx":{"content":"import { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Stack } from \"expo-router\";\nimport * as SplashScreen from \"expo-splash-screen\";\nimport React, { useEffect, useState } from \"react\";\nimport { Platform } from \"react-native\";\nimport { GestureHandlerRootView } from \"react-native-gesture-handler\";\nimport { KeyboardProvider } from \"react-native-keyboard-controller\";\nimport { StatusBar } from \"expo-status-bar\";\nimport * as Font from \"expo-font\";\nimport { SpaceGrotesk_400Regular, SpaceGrotesk_600SemiBold } from \"@expo-google-fonts/space-grotesk\";\nimport { Orbitron_700Bold } from \"@expo-google-fonts/orbitron\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\nimport { queryClient } from \"@/lib/query-client\";\nimport { VpnProvider } from \"@/lib/vpn-context\";\nimport { FingerprintShieldProvider } from \"@/lib/fingerprint-context\";\nimport { BiometricGate } from \"@/components/BiometricGate\";\nimport { AuthProvider, useAuth } from \"@/lib/auth-context\";\nimport { AuthScreen } from \"@/components/AuthScreen\";\nimport { View, ActivityIndicator } from \"react-native\";\n\nSplashScreen.preventAutoHideAsync();\n\nfunction RootLayoutNav() {\n  return (\n    <Stack screenOptions={{ headerBackTitle: \"Back\", contentStyle: { backgroundColor: '#0F0F0F' } }}>\n      <Stack.Screen name=\"(tabs)\" options={{ headerShown: false }} />\n    </Stack>\n  );\n}\n\nfunction AuthGate() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  if (isLoading) {\n    return (\n      <View style={{ flex: 1, backgroundColor: '#0A0A1A', justifyContent: 'center', alignItems: 'center' }}>\n        <ActivityIndicator size=\"large\" color=\"#00F0FF\" />\n      </View>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return <AuthScreen />;\n  }\n\n  return (\n    <VpnProvider>\n      <FingerprintShieldProvider>\n        <BiometricGate>\n          <StatusBar style=\"light\" />\n          <RootLayoutNav />\n        </BiometricGate>\n      </FingerprintShieldProvider>\n    </VpnProvider>\n  );\n}\n\nexport default function RootLayout() {\n  const [ready, setReady] = useState(false);\n\n  useEffect(() => {\n    async function loadFonts() {\n      try {\n        await Font.loadAsync({\n          SpaceGrotesk_400Regular,\n          SpaceGrotesk_600SemiBold,\n          Orbitron_700Bold,\n        });\n      } catch (e) {\n        console.warn(\"Font loading failed, using fallback fonts:\", e);\n      } finally {\n        setReady(true);\n        SplashScreen.hideAsync();\n      }\n    }\n    loadFonts();\n  }, []);\n\n  if (!ready) return null;\n\n  return (\n    <ErrorBoundary>\n      <QueryClientProvider client={queryClient}>\n        <GestureHandlerRootView style={{ flex: 1, backgroundColor: '#0F0F0F' }}>\n          <KeyboardProvider>\n            <AuthProvider>\n              <StatusBar style=\"light\" />\n              <AuthGate />\n            </AuthProvider>\n          </KeyboardProvider>\n        </GestureHandlerRootView>\n      </QueryClientProvider>\n    </ErrorBoundary>\n  );\n}\n","path":null,"size_bytes":2922,"size_tokens":null},"components/HapticButton.tsx":{"content":"import React, { useCallback } from 'react';\nimport { Pressable, ViewStyle, StyleProp } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withSpring,\n} from 'react-native-reanimated';\nimport * as Haptics from 'expo-haptics';\n\ninterface HapticButtonProps {\n  onPress: () => void;\n  children: React.ReactNode;\n  style?: StyleProp<ViewStyle>;\n  scaleDown?: number;\n  hapticStyle?: Haptics.ImpactFeedbackStyle;\n  disabled?: boolean;\n  testID?: string;\n  hitSlop?: number;\n}\n\nexport function HapticButton({\n  onPress,\n  children,\n  style,\n  scaleDown = 0.95,\n  hapticStyle = Haptics.ImpactFeedbackStyle.Light,\n  disabled = false,\n  testID,\n  hitSlop,\n}: HapticButtonProps) {\n  const scale = useSharedValue(1);\n\n  const animStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = useCallback(() => {\n    scale.value = withSpring(scaleDown, { damping: 15, stiffness: 300 });\n  }, [scaleDown]);\n\n  const handlePressOut = useCallback(() => {\n    scale.value = withSpring(1, { damping: 10, stiffness: 200 });\n  }, []);\n\n  const handlePress = useCallback(() => {\n    if (disabled) return;\n    Haptics.impactAsync(hapticStyle);\n    onPress();\n  }, [disabled, hapticStyle, onPress]);\n\n  return (\n    <Pressable\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      onPress={handlePress}\n      disabled={disabled}\n      testID={testID}\n      hitSlop={hitSlop}\n    >\n      <Animated.View style={[style, animStyle]}>\n        {children}\n      </Animated.View>\n    </Pressable>\n  );\n}\n","path":null,"size_bytes":1565,"size_tokens":null},"app/(tabs)/settings.tsx":{"content":"import React, { useState, useCallback } from 'react';\nimport { View, Text, StyleSheet, ScrollView, Switch, Pressable, Platform, Alert } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport * as LocalAuthentication from 'expo-local-authentication';\nimport { NoiseBackground } from '@/components/NoiseBackground';\nimport { GlassCard } from '@/components/GlassCard';\nimport { IPInfoCard } from '@/components/IPInfoCard';\nimport { SecuritySuitePanel } from '@/components/SecuritySuitePanel';\nimport { FingerprintShieldPanel } from '@/components/FingerprintShieldPanel';\nimport { useVpn } from '@/lib/vpn-context';\nimport { useFingerprintShield } from '@/lib/fingerprint-context';\nimport { useAuth } from '@/lib/auth-context';\nimport Colors from '@/constants/colors';\n\nexport default function SettingsScreen() {\n  const insets = useSafeAreaInsets();\n  const {\n    protocol, setProtocol,\n    killSwitch, setKillSwitch,\n    autoConnect, setAutoConnect,\n    doubleVpn, setDoubleVpn,\n    isConnected,\n    selectedServer,\n    virtualIp,\n    biometricLock, setBiometricLock,\n    dnsLeakProtection, setDnsLeakProtection,\n    adBlocker, setAdBlocker,\n  } = useVpn();\n  const { summary } = useFingerprintShield();\n  const { logout, user } = useAuth();\n  const [securityPanelVisible, setSecurityPanelVisible] = useState(false);\n  const [fingerprintPanelVisible, setFingerprintPanelVisible] = useState(false);\n  const [biometricLoading, setBiometricLoading] = useState(false);\n  const [toast, setToast] = useState<string | null>(null);\n  const topPadding = Platform.OS === 'web' ? 67 : insets.top;\n\n  const showToast = useCallback((message: string) => {\n    setToast(message);\n    setTimeout(() => setToast(null), 2500);\n  }, []);\n\n  const handleBiometricToggle = useCallback(async (value: boolean) => {\n    if (!value) {\n      if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n      setBiometricLock(false);\n      showToast('Biometric lock disabled');\n      return;\n    }\n\n    setBiometricLoading(true);\n\n    try {\n      const compatible = await LocalAuthentication.hasHardwareAsync();\n      if (!compatible) {\n        showToast('Biometric hardware not available');\n        setBiometricLoading(false);\n        return;\n      }\n\n      const enrolled = await LocalAuthentication.isEnrolledAsync();\n      if (!enrolled) {\n        showToast('No biometrics enrolled on this device');\n        setBiometricLoading(false);\n        return;\n      }\n\n      const result = await LocalAuthentication.authenticateAsync({\n        promptMessage: 'Authenticate to enable biometric lock',\n        cancelLabel: 'Cancel',\n        disableDeviceFallback: false,\n      });\n\n      if (result.success) {\n        if (Platform.OS !== 'web') Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n        setBiometricLock(true);\n        showToast('Biometric lock enabled');\n      } else {\n        showToast('Authentication failed');\n      }\n    } catch {\n      showToast('Biometric authentication error');\n    } finally {\n      setBiometricLoading(false);\n    }\n  }, [setBiometricLock, showToast]);\n\n  const handleDnsToggle = useCallback((value: boolean) => {\n    if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    setDnsLeakProtection(value);\n    showToast(value ? 'DNS Leak Protection enabled' : 'DNS Leak Protection disabled');\n  }, [setDnsLeakProtection, showToast]);\n\n  const handleAdBlockerToggle = useCallback((value: boolean) => {\n    if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    setAdBlocker(value);\n    showToast(value ? 'Ad & Tracker Blocker enabled' : 'Ad & Tracker Blocker disabled');\n  }, [setAdBlocker, showToast]);\n\n  const SettingRow = ({ icon, iconColor, iconLib, title, subtitle, children }: {\n    icon: string;\n    iconColor: string;\n    iconLib?: 'ion' | 'mci';\n    title: string;\n    subtitle?: string;\n    children: React.ReactNode;\n  }) => (\n    <View style={styles.settingRow}>\n      <View style={[styles.settingIcon, { backgroundColor: `${iconColor}15` }]}>\n        {iconLib === 'mci' ? (\n          <MaterialCommunityIcons name={icon as any} size={18} color={iconColor} />\n        ) : (\n          <Ionicons name={icon as any} size={18} color={iconColor} />\n        )}\n      </View>\n      <View style={styles.settingTextGroup}>\n        <Text style={styles.settingTitle}>{title}</Text>\n        {subtitle && <Text style={styles.settingSubtitle}>{subtitle}</Text>}\n      </View>\n      {children}\n    </View>\n  );\n\n  return (\n    <NoiseBackground>\n      <ScrollView\n        style={[styles.container, { paddingTop: topPadding }]}\n        contentContainerStyle={styles.scrollContent}\n        showsVerticalScrollIndicator={false}\n      >\n        <View style={styles.header}>\n          <Text style={styles.title}>Settings</Text>\n          <Text style={styles.subtitle}>Configure your VPN</Text>\n        </View>\n\n        <IPInfoCard\n          isConnected={isConnected}\n          virtualIp={virtualIp}\n          serverCity={selectedServer?.city || ''}\n          serverCountry={selectedServer?.country || ''}\n        />\n\n        <Text style={styles.sectionLabel}>SECURITY VAULT</Text>\n        <Pressable\n          onPress={() => {\n            if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n            setSecurityPanelVisible(true);\n          }}\n        >\n          <GlassCard style={styles.securitySuiteCard} intensity=\"medium\" glowColor={Colors.dark.accent}>\n            <View style={styles.suiteRow}>\n              <View style={styles.suiteLeft}>\n                <View style={styles.suiteIconWrap}>\n                  <MaterialCommunityIcons name=\"shield-lock\" size={22} color={Colors.dark.accent} />\n                </View>\n                <View style={styles.suiteTextGroup}>\n                  <Text style={styles.suiteTitle}>Security Suite</Text>\n                  <Text style={styles.suiteDesc}>Kill Switch, Double VPN, Protocol</Text>\n                </View>\n              </View>\n              <View style={styles.suiteRight}>\n                <View style={styles.suiteStatusPills}>\n                  {killSwitch && (\n                    <View style={[styles.miniPill, { borderColor: 'rgba(255,46,99,0.3)', backgroundColor: 'rgba(255,46,99,0.06)' }]}>\n                      <View style={[styles.miniDot, { backgroundColor: Colors.dark.accentCoral }]} />\n                      <Text style={[styles.miniPillText, { color: Colors.dark.accentCoral }]}>KS</Text>\n                    </View>\n                  )}\n                  {doubleVpn && (\n                    <View style={[styles.miniPill, { borderColor: 'rgba(195,0,255,0.3)', backgroundColor: 'rgba(195,0,255,0.06)' }]}>\n                      <View style={[styles.miniDot, { backgroundColor: Colors.dark.accentPurple }]} />\n                      <Text style={[styles.miniPillText, { color: Colors.dark.accentPurple }]}>2x</Text>\n                    </View>\n                  )}\n                </View>\n                <Ionicons name=\"chevron-forward\" size={16} color={Colors.dark.textMuted} />\n              </View>\n            </View>\n            <View style={styles.suiteProtocol}>\n              <Ionicons name=\"shield-checkmark\" size={12} color={Colors.dark.accent} />\n              <Text style={styles.suiteProtocolText}>{protocol}</Text>\n            </View>\n          </GlassCard>\n        </Pressable>\n\n        <View style={{ height: 12 }} />\n\n        <Pressable\n          onPress={() => {\n            if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n            setFingerprintPanelVisible(true);\n          }}\n        >\n          <GlassCard style={styles.securitySuiteCard} intensity=\"medium\" glowColor={Colors.dark.accentPurple}>\n            <View style={styles.suiteRow}>\n              <View style={styles.suiteLeft}>\n                <View style={[styles.suiteIconWrap, { backgroundColor: 'rgba(195,0,255,0.08)', borderColor: 'rgba(195,0,255,0.15)' }]}>\n                  <MaterialCommunityIcons name=\"fingerprint\" size={22} color={Colors.dark.accentPurple} />\n                </View>\n                <View style={styles.suiteTextGroup}>\n                  <Text style={styles.suiteTitle}>Fingerprint Shield</Text>\n                  <Text style={styles.suiteDesc}>WebRTC, Timezone, Canvas, UA</Text>\n                </View>\n              </View>\n              <View style={styles.suiteRight}>\n                <View style={styles.suiteStatusPills}>\n                  {summary.activeProtections > 0 && (\n                    <View style={[styles.miniPill, { borderColor: 'rgba(195,0,255,0.3)', backgroundColor: 'rgba(195,0,255,0.06)' }]}>\n                      <View style={[styles.miniDot, { backgroundColor: Colors.dark.accentPurple }]} />\n                      <Text style={[styles.miniPillText, { color: Colors.dark.accentPurple }]}>{summary.activeProtections}/4</Text>\n                    </View>\n                  )}\n                </View>\n                <Ionicons name=\"chevron-forward\" size={16} color={Colors.dark.textMuted} />\n              </View>\n            </View>\n            <View style={styles.suiteProtocol}>\n              <MaterialCommunityIcons name=\"shield-check\" size={12} color={Colors.dark.accentPurple} />\n              <Text style={[styles.suiteProtocolText, { color: Colors.dark.accentPurple }]}>\n                {summary.protectionLevel.toUpperCase()}\n              </Text>\n            </View>\n          </GlassCard>\n        </Pressable>\n\n        <Text style={styles.sectionLabel}>CONNECTION</Text>\n        <GlassCard style={styles.settingsCard} intensity=\"low\">\n          <SettingRow icon=\"wifi-outline\" iconColor={Colors.dark.accentPurple} title=\"Auto-Connect\" subtitle=\"Connect on app launch\">\n            <Switch\n              value={autoConnect}\n              onValueChange={(v) => {\n                if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                setAutoConnect(v);\n              }}\n              trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(195, 0, 255, 0.3)' }}\n              thumbColor={autoConnect ? Colors.dark.accentPurple : '#666'}\n            />\n          </SettingRow>\n\n          <View style={styles.divider} />\n\n          <SettingRow icon=\"finger-print-outline\" iconColor={Colors.dark.success} title=\"Biometric Lock\" subtitle=\"Require Face ID / fingerprint\">\n            <Switch\n              value={biometricLock}\n              onValueChange={handleBiometricToggle}\n              disabled={biometricLoading}\n              trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(0, 230, 118, 0.3)' }}\n              thumbColor={biometricLock ? Colors.dark.success : '#666'}\n            />\n          </SettingRow>\n        </GlassCard>\n\n        <Text style={styles.sectionLabel}>PRIVACY</Text>\n        <GlassCard style={styles.settingsCard} intensity=\"low\">\n          <SettingRow icon=\"eye-off-outline\" iconColor={Colors.dark.accentCoral} title=\"DNS Leak Protection\" subtitle=\"Prevent DNS queries outside tunnel\">\n            <Switch\n              value={dnsLeakProtection}\n              onValueChange={handleDnsToggle}\n              trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(0, 240, 255, 0.3)' }}\n              thumbColor={dnsLeakProtection ? Colors.dark.accent : '#666'}\n            />\n          </SettingRow>\n\n          <View style={styles.divider} />\n\n          <SettingRow icon=\"analytics-outline\" iconColor={Colors.dark.warning} title=\"Ad & Tracker Blocker\" subtitle=\"Block ads, malware and trackers\">\n            <Switch\n              value={adBlocker}\n              onValueChange={handleAdBlockerToggle}\n              trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(0, 240, 255, 0.3)' }}\n              thumbColor={adBlocker ? Colors.dark.accent : '#666'}\n            />\n          </SettingRow>\n\n          <View style={styles.divider} />\n\n          <SettingRow icon=\"document-text-outline\" iconColor={Colors.dark.textSecondary} title=\"No-Log Policy\" subtitle=\"Zero activity logging guaranteed\">\n            <View style={styles.verifiedBadge}>\n              <Ionicons name=\"checkmark-circle\" size={14} color={Colors.dark.success} />\n              <Text style={styles.verifiedText}>Audited  Always Active</Text>\n            </View>\n          </SettingRow>\n        </GlassCard>\n\n        <Text style={styles.sectionLabel}>ACCOUNT</Text>\n        <GlassCard style={styles.settingsCard} intensity=\"low\">\n          <SettingRow icon=\"person-circle-outline\" iconColor={Colors.dark.accent} title={user?.displayName || 'User'} subtitle={user?.email || ''}>\n            <View />\n          </SettingRow>\n\n          <View style={styles.divider} />\n\n          <Pressable\n            style={styles.logoutRow}\n            onPress={() => {\n              if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n              logout();\n            }}\n          >\n            <View style={[styles.settingIcon, { backgroundColor: 'rgba(255,46,99,0.1)' }]}>\n              <Ionicons name=\"log-out-outline\" size={18} color={Colors.dark.accentCoral} />\n            </View>\n            <Text style={styles.logoutText}>Sign Out</Text>\n          </Pressable>\n        </GlassCard>\n\n        <Text style={styles.sectionLabel}>ABOUT</Text>\n        <GlassCard style={styles.settingsCard} intensity=\"low\">\n          <SettingRow icon=\"information-circle-outline\" iconColor={Colors.dark.textSecondary} title=\"Version\" subtitle=\"xVPN for mobile\">\n            <Text style={styles.versionText}>2.0.26</Text>\n          </SettingRow>\n        </GlassCard>\n\n        <View style={styles.branding}>\n          <Text style={styles.brandingLogo}>xVPN</Text>\n          <Text style={styles.brandingText}>Deep Space Security</Text>\n        </View>\n      </ScrollView>\n\n      {toast && (\n        <View style={styles.toastContainer}>\n          <View style={styles.toast}>\n            <Ionicons name=\"checkmark-circle\" size={16} color={Colors.dark.accent} />\n            <Text style={styles.toastText}>{toast}</Text>\n          </View>\n        </View>\n      )}\n\n      <SecuritySuitePanel\n        visible={securityPanelVisible}\n        onClose={() => setSecurityPanelVisible(false)}\n      />\n\n      <FingerprintShieldPanel\n        visible={fingerprintPanelVisible}\n        onClose={() => setFingerprintPanelVisible(false)}\n      />\n    </NoiseBackground>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  scrollContent: {\n    paddingBottom: 120,\n  },\n  header: {\n    paddingHorizontal: 24,\n    paddingTop: 12,\n    paddingBottom: 16,\n  },\n  title: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 22,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  subtitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 13,\n    color: Colors.dark.accent,\n    marginTop: 4,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  sectionLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 10,\n    color: Colors.dark.accent,\n    letterSpacing: 3,\n    paddingHorizontal: 24,\n    marginTop: 22,\n    marginBottom: 10,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  securitySuiteCard: {\n    marginHorizontal: 20,\n    padding: 16,\n    marginBottom: 2,\n  },\n  suiteRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  suiteLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n    flex: 1,\n  },\n  suiteIconWrap: {\n    width: 42,\n    height: 42,\n    borderRadius: 14,\n    backgroundColor: 'rgba(0,240,255,0.08)',\n    borderWidth: 1,\n    borderColor: 'rgba(0,240,255,0.15)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  suiteTextGroup: {\n    flex: 1,\n  },\n  suiteTitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 15,\n    color: Colors.dark.text,\n  },\n  suiteDesc: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 11,\n    color: Colors.dark.accent,\n    marginTop: 2,\n    letterSpacing: 0.3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  suiteRight: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  suiteStatusPills: {\n    flexDirection: 'row',\n    gap: 4,\n  },\n  miniPill: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 3,\n    paddingHorizontal: 6,\n    paddingVertical: 3,\n    borderRadius: 6,\n    borderWidth: 1,\n  },\n  miniDot: {\n    width: 4,\n    height: 4,\n    borderRadius: 2,\n  },\n  miniPillText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 7,\n    letterSpacing: 1,\n  },\n  suiteProtocol: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n    marginTop: 10,\n    paddingTop: 10,\n    borderTopWidth: 1,\n    borderTopColor: 'rgba(255,255,255,0.04)',\n  },\n  suiteProtocolText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 9,\n    color: Colors.dark.accent,\n    letterSpacing: 2,\n  },\n  settingsCard: {\n    marginHorizontal: 20,\n    padding: 4,\n  },\n  settingRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: 14,\n    gap: 12,\n  },\n  settingIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: 10,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  settingTextGroup: {\n    flex: 1,\n  },\n  settingTitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    color: Colors.dark.text,\n  },\n  settingSubtitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 11,\n    color: Colors.dark.accent,\n    marginTop: 2,\n    letterSpacing: 0.3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  divider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    marginHorizontal: 14,\n  },\n  verifiedBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n    backgroundColor: 'rgba(0, 230, 118, 0.1)',\n    paddingHorizontal: 10,\n    paddingVertical: 4,\n    borderRadius: 10,\n  },\n  verifiedText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.success,\n  },\n  versionText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 12,\n    color: Colors.dark.textMuted,\n  },\n  branding: {\n    alignItems: 'center',\n    marginTop: 30,\n    gap: 4,\n  },\n  brandingLogo: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 16,\n    color: Colors.dark.accent,\n    letterSpacing: 4,\n    opacity: 0.4,\n  },\n  brandingText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.textMuted,\n    opacity: 0.4,\n  },\n  logoutRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: 14,\n    gap: 12,\n  },\n  logoutText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    color: Colors.dark.accentCoral,\n  },\n  toastContainer: {\n    position: 'absolute',\n    bottom: 100,\n    left: 0,\n    right: 0,\n    alignItems: 'center',\n  },\n  toast: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n    backgroundColor: 'rgba(0,0,0,0.85)',\n    paddingHorizontal: 20,\n    paddingVertical: 12,\n    borderRadius: 24,\n    borderWidth: 1,\n    borderColor: 'rgba(0,240,255,0.2)',\n  },\n  toastText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 13,\n    color: Colors.dark.text,\n  },\n});\n","path":null,"size_bytes":19552,"size_tokens":null},"components/BiometricGate.tsx":{"content":"import React, { useEffect, useState, useCallback, useRef } from 'react';\nimport { View, Text, StyleSheet, Platform, AppState, Pressable } from 'react-native';\nimport * as LocalAuthentication from 'expo-local-authentication';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useVpn } from '@/lib/vpn-context';\nimport Colors from '@/constants/colors';\n\ninterface BiometricGateProps {\n  children: React.ReactNode;\n}\n\nexport function BiometricGate({ children }: BiometricGateProps) {\n  const { biometricLock } = useVpn();\n  const [locked, setLocked] = useState(false);\n  const [authenticating, setAuthenticating] = useState(false);\n  const appState = useRef(AppState.currentState);\n  const hasCheckedInitial = useRef(false);\n\n  const authenticate = useCallback(async () => {\n    if (authenticating) return;\n    setAuthenticating(true);\n\n    try {\n      const compatible = await LocalAuthentication.hasHardwareAsync();\n      if (!compatible) {\n        setLocked(false);\n        return;\n      }\n\n      const enrolled = await LocalAuthentication.isEnrolledAsync();\n      if (!enrolled) {\n        setLocked(false);\n        return;\n      }\n\n      const result = await LocalAuthentication.authenticateAsync({\n        promptMessage: 'Unlock xVPN',\n        cancelLabel: 'Cancel',\n        disableDeviceFallback: false,\n      });\n\n      if (result.success) {\n        setLocked(false);\n      }\n    } catch {\n      // keep locked\n    } finally {\n      setAuthenticating(false);\n    }\n  }, [authenticating]);\n\n  useEffect(() => {\n    if (biometricLock && !hasCheckedInitial.current) {\n      hasCheckedInitial.current = true;\n      setLocked(true);\n      authenticate();\n    }\n  }, [biometricLock, authenticate]);\n\n  useEffect(() => {\n    if (!biometricLock) {\n      setLocked(false);\n      return;\n    }\n\n    const subscription = AppState.addEventListener('change', (nextAppState) => {\n      if (appState.current.match(/inactive|background/) && nextAppState === 'active') {\n        setLocked(true);\n        authenticate();\n      }\n      appState.current = nextAppState;\n    });\n\n    return () => subscription.remove();\n  }, [biometricLock, authenticate]);\n\n  if (!locked || !biometricLock) {\n    return <>{children}</>;\n  }\n\n  return (\n    <View style={styles.container}>\n      {children}\n      <View style={styles.overlay}>\n        <View style={styles.content}>\n          <View style={styles.iconContainer}>\n            <Ionicons name=\"lock-closed\" size={48} color={Colors.dark.accent} />\n          </View>\n          <Text style={styles.title}>xVPN Locked</Text>\n          <Text style={styles.subtitle}>Authenticate to continue</Text>\n          <Pressable style={styles.unlockButton} onPress={authenticate}>\n            <Ionicons name=\"finger-print\" size={20} color=\"#000\" />\n            <Text style={styles.unlockText}>Unlock</Text>\n          </Pressable>\n        </View>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  overlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(15, 15, 15, 0.97)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 9999,\n  },\n  content: {\n    alignItems: 'center',\n    gap: 16,\n  },\n  iconContainer: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    backgroundColor: 'rgba(0, 240, 255, 0.08)',\n    borderWidth: 2,\n    borderColor: 'rgba(0, 240, 255, 0.2)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginBottom: 8,\n  },\n  title: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 22,\n    color: Colors.dark.text,\n    letterSpacing: 3,\n  },\n  subtitle: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 14,\n    color: Colors.dark.textMuted,\n  },\n  unlockButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n    backgroundColor: Colors.dark.accent,\n    paddingHorizontal: 28,\n    paddingVertical: 14,\n    borderRadius: 16,\n    marginTop: 12,\n  },\n  unlockText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 14,\n    color: '#000',\n    letterSpacing: 1,\n  },\n});\n","path":null,"size_bytes":4041,"size_tokens":null},"app/(tabs)/index.tsx":{"content":"import React, { useState, useCallback, useEffect } from 'react';\nimport { View, Text, StyleSheet, Platform, ScrollView, Pressable } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport { NoiseBackground } from '@/components/NoiseBackground';\nimport { GlassCard } from '@/components/GlassCard';\nimport { PowerButton } from '@/components/PowerButton';\nimport { WorldMap } from '@/components/WorldMap';\nimport { LiveTelemetry } from '@/components/LiveTelemetry';\nimport { IPInfoCard } from '@/components/IPInfoCard';\nimport { RadarOverlay } from '@/components/RadarOverlay';\nimport { LeakStatusIndicators } from '@/components/LeakStatusIndicators';\nimport { useVpn } from '@/lib/vpn-context';\nimport { useFingerprintShield } from '@/lib/fingerprint-context';\nimport Colors from '@/constants/colors';\n\nexport default function DashboardScreen() {\n  const insets = useSafeAreaInsets();\n  const { isConnected, isConnecting, isProtecting, connectionError, connect, cancelConnection, completeConnection, disconnect, clearError, selectedServer, stats, virtualIp } = useVpn();\n  const { updateForServer } = useFingerprintShield();\n  const topPadding = Platform.OS === 'web' ? 67 : insets.top;\n  const [showRadar, setShowRadar] = useState(false);\n\n  useEffect(() => {\n    updateForServer(selectedServer?.flag || null, selectedServer?.city || undefined);\n  }, [selectedServer?.flag, selectedServer?.city]);\n\n  const handlePowerPress = useCallback(() => {\n    if (isConnected || isProtecting) {\n      disconnect();\n    } else if (isConnecting) {\n      if (Platform.OS !== 'web') {\n        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);\n      }\n      setShowRadar(false);\n      cancelConnection();\n    } else {\n      if (Platform.OS !== 'web') {\n        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n      }\n      clearError();\n      setShowRadar(true);\n      connect();\n    }\n  }, [isConnected, isConnecting, isProtecting, connect, disconnect, cancelConnection, clearError]);\n\n  const handleRadarComplete = useCallback(() => {\n    setShowRadar(false);\n    if (isConnecting) {\n      completeConnection();\n    }\n  }, [isConnecting, completeConnection]);\n\n  const statusText = connectionError\n    ? connectionError.message\n    : isConnecting\n    ? 'Establishing Secure Tunnel...'\n    : isProtecting\n    ? 'Verifying Residential ISP Trust...'\n    : isConnected\n    ? 'Secured & Protected'\n    : 'Tap to Connect';\n  const statusColor = connectionError\n    ? '#FF3131'\n    : isConnecting\n    ? Colors.dark.accentPurple\n    : isProtecting\n    ? '#FFB300'\n    : isConnected\n    ? '#00E676'\n    : Colors.dark.textMuted;\n\n  return (\n    <NoiseBackground>\n      <ScrollView\n        style={[styles.container, { paddingTop: topPadding }]}\n        contentContainerStyle={styles.scrollContent}\n        showsVerticalScrollIndicator={false}\n        bounces={false}\n      >\n        <View style={styles.header}>\n          <Text style={styles.logo}>xVPN</Text>\n          <View style={[styles.statusPill, { borderColor: statusColor }]}>\n            <View style={[styles.statusDot, { backgroundColor: statusColor }]} />\n            <Text style={[styles.statusPillText, { color: statusColor }]}>\n              {isConnected ? 'ACTIVE' : isConnecting ? 'CONNECTING' : isProtecting ? 'PROTECTING' : connectionError ? 'FAILED' : 'IDLE'}\n            </Text>\n          </View>\n        </View>\n\n        <View style={styles.orbSection}>\n          <PowerButton\n            isConnected={isConnected}\n            isConnecting={isConnecting}\n            isProtecting={isProtecting}\n            onPress={handlePowerPress}\n          />\n          <Text style={[styles.statusText, { color: statusColor }]}>{statusText}</Text>\n\n          {selectedServer && (\n            <GlassCard style={styles.serverInfo} intensity=\"low\" glowColor={isConnected ? '#00E676' : undefined}>\n              <View style={styles.serverInfoRow}>\n                <View style={styles.serverDot}>\n                  <Ionicons\n                    name=\"location\"\n                    size={14}\n                    color={isConnected ? '#00E676' : Colors.dark.accent}\n                  />\n                </View>\n                <View>\n                  <Text style={styles.serverName}>{selectedServer.name}</Text>\n                  <Text style={styles.serverCity}>{selectedServer.city}, {selectedServer.country}</Text>\n                </View>\n                {isConnected && (\n                  <View style={styles.encryptedBadge}>\n                    <Ionicons name=\"lock-closed\" size={10} color={Colors.dark.accent} />\n                    <Text style={styles.encryptedText}>AES-256</Text>\n                  </View>\n                )}\n              </View>\n            </GlassCard>\n          )}\n        </View>\n\n        <View style={styles.mapSection}>\n          <View style={styles.sectionHeader}>\n            <Text style={styles.sectionTitle}>GLOBAL NETWORK</Text>\n            <View style={styles.nodeCount}>\n              <View style={styles.nodeCountDot} />\n              <Text style={styles.nodeCountText}>50 nodes</Text>\n            </View>\n          </View>\n          <WorldMap selectedServer={selectedServer} isConnected={isConnected} />\n        </View>\n\n        {isConnected && (\n          <View style={styles.ipSection}>\n            <IPInfoCard\n              isConnected={isConnected}\n              virtualIp={virtualIp}\n              serverCity={selectedServer?.city || ''}\n              serverCountry={selectedServer?.country || ''}\n            />\n          </View>\n        )}\n\n        <View style={styles.leakSection}>\n          <LeakStatusIndicators isConnected={isConnected} />\n        </View>\n\n        <View style={styles.telemetrySection}>\n          <Text style={styles.sectionTitle}>LIVE TELEMETRY</Text>\n          <LiveTelemetry\n            isConnected={isConnected}\n            downloadSpeed={stats.downloadSpeed}\n            uploadSpeed={stats.uploadSpeed}\n            sessionDuration={stats.sessionDuration}\n            ping={stats.ping}\n            dataUsed={stats.dataUsed}\n          />\n        </View>\n\n        {isConnected && (\n          <View style={styles.emergencySection}>\n            <Pressable\n              style={styles.emergencyButton}\n              onPress={() => {\n                if (Platform.OS !== 'web') {\n                  Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);\n                }\n                disconnect();\n              }}\n            >\n              <Ionicons name=\"power\" size={18} color=\"#FFFFFF\" />\n              <Text style={styles.emergencyText}>EMERGENCY DISCONNECT</Text>\n            </Pressable>\n          </View>\n        )}\n\n        <View style={styles.bottomSpacer} />\n      </ScrollView>\n\n      <RadarOverlay visible={showRadar} onComplete={handleRadarComplete} />\n    </NoiseBackground>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  scrollContent: {\n    paddingBottom: 40,\n  },\n  header: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: 24,\n    paddingTop: 12,\n    paddingBottom: 4,\n  },\n  logo: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 22,\n    color: Colors.dark.accent,\n    letterSpacing: 3,\n  },\n  statusPill: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 20,\n    borderWidth: 1,\n    gap: 6,\n  },\n  statusDot: {\n    width: 6,\n    height: 6,\n    borderRadius: 3,\n  },\n  statusPillText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 9,\n    letterSpacing: 2,\n  },\n  orbSection: {\n    alignItems: 'center',\n    paddingTop: 8,\n    gap: 12,\n  },\n  statusText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    letterSpacing: 1,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  serverInfo: {\n    paddingHorizontal: 16,\n    paddingVertical: 10,\n  },\n  serverInfoRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 10,\n  },\n  serverDot: {\n    width: 30,\n    height: 30,\n    borderRadius: 10,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  serverName: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 13,\n    color: Colors.dark.text,\n  },\n  serverCity: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 11,\n    color: Colors.dark.accent,\n    letterSpacing: 0.3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  encryptedBadge: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n    marginLeft: 8,\n    backgroundColor: 'rgba(0, 240, 255, 0.08)',\n    paddingHorizontal: 8,\n    paddingVertical: 3,\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: 'rgba(0, 240, 255, 0.15)',\n  },\n  encryptedText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.accent,\n    letterSpacing: 1,\n  },\n  mapSection: {\n    marginTop: 20,\n    gap: 10,\n  },\n  sectionHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingHorizontal: 24,\n  },\n  sectionTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 10,\n    color: Colors.dark.accent,\n    letterSpacing: 3,\n    paddingHorizontal: 24,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  nodeCount: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 5,\n  },\n  nodeCountDot: {\n    width: 5,\n    height: 5,\n    borderRadius: 2.5,\n    backgroundColor: Colors.dark.accent,\n  },\n  nodeCountText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 11,\n    color: '#FFFFFF',\n    letterSpacing: 0.3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  ipSection: {\n    marginTop: 20,\n  },\n  leakSection: {\n    marginTop: 20,\n  },\n  telemetrySection: {\n    marginTop: 24,\n    gap: 12,\n  },\n  emergencySection: {\n    marginTop: 24,\n    paddingHorizontal: 20,\n  },\n  emergencyButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 10,\n    backgroundColor: '#FF3131',\n    borderRadius: 16,\n    paddingVertical: 16,\n    borderWidth: 2,\n    borderColor: 'rgba(255,49,49,0.6)',\n    shadowColor: '#FF3131',\n    shadowOffset: { width: 0, height: 0 },\n    shadowOpacity: 0.5,\n    shadowRadius: 16,\n    elevation: 8,\n  },\n  emergencyText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 13,\n    color: '#FFFFFF',\n    letterSpacing: 3,\n    textShadowColor: 'rgba(0,0,0,0.5)',\n    textShadowOffset: { width: 0, height: 1 },\n    textShadowRadius: 2,\n  },\n  bottomSpacer: {\n    height: Platform.OS === 'web' ? 34 : 80,\n  },\n});\n","path":null,"size_bytes":10936,"size_tokens":null},"components/components/RadarOverlay.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, Dimensions, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withTiming,\n  withRepeat,\n  withDelay,\n  withSequence,\n  Easing,\n  interpolate,\n  runOnJS,\n} from 'react-native-reanimated';\nimport Svg, { Circle, Line } from 'react-native-svg';\nimport { Ionicons } from '@expo/vector-icons';\nimport Colors from '@/constants/colors';\n\nconst { width: SCREEN_W, height: SCREEN_H } = Dimensions.get('window');\nconst CENTER_X = SCREEN_W / 2;\nconst CENTER_Y = SCREEN_H / 2;\nconst RADAR_RADIUS = Math.min(SCREEN_W, SCREEN_H) * 0.38;\n\ninterface RadarOverlayProps {\n  visible: boolean;\n  onComplete: () => void;\n}\n\nfunction RadarGrid() {\n  const rings = [0.25, 0.5, 0.75, 1.0];\n  const lines = [0, 45, 90, 135];\n  return (\n    <Svg width={SCREEN_W} height={SCREEN_H} style={StyleSheet.absoluteFill}>\n      {rings.map((r, i) => (\n        <Circle\n          key={`ring-${i}`}\n          cx={CENTER_X}\n          cy={CENTER_Y}\n          r={RADAR_RADIUS * r}\n          stroke=\"rgba(0,240,255,0.08)\"\n          strokeWidth={1}\n          fill=\"none\"\n        />\n      ))}\n      {lines.map((angle, i) => {\n        const rad = (angle * Math.PI) / 180;\n        const x2 = CENTER_X + Math.cos(rad) * RADAR_RADIUS;\n        const y2 = CENTER_Y + Math.sin(rad) * RADAR_RADIUS;\n        const x1 = CENTER_X - Math.cos(rad) * RADAR_RADIUS;\n        const y1 = CENTER_Y - Math.sin(rad) * RADAR_RADIUS;\n        return (\n          <Line\n            key={`line-${i}`}\n            x1={x1}\n            y1={y1}\n            x2={x2}\n            y2={y2}\n            stroke=\"rgba(0,240,255,0.05)\"\n            strokeWidth={1}\n          />\n        );\n      })}\n    </Svg>\n  );\n}\n\nfunction SweepBeam() {\n  const rotation = useSharedValue(0);\n\n  useEffect(() => {\n    rotation.value = withRepeat(\n      withTiming(360, { duration: 1800, easing: Easing.linear }),\n      -1,\n      false\n    );\n  }, []);\n\n  const sweepStyle = useAnimatedStyle(() => ({\n    transform: [{ rotate: `${rotation.value}deg` }],\n  }));\n\n  return (\n    <Animated.View style={[sweepStyles.container, sweepStyle]}>\n      <View style={sweepStyles.beam} />\n    </Animated.View>\n  );\n}\n\nconst sweepStyles = StyleSheet.create({\n  container: {\n    position: 'absolute',\n    width: RADAR_RADIUS * 2,\n    height: RADAR_RADIUS * 2,\n    left: CENTER_X - RADAR_RADIUS,\n    top: CENTER_Y - RADAR_RADIUS,\n  },\n  beam: {\n    position: 'absolute',\n    left: RADAR_RADIUS,\n    width: RADAR_RADIUS,\n    height: 3,\n    borderRadius: 1.5,\n    top: RADAR_RADIUS - 1.5,\n    backgroundColor: 'rgba(0,240,255,0.3)',\n  },\n});\n\nfunction PingBlip({ x, y, delay }: { x: number; y: number; delay: number }) {\n  const scale = useSharedValue(0);\n  const opacity = useSharedValue(0);\n\n  useEffect(() => {\n    scale.value = withDelay(\n      delay,\n      withRepeat(\n        withSequence(\n          withTiming(1, { duration: 600, easing: Easing.out(Easing.ease) }),\n          withTiming(0, { duration: 400 })\n        ),\n        -1,\n        false\n      )\n    );\n    opacity.value = withDelay(\n      delay,\n      withRepeat(\n        withSequence(\n          withTiming(1, { duration: 300 }),\n          withTiming(0, { duration: 700 })\n        ),\n        -1,\n        false\n      )\n    );\n  }, []);\n\n  const blipStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n    opacity: opacity.value,\n  }));\n\n  return (\n    <Animated.View\n      style={[\n        {\n          position: 'absolute',\n          left: CENTER_X + x - 6,\n          top: CENTER_Y + y - 6,\n          width: 12,\n          height: 12,\n          borderRadius: 6,\n          backgroundColor: Colors.dark.accent,\n        },\n        blipStyle,\n      ]}\n    />\n  );\n}\n\nexport function RadarOverlay({ visible, onComplete }: RadarOverlayProps) {\n  const overlayOpacity = useSharedValue(0);\n  const textOpacity = useSharedValue(0);\n  const progressWidth = useSharedValue(0);\n  const statusOpacity = useSharedValue(0);\n  const checkScale = useSharedValue(0);\n\n  useEffect(() => {\n    if (visible) {\n      overlayOpacity.value = withTiming(1, { duration: 400 });\n      textOpacity.value = withDelay(300, withTiming(1, { duration: 400 }));\n      progressWidth.value = withDelay(400, withTiming(1, { duration: 2400, easing: Easing.inOut(Easing.ease) }));\n      statusOpacity.value = withDelay(500, withRepeat(withTiming(1, { duration: 800 }), 5, true));\n      checkScale.value = withDelay(2800, withSequence(\n        withTiming(1.3, { duration: 200 }),\n        withTiming(1, { duration: 200 })\n      ));\n      setTimeout(() => {\n        overlayOpacity.value = withTiming(0, { duration: 500 });\n        setTimeout(() => onComplete(), 500);\n      }, 3400);\n    } else {\n      overlayOpacity.value = withTiming(0, { duration: 300 });\n      textOpacity.value = 0;\n      progressWidth.value = 0;\n      statusOpacity.value = 0;\n      checkScale.value = 0;\n    }\n  }, [visible]);\n\n  const overlayStyle = useAnimatedStyle(() => ({\n    opacity: overlayOpacity.value,\n  }));\n\n  const textStyle = useAnimatedStyle(() => ({\n    opacity: textOpacity.value,\n  }));\n\n  const progressStyle = useAnimatedStyle(() => ({\n    width: `${interpolate(progressWidth.value, [0, 1], [0, 100])}%` as any,\n  }));\n\n  const statusStyle = useAnimatedStyle(() => ({\n    opacity: statusOpacity.value,\n  }));\n\n  const checkStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: checkScale.value }],\n    opacity: checkScale.value,\n  }));\n\n  const blips = [\n    { x: -RADAR_RADIUS * 0.5, y: -RADAR_RADIUS * 0.3, delay: 200 },\n    { x: RADAR_RADIUS * 0.4, y: -RADAR_RADIUS * 0.6, delay: 600 },\n    { x: -RADAR_RADIUS * 0.7, y: RADAR_RADIUS * 0.2, delay: 400 },\n    { x: RADAR_RADIUS * 0.3, y: RADAR_RADIUS * 0.5, delay: 800 },\n    { x: RADAR_RADIUS * 0.6, y: -RADAR_RADIUS * 0.1, delay: 1000 },\n    { x: -RADAR_RADIUS * 0.2, y: RADAR_RADIUS * 0.7, delay: 1200 },\n  ];\n\n  if (!visible) return null;\n\n  return (\n    <Animated.View \n      style={[styles.overlay, overlayStyle]}\n      pointerEvents={visible ? 'auto' : 'none'}\n    >\n      <RadarGrid />\n      <SweepBeam />\n      {blips.map((b, i) => (\n        <PingBlip key={i} x={b.x} y={b.y} delay={b.delay} />\n      ))}\n\n      <View style={styles.centerContent}>\n        <Animated.View style={checkStyle}>\n          <Ionicons name=\"shield-checkmark\" size={40} color={Colors.dark.accent} />\n        </Animated.View>\n      </View>\n\n      <View style={styles.bottomContent}>\n        <Animated.View style={textStyle}>\n          <Text style={styles.scanTitle}>SCANNING NETWORK</Text>\n        </Animated.View>\n\n        <Animated.View style={statusStyle}>\n          <Text style={styles.scanStatus}>Establishing encrypted tunnel...</Text>\n        </Animated.View>\n\n        <View style={styles.progressTrack}>\n          <Animated.View style={[styles.progressFill, progressStyle]} />\n        </View>\n\n        <View style={styles.checksRow}>\n          <CheckItem label=\"DNS Secure\" delay={800} />\n          <CheckItem label=\"AES-256-GCM\" delay={1500} />\n          <CheckItem label=\"Handshake OK\" delay={2200} />\n          <CheckItem label=\"Tunnel Active\" delay={2800} />\n        </View>\n      </View>\n    </Animated.View>\n  );\n}\n\nfunction CheckItem({ label, delay }: { label: string; delay: number }) {\n  const opacity = useSharedValue(0);\n  const translateX = useSharedValue(-10);\n\n  useEffect(() => {\n    opacity.value = withDelay(delay, withTiming(1, { duration: 400 }));\n    translateX.value = withDelay(delay, withTiming(0, { duration: 400 }));\n  }, []);\n\n  const style = useAnimatedStyle(() => ({\n    opacity: opacity.value,\n    transform: [{ translateX: translateX.value }],\n  }));\n\n  return (\n    <Animated.View style={[styles.checkItem, style]}>\n      <Ionicons name=\"checkmark-circle\" size={14} color={Colors.dark.success} />\n      <Text style={styles.checkLabel}>{label}</Text>\n    </Animated.View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  overlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(8,8,8,0.95)',\n    zIndex: 100,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  centerContent: {\n    position: 'absolute',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  bottomContent: {\n    position: 'absolute',\n    bottom: Platform.OS === 'web' ? 120 : 160,\n    left: 0,\n    right: 0,\n    alignItems: 'center',\n    gap: 12,\n    paddingHorizontal: 40,\n  },\n  scanTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 14,\n    color: Colors.dark.accent,\n    letterSpacing: 4,\n  },\n  scanStatus: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  progressTrack: {\n    width: '80%',\n    height: 3,\n    backgroundColor: 'rgba(255,255,255,0.06)',\n    borderRadius: 2,\n    overflow: 'hidden',\n  },\n  progressFill: {\n    height: '100%',\n    backgroundColor: Colors.dark.accent,\n    borderRadius: 2,\n  },\n  checksRow: {\n    flexDirection: 'row',\n    gap: 16,\n    marginTop: 4,\n  },\n  checkItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n  },\n  checkLabel: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.success,\n    letterSpacing: 1,\n  },\n});\n","path":null,"size_bytes":9198,"size_tokens":null},"app/(tabs)/stats.tsx":{"content":"import React from 'react';\nimport { View, Text, StyleSheet, ScrollView, Platform, Dimensions } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport Svg, { Circle } from 'react-native-svg';\nimport { NoiseBackground } from '@/components/NoiseBackground';\nimport { GlassCard } from '@/components/GlassCard';\nimport { useVpn } from '@/lib/vpn-context';\nimport Colors from '@/constants/colors';\n\nconst { width } = Dimensions.get('window');\n\nfunction ProgressRing({ value, max, color, size = 110, strokeWidth = 5 }: { value: number; max: number; color: string; size?: number; strokeWidth?: number }) {\n  const radius = (size - strokeWidth * 2) / 2;\n  const circumference = 2 * Math.PI * radius;\n  const progress = Math.min(value / max, 1);\n  const offset = circumference * (1 - progress);\n\n  return (\n    <Svg width={size} height={size}>\n      <Circle cx={size / 2} cy={size / 2} r={radius} stroke=\"rgba(255,255,255,0.05)\" strokeWidth={strokeWidth} fill=\"none\" />\n      <Circle cx={size / 2} cy={size / 2} r={radius} stroke={color} strokeWidth={strokeWidth} fill=\"none\" strokeDasharray={circumference} strokeDashoffset={offset} strokeLinecap=\"round\" rotation=\"-90\" origin={`${size / 2}, ${size / 2}`} />\n    </Svg>\n  );\n}\n\nfunction formatDataSize(mb: number): string {\n  if (mb < 1) return `${(mb * 1024).toFixed(0)} KB`;\n  if (mb < 1024) return `${mb.toFixed(1)} MB`;\n  return `${(mb / 1024).toFixed(2)} GB`;\n}\n\nfunction formatDuration(seconds: number): string {\n  const h = Math.floor(seconds / 3600);\n  const m = Math.floor((seconds % 3600) / 60);\n  const s = seconds % 60;\n  if (h > 0) return `${h}h ${m}m ${s}s`;\n  if (m > 0) return `${m}m ${s}s`;\n  return `${s}s`;\n}\n\nexport default function StatsScreen() {\n  const insets = useSafeAreaInsets();\n  const { isConnected, stats, selectedServer, protocol } = useVpn();\n  const topPadding = Platform.OS === 'web' ? 67 : insets.top;\n  const ringSize = Math.min((width - 80) / 3, 110);\n\n  return (\n    <NoiseBackground>\n      <ScrollView\n        style={[styles.container, { paddingTop: topPadding }]}\n        contentContainerStyle={styles.scrollContent}\n        showsVerticalScrollIndicator={false}\n      >\n        <View style={styles.header}>\n          <Text style={styles.title}>Statistics</Text>\n          <Text style={styles.subtitle}>Real-time connection metrics</Text>\n        </View>\n\n        <GlassCard style={styles.mainStatsCard} intensity=\"medium\" glowColor={isConnected ? Colors.dark.accent : undefined}>\n          <View style={styles.connectionStatusRow}>\n            <View style={[styles.liveIndicator, { backgroundColor: isConnected ? Colors.dark.success : Colors.dark.textMuted }]} />\n            <Text style={[styles.connectionStatus, { color: isConnected ? Colors.dark.success : Colors.dark.textMuted }]}>\n              {isConnected ? 'LIVE SESSION' : 'NO ACTIVE SESSION'}\n            </Text>\n          </View>\n\n          <View style={styles.ringsRow}>\n            <View style={styles.ringItem}>\n              <View style={styles.ringWrapper}>\n                <ProgressRing value={isConnected ? stats.downloadSpeed : 0} max={150} color={Colors.dark.accent} size={ringSize} />\n                <View style={[styles.ringCenter, { width: ringSize, height: ringSize }]}>\n                  <Text style={[styles.ringValue, { color: Colors.dark.accent }]}>{isConnected ? stats.downloadSpeed.toFixed(0) : '0'}</Text>\n                  <Text style={styles.ringUnit}>Mbps</Text>\n                </View>\n              </View>\n              <Text style={styles.ringLabel}>Download</Text>\n            </View>\n\n            <View style={styles.ringItem}>\n              <View style={styles.ringWrapper}>\n                <ProgressRing value={isConnected ? stats.uploadSpeed : 0} max={80} color={Colors.dark.accentPurple} size={ringSize} />\n                <View style={[styles.ringCenter, { width: ringSize, height: ringSize }]}>\n                  <Text style={[styles.ringValue, { color: Colors.dark.accentPurple }]}>{isConnected ? stats.uploadSpeed.toFixed(0) : '0'}</Text>\n                  <Text style={styles.ringUnit}>Mbps</Text>\n                </View>\n              </View>\n              <Text style={styles.ringLabel}>Upload</Text>\n            </View>\n\n            <View style={styles.ringItem}>\n              <View style={styles.ringWrapper}>\n                <ProgressRing value={isConnected ? stats.ping : 0} max={200} color={Colors.dark.accentCoral} size={ringSize} />\n                <View style={[styles.ringCenter, { width: ringSize, height: ringSize }]}>\n                  <Text style={[styles.ringValue, { color: Colors.dark.accentCoral }]}>{isConnected ? stats.ping : '0'}</Text>\n                  <Text style={styles.ringUnit}>ms</Text>\n                </View>\n              </View>\n              <Text style={styles.ringLabel}>Latency</Text>\n            </View>\n          </View>\n        </GlassCard>\n\n        <View style={styles.detailsGrid}>\n          <GlassCard style={styles.detailCard} intensity=\"low\">\n            <Ionicons name=\"cloud-download-outline\" size={20} color={Colors.dark.accent} />\n            <Text style={styles.detailLabel}>Data Used</Text>\n            <Text style={[styles.detailValue, { color: Colors.dark.accent }]}>{formatDataSize(stats.dataUsed)}</Text>\n          </GlassCard>\n\n          <GlassCard style={styles.detailCard} intensity=\"low\">\n            <Ionicons name=\"time-outline\" size={20} color={Colors.dark.accentPurple} />\n            <Text style={styles.detailLabel}>Duration</Text>\n            <Text style={[styles.detailValue, { color: Colors.dark.accentPurple }]}>{formatDuration(stats.sessionDuration)}</Text>\n          </GlassCard>\n        </View>\n\n        <View style={styles.detailsGrid}>\n          <GlassCard style={styles.detailCard} intensity=\"low\">\n            <MaterialCommunityIcons name=\"shield-lock-outline\" size={20} color={Colors.dark.success} />\n            <Text style={styles.detailLabel}>Protocol</Text>\n            <Text style={[styles.detailValue, { color: Colors.dark.success }]}>{protocol}</Text>\n          </GlassCard>\n\n          <GlassCard style={styles.detailCard} intensity=\"low\">\n            <Ionicons name=\"location-outline\" size={20} color={Colors.dark.warning} />\n            <Text style={styles.detailLabel}>Server</Text>\n            <Text style={[styles.detailValue, { color: Colors.dark.warning }]} numberOfLines={1}>{selectedServer?.name || 'None'}</Text>\n          </GlassCard>\n        </View>\n\n        <GlassCard style={styles.encryptionCard} intensity=\"low\">\n          <View style={styles.encryptionRow}>\n            <View style={styles.encryptionLeft}>\n              <MaterialCommunityIcons name=\"lock-outline\" size={20} color={Colors.dark.accent} />\n              <View>\n                <Text style={styles.encryptionTitle}>Encryption</Text>\n                <Text style={styles.encryptionValue}>AES-256-GCM</Text>\n              </View>\n            </View>\n            <View style={styles.encryptionBadge}>\n              <Text style={styles.encryptionBadgeText}>Military Grade</Text>\n            </View>\n          </View>\n        </GlassCard>\n      </ScrollView>\n    </NoiseBackground>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  scrollContent: {\n    paddingBottom: 120,\n  },\n  header: {\n    paddingHorizontal: 24,\n    paddingTop: 12,\n    paddingBottom: 16,\n  },\n  title: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 22,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  subtitle: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 13,\n    color: Colors.dark.textMuted,\n    marginTop: 4,\n  },\n  mainStatsCard: {\n    marginHorizontal: 20,\n    padding: 20,\n    marginBottom: 16,\n  },\n  connectionStatusRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n    marginBottom: 20,\n  },\n  liveIndicator: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n  },\n  connectionStatus: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 10,\n    letterSpacing: 2,\n  },\n  ringsRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    alignItems: 'center',\n  },\n  ringItem: {\n    alignItems: 'center',\n    gap: 8,\n  },\n  ringWrapper: {\n    position: 'relative',\n  },\n  ringCenter: {\n    position: 'absolute',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  ringValue: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 18,\n  },\n  ringUnit: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 9,\n    color: Colors.dark.textSecondary,\n    marginTop: 1,\n  },\n  ringLabel: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.textMuted,\n  },\n  detailsGrid: {\n    flexDirection: 'row',\n    paddingHorizontal: 20,\n    gap: 10,\n    marginBottom: 10,\n  },\n  detailCard: {\n    flex: 1,\n    padding: 16,\n    gap: 8,\n    alignItems: 'center',\n  },\n  detailLabel: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.textMuted,\n  },\n  detailValue: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 13,\n  },\n  encryptionCard: {\n    marginHorizontal: 20,\n    padding: 16,\n    marginTop: 6,\n  },\n  encryptionRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  encryptionLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n  },\n  encryptionTitle: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.textMuted,\n  },\n  encryptionValue: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    color: Colors.dark.text,\n  },\n  encryptionBadge: {\n    backgroundColor: 'rgba(0, 240, 255, 0.1)',\n    paddingHorizontal: 10,\n    paddingVertical: 5,\n    borderRadius: 10,\n    borderWidth: 1,\n    borderColor: 'rgba(0, 240, 255, 0.2)',\n  },\n  encryptionBadgeText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.accent,\n    letterSpacing: 1,\n  },\n});\n","path":null,"size_bytes":9991,"size_tokens":null},"server/index.ts":{"content":"import express from \"express\";\nimport type { Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\nconst app = express();\nconst log = console.log;\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\nfunction setupCors(app: express.Application) {\n  app.use((req, res, next) => {\n    const origins = new Set<string>();\n\n    if (process.env.REPLIT_DEV_DOMAIN) {\n      origins.add(`https://${process.env.REPLIT_DEV_DOMAIN}`);\n    }\n\n    if (process.env.REPLIT_DOMAINS) {\n      process.env.REPLIT_DOMAINS.split(\",\").forEach((d) => {\n        origins.add(`https://${d.trim()}`);\n      });\n    }\n\n    const origin = req.header(\"origin\");\n\n    // Allow localhost origins for Expo web development (any port)\n    const isLocalhost =\n      origin?.startsWith(\"http://localhost:\") ||\n      origin?.startsWith(\"http://127.0.0.1:\");\n\n    if (origin && (origins.has(origin) || isLocalhost)) {\n      res.header(\"Access-Control-Allow-Origin\", origin);\n      res.header(\n        \"Access-Control-Allow-Methods\",\n        \"GET, POST, PUT, DELETE, OPTIONS\",\n      );\n      res.header(\"Access-Control-Allow-Headers\", \"Content-Type\");\n      res.header(\"Access-Control-Allow-Credentials\", \"true\");\n    }\n\n    if (req.method === \"OPTIONS\") {\n      return res.sendStatus(200);\n    }\n\n    next();\n  });\n}\n\nfunction setupBodyParsing(app: express.Application) {\n  app.use(\n    express.json({\n      verify: (req, _res, buf) => {\n        req.rawBody = buf;\n      },\n    }),\n  );\n\n  app.use(express.urlencoded({ extended: false }));\n}\n\nfunction setupRequestLogging(app: express.Application) {\n  app.use((req, res, next) => {\n    const start = Date.now();\n    const path = req.path;\n    let capturedJsonResponse: Record<string, unknown> | undefined = undefined;\n\n    const originalResJson = res.json;\n    res.json = function (bodyJson, ...args) {\n      capturedJsonResponse = bodyJson;\n      return originalResJson.apply(res, [bodyJson, ...args]);\n    };\n\n    res.on(\"finish\", () => {\n      if (!path.startsWith(\"/api\")) return;\n\n      const duration = Date.now() - start;\n\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    });\n\n    next();\n  });\n}\n\nfunction getAppName(): string {\n  try {\n    const appJsonPath = path.resolve(process.cwd(), \"app.json\");\n    const appJsonContent = fs.readFileSync(appJsonPath, \"utf-8\");\n    const appJson = JSON.parse(appJsonContent);\n    return appJson.expo?.name || \"App Landing Page\";\n  } catch {\n    return \"App Landing Page\";\n  }\n}\n\nfunction serveExpoManifest(platform: string, res: Response) {\n  const manifestPath = path.resolve(\n    process.cwd(),\n    \"static-build\",\n    platform,\n    \"manifest.json\",\n  );\n\n  if (!fs.existsSync(manifestPath)) {\n    return res\n      .status(404)\n      .json({ error: `Manifest not found for platform: ${platform}` });\n  }\n\n  res.setHeader(\"expo-protocol-version\", \"1\");\n  res.setHeader(\"expo-sfv-version\", \"0\");\n  res.setHeader(\"content-type\", \"application/json\");\n\n  const manifest = fs.readFileSync(manifestPath, \"utf-8\");\n  res.send(manifest);\n}\n\nfunction serveLandingPage({\n  req,\n  res,\n  landingPageTemplate,\n  appName,\n}: {\n  req: Request;\n  res: Response;\n  landingPageTemplate: string;\n  appName: string;\n}) {\n  const forwardedProto = req.header(\"x-forwarded-proto\");\n  const protocol = forwardedProto || req.protocol || \"https\";\n  const forwardedHost = req.header(\"x-forwarded-host\");\n  const host = forwardedHost || req.get(\"host\");\n  const baseUrl = `${protocol}://${host}`;\n  const expsUrl = `${host}`;\n\n  log(`baseUrl`, baseUrl);\n  log(`expsUrl`, expsUrl);\n\n  const html = landingPageTemplate\n    .replace(/BASE_URL_PLACEHOLDER/g, baseUrl)\n    .replace(/EXPS_URL_PLACEHOLDER/g, expsUrl)\n    .replace(/APP_NAME_PLACEHOLDER/g, appName);\n\n  res.setHeader(\"Content-Type\", \"text/html; charset=utf-8\");\n  res.status(200).send(html);\n}\n\nfunction configureExpoAndLanding(app: express.Application) {\n  const templatePath = path.resolve(\n    process.cwd(),\n    \"server\",\n    \"templates\",\n    \"landing-page.html\",\n  );\n  const landingPageTemplate = fs.readFileSync(templatePath, \"utf-8\");\n  const appName = getAppName();\n\n  log(\"Serving static Expo files with dynamic manifest routing\");\n\n  app.use((req: Request, res: Response, next: NextFunction) => {\n    if (req.path.startsWith(\"/api\")) {\n      return next();\n    }\n\n    if (req.path !== \"/\" && req.path !== \"/manifest\") {\n      return next();\n    }\n\n    const platform = req.header(\"expo-platform\");\n    if (platform && (platform === \"ios\" || platform === \"android\")) {\n      return serveExpoManifest(platform, res);\n    }\n\n    if (req.path === \"/\") {\n      return serveLandingPage({\n        req,\n        res,\n        landingPageTemplate,\n        appName,\n      });\n    }\n\n    next();\n  });\n\n  app.use(\"/assets\", express.static(path.resolve(process.cwd(), \"assets\")));\n  app.use(express.static(path.resolve(process.cwd(), \"static-build\")));\n\n  log(\"Expo routing: Checking expo-platform header on / and /manifest\");\n}\n\nfunction setupWebProxy(app: express.Application) {\n  if (process.env.NODE_ENV !== \"development\") return;\n\n  const { createProxyMiddleware } = require(\"http-proxy-middleware\");\n  const metroProxy = createProxyMiddleware({\n    target: \"http://127.0.0.1:8081\",\n    changeOrigin: true,\n    ws: true,\n    logLevel: \"silent\",\n  });\n\n  app.use((req: Request, res: Response, next: NextFunction) => {\n    if (req.path.startsWith(\"/api\")) return next();\n\n    const platform = req.header(\"expo-platform\");\n    if (platform && (platform === \"ios\" || platform === \"android\")) return next();\n\n    const ua = req.header(\"user-agent\") || \"\";\n    const isWebBrowser = !platform && (ua.includes(\"Mozilla\") || ua.includes(\"Chrome\") || ua.includes(\"Safari\"));\n\n    if (isWebBrowser || req.path.includes(\"bundle\") || req.path.includes(\"hot\") || req.path.includes(\"__metro\")) {\n      return metroProxy(req, res, next);\n    }\n\n    next();\n  });\n}\n\nfunction setupErrorHandler(app: express.Application) {\n  app.use((err: unknown, _req: Request, res: Response, next: NextFunction) => {\n    const error = err as {\n      status?: number;\n      statusCode?: number;\n      message?: string;\n    };\n\n    const status = error.status || error.statusCode || 500;\n    const message = error.message || \"Internal Server Error\";\n\n    console.error(\"Internal Server Error:\", err);\n\n    if (res.headersSent) {\n      return next(err);\n    }\n\n    return res.status(status).json({ message });\n  });\n}\n\n(async () => {\n  setupCors(app);\n  setupBodyParsing(app);\n  setupRequestLogging(app);\n\n  const server = await registerRoutes(app);\n\n  setupWebProxy(app);\n\n  configureExpoAndLanding(app);\n\n  setupErrorHandler(app);\n\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  server.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`express server serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":7201,"size_tokens":null},"backend/auth.py":{"content":"import os\nimport jwt\nimport bcrypt\nfrom datetime import datetime, timezone, timedelta\nfrom fastapi import HTTPException, Depends, Request\nfrom fastapi.security import HTTPBearer, HTTPAuthorizationCredentials\nfrom sqlalchemy.orm import Session\nfrom backend.database import get_db\nfrom backend.models import User\n\n_DEFAULT_JWT_SECRET = \"xvpn-dev-secret-key-for-local-development-only-2026\"\nJWT_SECRET = os.environ.get(\"JWT_SECRET\", _DEFAULT_JWT_SECRET)\nJWT_ALGORITHM = \"HS256\"\nACCESS_TOKEN_EXPIRE_MINUTES = 60\nREFRESH_TOKEN_EXPIRE_DAYS = 30\n\nsecurity = HTTPBearer(auto_error=False)\n\n\ndef hash_password(password: str) -> str:\n    return bcrypt.hashpw(password.encode(\"utf-8\"), bcrypt.gensalt()).decode(\"utf-8\")\n\n\ndef verify_password(plain_password: str, hashed_password: str) -> bool:\n    return bcrypt.checkpw(plain_password.encode(\"utf-8\"), hashed_password.encode(\"utf-8\"))\n\n\ndef create_access_token(user_id: str, username: str) -> str:\n    payload = {\n        \"sub\": user_id,\n        \"username\": username,\n        \"type\": \"access\",\n        \"exp\": datetime.now(timezone.utc) + timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES),\n        \"iat\": datetime.now(timezone.utc),\n    }\n    return jwt.encode(payload, JWT_SECRET, algorithm=JWT_ALGORITHM)\n\n\ndef create_refresh_token(user_id: str) -> str:\n    payload = {\n        \"sub\": user_id,\n        \"type\": \"refresh\",\n        \"exp\": datetime.now(timezone.utc) + timedelta(days=REFRESH_TOKEN_EXPIRE_DAYS),\n        \"iat\": datetime.now(timezone.utc),\n    }\n    return jwt.encode(payload, JWT_SECRET, algorithm=JWT_ALGORITHM)\n\n\ndef decode_token(token: str) -> dict:\n    try:\n        payload = jwt.decode(token, JWT_SECRET, algorithms=[JWT_ALGORITHM])\n        return payload\n    except jwt.ExpiredSignatureError:\n        raise HTTPException(status_code=401, detail=\"Token has expired\")\n    except jwt.InvalidTokenError:\n        raise HTTPException(status_code=401, detail=\"Invalid token\")\n\n\ndef get_current_user(\n    credentials: HTTPAuthorizationCredentials = Depends(security),\n    db: Session = Depends(get_db),\n) -> User:\n    if not credentials:\n        raise HTTPException(status_code=401, detail=\"Authentication required\")\n\n    payload = decode_token(credentials.credentials)\n\n    if payload.get(\"type\") != \"access\":\n        raise HTTPException(status_code=401, detail=\"Invalid token type\")\n\n    user = db.query(User).filter(User.id == payload[\"sub\"]).first()\n    if not user:\n        raise HTTPException(status_code=401, detail=\"User not found\")\n    if user.is_active is not True:\n        raise HTTPException(status_code=401, detail=\"Account is deactivated\")\n\n    return user\n\n\ndef get_optional_user(\n    credentials: HTTPAuthorizationCredentials = Depends(security),\n    db: Session = Depends(get_db),\n) -> User | None:\n    if not credentials:\n        return None\n\n    try:\n        payload = decode_token(credentials.credentials)\n        if payload.get(\"type\") != \"access\":\n            return None\n        user = db.query(User).filter(User.id == payload[\"sub\"]).first()\n        if user and user.is_active is True:\n            return user\n        return None\n    except HTTPException:\n        return None\n","path":null,"size_bytes":3146,"size_tokens":null},"components/RadarOverlay.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, Dimensions, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withTiming,\n  withRepeat,\n  withDelay,\n  withSequence,\n  Easing,\n  interpolate,\n  runOnJS,\n} from 'react-native-reanimated';\nimport Svg, { Circle, Line } from 'react-native-svg';\nimport { Ionicons } from '@expo/vector-icons';\nimport Colors from '@/constants/colors';\n\nconst { width: SCREEN_W, height: SCREEN_H } = Dimensions.get('window');\nconst CENTER_X = SCREEN_W / 2;\nconst CENTER_Y = SCREEN_H / 2;\nconst RADAR_RADIUS = Math.min(SCREEN_W, SCREEN_H) * 0.38;\n\ninterface RadarOverlayProps {\n  visible: boolean;\n  onComplete: () => void;\n}\n\nfunction RadarGrid() {\n  const rings = [0.25, 0.5, 0.75, 1.0];\n  const lines = [0, 45, 90, 135];\n  return (\n    <Svg width={SCREEN_W} height={SCREEN_H} style={StyleSheet.absoluteFill}>\n      {rings.map((r, i) => (\n        <Circle\n          key={`ring-${i}`}\n          cx={CENTER_X}\n          cy={CENTER_Y}\n          r={RADAR_RADIUS * r}\n          stroke=\"rgba(0,240,255,0.08)\"\n          strokeWidth={1}\n          fill=\"none\"\n        />\n      ))}\n      {lines.map((angle, i) => {\n        const rad = (angle * Math.PI) / 180;\n        const x2 = CENTER_X + Math.cos(rad) * RADAR_RADIUS;\n        const y2 = CENTER_Y + Math.sin(rad) * RADAR_RADIUS;\n        const x1 = CENTER_X - Math.cos(rad) * RADAR_RADIUS;\n        const y1 = CENTER_Y - Math.sin(rad) * RADAR_RADIUS;\n        return (\n          <Line\n            key={`line-${i}`}\n            x1={x1}\n            y1={y1}\n            x2={x2}\n            y2={y2}\n            stroke=\"rgba(0,240,255,0.05)\"\n            strokeWidth={1}\n          />\n        );\n      })}\n    </Svg>\n  );\n}\n\nfunction SweepBeam() {\n  const rotation = useSharedValue(0);\n\n  useEffect(() => {\n    rotation.value = withRepeat(\n      withTiming(360, { duration: 1800, easing: Easing.linear }),\n      -1,\n      false\n    );\n  }, []);\n\n  const sweepStyle = useAnimatedStyle(() => ({\n    transform: [{ rotate: `${rotation.value}deg` }],\n  }));\n\n  return (\n    <Animated.View style={[sweepStyles.container, sweepStyle]}>\n      <View style={sweepStyles.beam} />\n    </Animated.View>\n  );\n}\n\nconst sweepStyles = StyleSheet.create({\n  container: {\n    position: 'absolute',\n    width: RADAR_RADIUS * 2,\n    height: RADAR_RADIUS * 2,\n    left: CENTER_X - RADAR_RADIUS,\n    top: CENTER_Y - RADAR_RADIUS,\n  },\n  beam: {\n    position: 'absolute',\n    left: RADAR_RADIUS,\n    width: RADAR_RADIUS,\n    height: 3,\n    borderRadius: 1.5,\n    top: RADAR_RADIUS - 1.5,\n    backgroundColor: 'rgba(0,240,255,0.3)',\n  },\n});\n\nfunction PingBlip({ x, y, delay }: { x: number; y: number; delay: number }) {\n  const scale = useSharedValue(0);\n  const opacity = useSharedValue(0);\n\n  useEffect(() => {\n    scale.value = withDelay(\n      delay,\n      withRepeat(\n        withSequence(\n          withTiming(1, { duration: 600, easing: Easing.out(Easing.ease) }),\n          withTiming(0, { duration: 400 })\n        ),\n        -1,\n        false\n      )\n    );\n    opacity.value = withDelay(\n      delay,\n      withRepeat(\n        withSequence(\n          withTiming(1, { duration: 300 }),\n          withTiming(0, { duration: 700 })\n        ),\n        -1,\n        false\n      )\n    );\n  }, []);\n\n  const blipStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n    opacity: opacity.value,\n  }));\n\n  return (\n    <Animated.View\n      style={[\n        {\n          position: 'absolute',\n          left: CENTER_X + x - 6,\n          top: CENTER_Y + y - 6,\n          width: 12,\n          height: 12,\n          borderRadius: 6,\n          backgroundColor: Colors.dark.accent,\n        },\n        blipStyle,\n      ]}\n    />\n  );\n}\n\nexport function RadarOverlay({ visible, onComplete }: RadarOverlayProps) {\n  const overlayOpacity = useSharedValue(0);\n  const textOpacity = useSharedValue(0);\n  const progressWidth = useSharedValue(0);\n  const statusOpacity = useSharedValue(0);\n  const checkScale = useSharedValue(0);\n\n  useEffect(() => {\n    if (visible) {\n      overlayOpacity.value = withTiming(1, { duration: 400 });\n      textOpacity.value = withDelay(300, withTiming(1, { duration: 400 }));\n      progressWidth.value = withDelay(400, withTiming(1, { duration: 2400, easing: Easing.inOut(Easing.ease) }));\n      statusOpacity.value = withDelay(500, withRepeat(withTiming(1, { duration: 800 }), 5, true));\n      checkScale.value = withDelay(2800, withSequence(\n        withTiming(1.3, { duration: 200 }),\n        withTiming(1, { duration: 200 })\n      ));\n      setTimeout(() => {\n        overlayOpacity.value = withTiming(0, { duration: 500 });\n        setTimeout(() => onComplete(), 500);\n      }, 3400);\n    } else {\n      overlayOpacity.value = withTiming(0, { duration: 300 });\n      textOpacity.value = 0;\n      progressWidth.value = 0;\n      statusOpacity.value = 0;\n      checkScale.value = 0;\n    }\n  }, [visible]);\n\n  const overlayStyle = useAnimatedStyle(() => ({\n    opacity: overlayOpacity.value,\n  }));\n\n  const textStyle = useAnimatedStyle(() => ({\n    opacity: textOpacity.value,\n  }));\n\n  const progressStyle = useAnimatedStyle(() => ({\n    width: `${interpolate(progressWidth.value, [0, 1], [0, 100])}%` as any,\n  }));\n\n  const statusStyle = useAnimatedStyle(() => ({\n    opacity: statusOpacity.value,\n  }));\n\n  const checkStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: checkScale.value }],\n    opacity: checkScale.value,\n  }));\n\n  const blips = [\n    { x: -RADAR_RADIUS * 0.5, y: -RADAR_RADIUS * 0.3, delay: 200 },\n    { x: RADAR_RADIUS * 0.4, y: -RADAR_RADIUS * 0.6, delay: 600 },\n    { x: -RADAR_RADIUS * 0.7, y: RADAR_RADIUS * 0.2, delay: 400 },\n    { x: RADAR_RADIUS * 0.3, y: RADAR_RADIUS * 0.5, delay: 800 },\n    { x: RADAR_RADIUS * 0.6, y: -RADAR_RADIUS * 0.1, delay: 1000 },\n    { x: -RADAR_RADIUS * 0.2, y: RADAR_RADIUS * 0.7, delay: 1200 },\n  ];\n\n  if (!visible) return null;\n\n  return (\n    <Animated.View \n      style={[styles.overlay, overlayStyle]}\n      pointerEvents={visible ? 'auto' : 'none'}\n    >\n      <RadarGrid />\n      <SweepBeam />\n      {blips.map((b, i) => (\n        <PingBlip key={i} x={b.x} y={b.y} delay={b.delay} />\n      ))}\n\n      <View style={styles.centerContent}>\n        <Animated.View style={checkStyle}>\n          <Ionicons name=\"shield-checkmark\" size={40} color={Colors.dark.accent} />\n        </Animated.View>\n      </View>\n\n      <View style={styles.bottomContent}>\n        <Animated.View style={textStyle}>\n          <Text style={styles.scanTitle}>SCANNING NETWORK</Text>\n        </Animated.View>\n\n        <Animated.View style={statusStyle}>\n          <Text style={styles.scanStatus}>Establishing encrypted tunnel...</Text>\n        </Animated.View>\n\n        <View style={styles.progressTrack}>\n          <Animated.View style={[styles.progressFill, progressStyle]} />\n        </View>\n\n        <View style={styles.checksRow}>\n          <CheckItem label=\"DNS Secure\" delay={800} />\n          <CheckItem label=\"AES-256-GCM\" delay={1500} />\n          <CheckItem label=\"Handshake OK\" delay={2200} />\n          <CheckItem label=\"Tunnel Active\" delay={2800} />\n        </View>\n      </View>\n    </Animated.View>\n  );\n}\n\nfunction CheckItem({ label, delay }: { label: string; delay: number }) {\n  const opacity = useSharedValue(0);\n  const translateX = useSharedValue(-10);\n\n  useEffect(() => {\n    opacity.value = withDelay(delay, withTiming(1, { duration: 400 }));\n    translateX.value = withDelay(delay, withTiming(0, { duration: 400 }));\n  }, []);\n\n  const style = useAnimatedStyle(() => ({\n    opacity: opacity.value,\n    transform: [{ translateX: translateX.value }],\n  }));\n\n  return (\n    <Animated.View style={[styles.checkItem, style]}>\n      <Ionicons name=\"checkmark-circle\" size={14} color={Colors.dark.success} />\n      <Text style={styles.checkLabel}>{label}</Text>\n    </Animated.View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  overlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(8,8,8,0.95)',\n    zIndex: 100,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  centerContent: {\n    position: 'absolute',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  bottomContent: {\n    position: 'absolute',\n    bottom: Platform.OS === 'web' ? 120 : 160,\n    left: 0,\n    right: 0,\n    alignItems: 'center',\n    gap: 12,\n    paddingHorizontal: 40,\n  },\n  scanTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 14,\n    color: Colors.dark.accent,\n    letterSpacing: 4,\n  },\n  scanStatus: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  progressTrack: {\n    width: '80%',\n    height: 3,\n    backgroundColor: 'rgba(255,255,255,0.06)',\n    borderRadius: 2,\n    overflow: 'hidden',\n  },\n  progressFill: {\n    height: '100%',\n    backgroundColor: Colors.dark.accent,\n    borderRadius: 2,\n  },\n  checksRow: {\n    flexDirection: 'row',\n    gap: 16,\n    marginTop: 4,\n  },\n  checkItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n  },\n  checkLabel: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.success,\n    letterSpacing: 1,\n  },\n});\n","path":null,"size_bytes":9198,"size_tokens":null},"server/routes.ts":{"content":"import type { Express, Request, Response } from \"express\";\nimport { createServer, type Server } from \"node:http\";\nimport { createProxyMiddleware } from \"http-proxy-middleware\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  app.use(\n    \"/api\",\n    createProxyMiddleware({\n      target: \"http://127.0.0.1:8000\",\n      changeOrigin: true,\n      pathRewrite: { \"^/\": \"/api/\" },\n    }),\n  );\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n","path":null,"size_bytes":480,"size_tokens":null},"server/server/storage.ts":{"content":"import { type User, type InsertUser } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\n// modify the interface with any CRUD methods\n// you might need\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n\n  constructor() {\n    this.users = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n}\n\nexport const storage = new MemStorage();\n","path":null,"size_bytes":993,"size_tokens":null},"components/StatRing.tsx":{"content":"import React from 'react';\nimport { View, Text, StyleSheet, Platform } from 'react-native';\nimport Svg, { Circle } from 'react-native-svg';\nimport Colors from '@/constants/colors';\n\ninterface StatRingProps {\n  value: number;\n  maxValue: number;\n  label: string;\n  unit: string;\n  color: string;\n  size?: number;\n}\n\nexport function StatRing({ value, maxValue, label, unit, color, size = 100 }: StatRingProps) {\n  const strokeWidth = 4;\n  const radius = (size - strokeWidth * 2) / 2;\n  const circumference = 2 * Math.PI * radius;\n  const progress = Math.min(value / maxValue, 1);\n  const strokeDashoffset = circumference * (1 - progress);\n\n  return (\n    <View style={[styles.container, { width: size, height: size }]}>\n      <Svg width={size} height={size} style={styles.svg}>\n        <Circle\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          stroke=\"rgba(255,255,255,0.06)\"\n          strokeWidth={strokeWidth}\n          fill=\"none\"\n        />\n        <Circle\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          stroke={color}\n          strokeWidth={strokeWidth}\n          fill=\"none\"\n          strokeDasharray={circumference}\n          strokeDashoffset={strokeDashoffset}\n          strokeLinecap=\"round\"\n          rotation=\"-90\"\n          origin={`${size / 2}, ${size / 2}`}\n        />\n      </Svg>\n      <View style={styles.labelContainer}>\n        <Text style={[styles.value, { color }]}>{value.toFixed(1)}</Text>\n        <Text style={styles.unit}>{unit}</Text>\n        <Text style={styles.label}>{label}</Text>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  svg: {\n    position: 'absolute',\n  },\n  labelContainer: {\n    alignItems: 'center',\n  },\n  value: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 16,\n  },\n  unit: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textSecondary,\n    marginTop: 1,\n  },\n  label: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 9,\n    color: Colors.dark.textMuted,\n    marginTop: 2,\n  },\n});\n","path":null,"size_bytes":2140,"size_tokens":null},"lib/vpn-context.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, useCallback, useMemo, useRef, ReactNode } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nexport interface VpnServer {\n  id: string;\n  name: string;\n  country: string;\n  city: string;\n  flag: string;\n  ping: number;\n  load: number;\n  premium: boolean;\n}\n\nexport interface ConnectionStats {\n  downloadSpeed: number;\n  uploadSpeed: number;\n  dataUsed: number;\n  sessionDuration: number;\n  ping: number;\n}\n\nexport type ConnectionState = 'disconnected' | 'connecting' | 'protecting' | 'connected';\nexport type ConnectionError = { type: 'identity_check_failed'; message: string } | null;\n\ninterface VpnContextValue {\n  connectionState: ConnectionState;\n  connectionError: ConnectionError;\n  isConnected: boolean;\n  isConnecting: boolean;\n  isProtecting: boolean;\n  selectedServer: VpnServer | null;\n  servers: VpnServer[];\n  stats: ConnectionStats;\n  favoriteServerIds: string[];\n  connect: () => void;\n  cancelConnection: () => void;\n  completeConnection: () => void;\n  disconnect: () => void;\n  clearError: () => void;\n  selectServer: (server: VpnServer) => void;\n  toggleFavorite: (serverId: string) => void;\n  protocol: string;\n  setProtocol: (p: string) => void;\n  killSwitch: boolean;\n  setKillSwitch: (v: boolean) => void;\n  autoConnect: boolean;\n  setAutoConnect: (v: boolean) => void;\n  doubleVpn: boolean;\n  setDoubleVpn: (v: boolean) => void;\n  doubleVpnServer: VpnServer | null;\n  setDoubleVpnServer: (s: VpnServer | null) => void;\n  virtualIp: string;\n  isPremium: boolean;\n  setPremium: (v: boolean) => void;\n  subscriptionType: string | null;\n  subscriptionExpiresAt: string | null;\n  setSubscription: (type: string, expiresAt: string) => void;\n  biometricLock: boolean;\n  setBiometricLock: (v: boolean) => void;\n  dnsLeakProtection: boolean;\n  setDnsLeakProtection: (v: boolean) => void;\n  adBlocker: boolean;\n  setAdBlocker: (v: boolean) => void;\n}\n\nconst VpnContext = createContext<VpnContextValue | null>(null);\n\nconst SERVERS: VpnServer[] = [\n  { id: '1', name: 'US - New York', country: 'United States', city: 'New York', flag: 'US', ping: 12, load: 34, premium: false },\n  { id: '2', name: 'US - Los Angeles', country: 'United States', city: 'Los Angeles', flag: 'US', ping: 28, load: 52, premium: false },\n  { id: '3', name: 'US - Dallas', country: 'United States', city: 'Dallas, TX', flag: 'US', ping: 22, load: 29, premium: false },\n  { id: '4', name: 'US - Miami', country: 'United States', city: 'Miami, FL', flag: 'US', ping: 18, load: 41, premium: false },\n  { id: '5', name: 'US - Chicago', country: 'United States', city: 'Chicago, IL', flag: 'US', ping: 16, load: 38, premium: false },\n  { id: '6', name: 'US - Seattle', country: 'United States', city: 'Seattle, WA', flag: 'US', ping: 32, load: 25, premium: false },\n  { id: '7', name: 'US - Atlanta', country: 'United States', city: 'Atlanta, GA', flag: 'US', ping: 19, load: 44, premium: false },\n  { id: '8', name: 'US - Denver', country: 'United States', city: 'Denver, CO', flag: 'US', ping: 26, load: 18, premium: false },\n  { id: '9', name: 'US - Phoenix', country: 'United States', city: 'Phoenix, AZ', flag: 'US', ping: 30, load: 22, premium: false },\n  { id: '10', name: 'US - San Francisco', country: 'United States', city: 'San Francisco, CA', flag: 'US', ping: 31, load: 58, premium: true },\n  { id: '11', name: 'US - Washington DC', country: 'United States', city: 'Washington, DC', flag: 'US', ping: 14, load: 47, premium: true },\n  { id: '12', name: 'US - Houston', country: 'United States', city: 'Houston, TX', flag: 'US', ping: 24, load: 33, premium: false },\n  { id: '13', name: 'Canada - Toronto', country: 'Canada', city: 'Toronto', flag: 'CA', ping: 18, load: 37, premium: false },\n  { id: '14', name: 'Canada - Vancouver', country: 'Canada', city: 'Vancouver', flag: 'CA', ping: 35, load: 28, premium: false },\n  { id: '15', name: 'Canada - Montreal', country: 'Canada', city: 'Montreal', flag: 'CA', ping: 20, load: 31, premium: false },\n  { id: '16', name: 'UK - London', country: 'United Kingdom', city: 'London', flag: 'GB', ping: 45, load: 41, premium: false },\n  { id: '17', name: 'UK - Manchester', country: 'United Kingdom', city: 'Manchester', flag: 'GB', ping: 48, load: 32, premium: false },\n  { id: '18', name: 'Germany - Frankfurt', country: 'Germany', city: 'Frankfurt', flag: 'DE', ping: 52, load: 28, premium: false },\n  { id: '19', name: 'Germany - Berlin', country: 'Germany', city: 'Berlin', flag: 'DE', ping: 55, load: 35, premium: false },\n  { id: '20', name: 'France - Paris', country: 'France', city: 'Paris', flag: 'FR', ping: 42, load: 31, premium: false },\n  { id: '21', name: 'France - Marseille', country: 'France', city: 'Marseille', flag: 'FR', ping: 46, load: 19, premium: false },\n  { id: '22', name: 'Netherlands - Amsterdam', country: 'Netherlands', city: 'Amsterdam', flag: 'NL', ping: 48, load: 55, premium: true },\n  { id: '23', name: 'Switzerland - Zurich', country: 'Switzerland', city: 'Zurich', flag: 'CH', ping: 56, load: 18, premium: true },\n  { id: '24', name: 'Sweden - Stockholm', country: 'Sweden', city: 'Stockholm', flag: 'SE', ping: 61, load: 15, premium: true },\n  { id: '25', name: 'Norway - Oslo', country: 'Norway', city: 'Oslo', flag: 'NO', ping: 63, load: 12, premium: true },\n  { id: '26', name: 'Denmark - Copenhagen', country: 'Denmark', city: 'Copenhagen', flag: 'DK', ping: 58, load: 20, premium: false },\n  { id: '27', name: 'Spain - Madrid', country: 'Spain', city: 'Madrid', flag: 'ES', ping: 50, load: 36, premium: false },\n  { id: '28', name: 'Italy - Milan', country: 'Italy', city: 'Milan', flag: 'IT', ping: 54, load: 42, premium: false },\n  { id: '29', name: 'Austria - Vienna', country: 'Austria', city: 'Vienna', flag: 'AT', ping: 57, load: 24, premium: false },\n  { id: '30', name: 'Poland - Warsaw', country: 'Poland', city: 'Warsaw', flag: 'PL', ping: 60, load: 30, premium: false },\n  { id: '31', name: 'Ireland - Dublin', country: 'Ireland', city: 'Dublin', flag: 'IE', ping: 44, load: 26, premium: false },\n  { id: '32', name: 'Japan - Tokyo', country: 'Japan', city: 'Tokyo', flag: 'JP', ping: 89, load: 63, premium: true },\n  { id: '33', name: 'Japan - Osaka', country: 'Japan', city: 'Osaka', flag: 'JP', ping: 92, load: 48, premium: true },\n  { id: '34', name: 'Singapore', country: 'Singapore', city: 'Singapore', flag: 'SG', ping: 78, load: 45, premium: true },\n  { id: '35', name: 'South Korea - Seoul', country: 'South Korea', city: 'Seoul', flag: 'KR', ping: 95, load: 71, premium: true },\n  { id: '36', name: 'Hong Kong', country: 'Hong Kong', city: 'Hong Kong', flag: 'HK', ping: 82, load: 54, premium: true },\n  { id: '37', name: 'Taiwan - Taipei', country: 'Taiwan', city: 'Taipei', flag: 'TW', ping: 86, load: 39, premium: true },\n  { id: '38', name: 'Australia - Sydney', country: 'Australia', city: 'Sydney', flag: 'AU', ping: 112, load: 22, premium: false },\n  { id: '39', name: 'Australia - Melbourne', country: 'Australia', city: 'Melbourne', flag: 'AU', ping: 118, load: 28, premium: false },\n  { id: '40', name: 'New Zealand - Auckland', country: 'New Zealand', city: 'Auckland', flag: 'NZ', ping: 125, load: 14, premium: false },\n  { id: '41', name: 'Brazil - Sao Paulo', country: 'Brazil', city: 'Sao Paulo', flag: 'BR', ping: 134, load: 42, premium: false },\n  { id: '42', name: 'Mexico - Mexico City', country: 'Mexico', city: 'Mexico City', flag: 'MX', ping: 38, load: 35, premium: false },\n  { id: '43', name: 'Argentina - Buenos Aires', country: 'Argentina', city: 'Buenos Aires', flag: 'AR', ping: 142, load: 20, premium: false },\n  { id: '44', name: 'India - Mumbai', country: 'India', city: 'Mumbai', flag: 'IN', ping: 108, load: 67, premium: false },\n  { id: '45', name: 'India - Chennai', country: 'India', city: 'Chennai', flag: 'IN', ping: 115, load: 52, premium: false },\n  { id: '46', name: 'UAE - Dubai', country: 'UAE', city: 'Dubai', flag: 'AE', ping: 98, load: 40, premium: true },\n  { id: '47', name: 'Israel - Tel Aviv', country: 'Israel', city: 'Tel Aviv', flag: 'IL', ping: 72, load: 33, premium: true },\n  { id: '48', name: 'South Africa - Johannesburg', country: 'South Africa', city: 'Johannesburg', flag: 'ZA', ping: 155, load: 18, premium: false },\n  { id: '49', name: 'Romania - Bucharest', country: 'Romania', city: 'Bucharest', flag: 'RO', ping: 62, load: 16, premium: false },\n  { id: '50', name: 'Czech Republic - Prague', country: 'Czech Republic', city: 'Prague', flag: 'CZ', ping: 53, load: 21, premium: false },\n];\n\nfunction generateVirtualIp(): string {\n  const c = Math.floor(Math.random() * 254) + 1;\n  const d = Math.floor(Math.random() * 254) + 1;\n  return `185.203.${c}.${d}`;\n}\n\nconst CONNECTION_TIMEOUT_MS = 10000;\nconst PROTECTING_DURATION_MS = 2500;\n\nconst US_RESIDENTIAL_ISPS = [\n  'Comcast Cable', 'AT&T Internet', 'Spectrum Residential', 'Verizon Fios',\n  'Cox Communications', 'CenturyLink', 'Frontier Communications', 'Mediacom',\n  'Windstream', 'Charter Spectrum', 'Optimum Residential', 'Xfinity',\n];\n\nfunction simulateIpCheck(): { trusted: boolean; isp: string; ipAddress: string } {\n  const isp = US_RESIDENTIAL_ISPS[Math.floor(Math.random() * US_RESIDENTIAL_ISPS.length)];\n  const a = Math.floor(Math.random() * 200) + 10;\n  const b = Math.floor(Math.random() * 254) + 1;\n  const c = Math.floor(Math.random() * 254) + 1;\n  const d = Math.floor(Math.random() * 254) + 1;\n  return { trusted: true, isp, ipAddress: `${a}.${b}.${c}.${d}` };\n}\n\nexport function VpnProvider({ children }: { children: ReactNode }) {\n  const [connectionState, setConnectionState] = useState<ConnectionState>('disconnected');\n  const [connectionError, setConnectionError] = useState<ConnectionError>(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [isProtecting, setIsProtecting] = useState(false);\n  const [selectedServer, setSelectedServer] = useState<VpnServer | null>(SERVERS[0]);\n  const [favoriteServerIds, setFavoriteServerIds] = useState<string[]>([]);\n  const [protocol, setProtocol] = useState('WireGuard');\n  const [killSwitch, setKillSwitch] = useState(true);\n  const [autoConnect, setAutoConnect] = useState(false);\n  const [doubleVpn, setDoubleVpn] = useState(false);\n  const [doubleVpnServer, setDoubleVpnServer] = useState<VpnServer | null>(SERVERS[3]);\n  const [virtualIp, setVirtualIp] = useState('---');\n  const [isPremium, setIsPremium] = useState(false);\n  const [subscriptionType, setSubscriptionType] = useState<string | null>(null);\n  const [subscriptionExpiresAt, setSubscriptionExpiresAt] = useState<string | null>(null);\n  const [biometricLock, setBiometricLockState] = useState(false);\n  const [dnsLeakProtection, setDnsLeakProtectionState] = useState(true);\n  const [adBlocker, setAdBlockerState] = useState(true);\n  const connectionTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const protectingTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const cancelledRef = useRef(false);\n  const [stats, setStats] = useState<ConnectionStats>({\n    downloadSpeed: 0,\n    uploadSpeed: 0,\n    dataUsed: 0,\n    sessionDuration: 0,\n    ping: 0,\n  });\n\n  useEffect(() => {\n    AsyncStorage.getItem('xvpn_favorites').then(data => {\n      if (data) setFavoriteServerIds(JSON.parse(data));\n    });\n    AsyncStorage.getItem('xvpn_server').then(data => {\n      if (data) {\n        const s = SERVERS.find(srv => srv.id === data);\n        if (s) setSelectedServer(s);\n      }\n    });\n    AsyncStorage.getItem('xvpn_settings').then(data => {\n      if (data) {\n        const settings = JSON.parse(data);\n        if (settings.protocol) setProtocol(settings.protocol);\n        if (settings.killSwitch !== undefined) setKillSwitch(settings.killSwitch);\n        if (settings.autoConnect !== undefined) setAutoConnect(settings.autoConnect);\n        if (settings.doubleVpn !== undefined) setDoubleVpn(settings.doubleVpn);\n        if (settings.doubleVpnServerId) {\n          const dvs = SERVERS.find(srv => srv.id === settings.doubleVpnServerId);\n          if (dvs) setDoubleVpnServer(dvs);\n        }\n        if (settings.dnsLeakProtection !== undefined) setDnsLeakProtectionState(settings.dnsLeakProtection);\n        if (settings.adBlocker !== undefined) setAdBlockerState(settings.adBlocker);\n        if (settings.biometricLock !== undefined) setBiometricLockState(settings.biometricLock);\n      }\n    });\n    AsyncStorage.getItem('xvpn_premium').then(data => {\n      if (data) {\n        const premium = JSON.parse(data);\n        if (premium.isPremium) setIsPremium(true);\n        if (premium.subscriptionType) setSubscriptionType(premium.subscriptionType);\n        if (premium.subscriptionExpiresAt) setSubscriptionExpiresAt(premium.subscriptionExpiresAt);\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    let interval: ReturnType<typeof setInterval>;\n    if (isConnected) {\n      let baseDown = 45 + Math.random() * 30;\n      let baseUp = 15 + Math.random() * 15;\n      let driftDirection = 1;\n      let tickCounter = 0;\n\n      interval = setInterval(() => {\n        tickCounter++;\n\n        if (tickCounter % 7 === 0) {\n          driftDirection = Math.random() > 0.5 ? 1 : -1;\n          baseDown = Math.max(20, Math.min(120, baseDown + driftDirection * (Math.random() * 8)));\n          baseUp = Math.max(5, Math.min(50, baseUp + driftDirection * (Math.random() * 4)));\n        }\n\n        const jitterDown = (Math.random() - 0.5) * 12;\n        const jitterUp = (Math.random() - 0.5) * 6;\n\n        const microPause = Math.random() > 0.95 ? -baseDown * 0.3 : 0;\n\n        const burstFactor = Math.random() > 0.92 ? 1.4 + Math.random() * 0.3 : 1;\n\n        const dataJitter = 0.015 + Math.random() * 0.06 + (Math.random() > 0.9 ? Math.random() * 0.08 : 0);\n\n        const intervalJitter = Math.random() > 0.85 ? Math.floor(Math.random() * 2) : 0;\n\n        setStats(prev => ({\n          downloadSpeed: Math.max(0, (baseDown + jitterDown + microPause) * burstFactor),\n          uploadSpeed: Math.max(0, (baseUp + jitterUp) * burstFactor),\n          dataUsed: prev.dataUsed + dataJitter,\n          sessionDuration: prev.sessionDuration + 1 + intervalJitter,\n          ping: Math.max(1, (selectedServer?.ping || 20) + Math.floor(Math.random() * 12) - 6 + (Math.random() > 0.9 ? Math.floor(Math.random() * 15) : 0)),\n        }));\n      }, 1000);\n    }\n    return () => clearInterval(interval);\n  }, [isConnected, selectedServer]);\n\n  useEffect(() => {\n    if (!isConnected || !killSwitch) return;\n    const heartbeat = setInterval(() => {\n      const heartbeatLost = Math.random() < 0.003;\n      if (heartbeatLost) {\n        console.warn('[KillSwitch] Heartbeat lost  terminating connection');\n        setConnectionState('disconnected');\n        setIsConnected(false);\n        setIsConnecting(false);\n        setVirtualIp('---');\n        setStats({ downloadSpeed: 0, uploadSpeed: 0, dataUsed: 0, sessionDuration: 0, ping: 0 });\n      }\n    }, 5000);\n    return () => clearInterval(heartbeat);\n  }, [isConnected, killSwitch]);\n\n  const clearTimers = useCallback(() => {\n    if (connectionTimeoutRef.current) {\n      clearTimeout(connectionTimeoutRef.current);\n      connectionTimeoutRef.current = null;\n    }\n    if (protectingTimeoutRef.current) {\n      clearTimeout(protectingTimeoutRef.current);\n      protectingTimeoutRef.current = null;\n    }\n  }, []);\n\n  const resetToDisconnected = useCallback(() => {\n    clearTimers();\n    setConnectionState('disconnected');\n    setIsConnected(false);\n    setIsConnecting(false);\n    setIsProtecting(false);\n    setVirtualIp('---');\n    setStats({ downloadSpeed: 0, uploadSpeed: 0, dataUsed: 0, sessionDuration: 0, ping: 0 });\n  }, [clearTimers]);\n\n  const connect = useCallback(() => {\n    cancelledRef.current = false;\n    setConnectionError(null);\n    setConnectionState('connecting');\n    setIsConnecting(true);\n    setIsProtecting(false);\n    setStats({ downloadSpeed: 0, uploadSpeed: 0, dataUsed: 0, sessionDuration: 0, ping: 0 });\n\n    connectionTimeoutRef.current = setTimeout(() => {\n      if (cancelledRef.current) return;\n      setConnectionError({\n        type: 'identity_check_failed',\n        message: 'Identity Check Failed  SOCKS5 proxy (64.84.118.42) did not respond within 10s',\n      });\n      resetToDisconnected();\n    }, CONNECTION_TIMEOUT_MS);\n  }, [resetToDisconnected]);\n\n  const cancelConnection = useCallback(() => {\n    cancelledRef.current = true;\n    clearTimers();\n    resetToDisconnected();\n  }, [clearTimers, resetToDisconnected]);\n\n  const completeConnection = useCallback(() => {\n    if (cancelledRef.current) return;\n    clearTimers();\n    setIsConnecting(false);\n    setIsProtecting(true);\n    setConnectionState('protecting');\n\n    protectingTimeoutRef.current = setTimeout(() => {\n      if (cancelledRef.current) return;\n      const ipCheck = simulateIpCheck();\n      if (ipCheck.trusted) {\n        setIsProtecting(false);\n        setIsConnected(true);\n        setConnectionState('connected');\n        setVirtualIp(generateVirtualIp());\n      } else {\n        setConnectionState('protecting');\n      }\n    }, PROTECTING_DURATION_MS);\n  }, [clearTimers]);\n\n  const disconnect = useCallback(() => {\n    cancelledRef.current = true;\n    resetToDisconnected();\n  }, [resetToDisconnected]);\n\n  const clearError = useCallback(() => {\n    setConnectionError(null);\n  }, []);\n\n  const selectServer = useCallback((server: VpnServer) => {\n    setSelectedServer(server);\n    AsyncStorage.setItem('xvpn_server', server.id);\n  }, []);\n\n  const toggleFavorite = useCallback((serverId: string) => {\n    setFavoriteServerIds(prev => {\n      const next = prev.includes(serverId)\n        ? prev.filter(id => id !== serverId)\n        : [...prev, serverId];\n      AsyncStorage.setItem('xvpn_favorites', JSON.stringify(next));\n      return next;\n    });\n  }, []);\n\n  const saveSetting = useCallback((key: string, val: unknown) => {\n    AsyncStorage.getItem('xvpn_settings').then(data => {\n      const settings = data ? JSON.parse(data) : {};\n      settings[key] = val;\n      AsyncStorage.setItem('xvpn_settings', JSON.stringify(settings));\n    });\n  }, []);\n\n  const handleSetProtocol = useCallback((p: string) => {\n    setProtocol(p);\n    saveSetting('protocol', p);\n  }, [saveSetting]);\n\n  const handleSetKillSwitch = useCallback((v: boolean) => {\n    setKillSwitch(v);\n    saveSetting('killSwitch', v);\n  }, [saveSetting]);\n\n  const handleSetAutoConnect = useCallback((v: boolean) => {\n    setAutoConnect(v);\n    saveSetting('autoConnect', v);\n  }, [saveSetting]);\n\n  const handleSetDoubleVpn = useCallback((v: boolean) => {\n    setDoubleVpn(v);\n    saveSetting('doubleVpn', v);\n  }, [saveSetting]);\n\n  const handleSetDoubleVpnServer = useCallback((s: VpnServer | null) => {\n    setDoubleVpnServer(s);\n    saveSetting('doubleVpnServerId', s?.id || null);\n  }, [saveSetting]);\n\n  const handleSetPremium = useCallback((v: boolean) => {\n    setIsPremium(v);\n    AsyncStorage.getItem('xvpn_premium').then(data => {\n      const premium = data ? JSON.parse(data) : {};\n      premium.isPremium = v;\n      AsyncStorage.setItem('xvpn_premium', JSON.stringify(premium));\n    });\n  }, []);\n\n  const handleSetSubscription = useCallback((type: string, expiresAt: string) => {\n    setIsPremium(true);\n    setSubscriptionType(type);\n    setSubscriptionExpiresAt(expiresAt);\n    AsyncStorage.setItem('xvpn_premium', JSON.stringify({\n      isPremium: true,\n      subscriptionType: type,\n      subscriptionExpiresAt: expiresAt,\n    }));\n  }, []);\n\n  const handleSetBiometricLock = useCallback((v: boolean) => {\n    setBiometricLockState(v);\n    saveSetting('biometricLock', v);\n  }, [saveSetting]);\n\n  const handleSetDnsLeakProtection = useCallback((v: boolean) => {\n    setDnsLeakProtectionState(v);\n    saveSetting('dnsLeakProtection', v);\n  }, [saveSetting]);\n\n  const handleSetAdBlocker = useCallback((v: boolean) => {\n    setAdBlockerState(v);\n    saveSetting('adBlocker', v);\n  }, [saveSetting]);\n\n  const value = useMemo(() => ({\n    connectionState,\n    connectionError,\n    isConnected,\n    isConnecting,\n    isProtecting,\n    selectedServer,\n    servers: SERVERS,\n    stats,\n    favoriteServerIds,\n    connect,\n    cancelConnection,\n    disconnect,\n    selectServer,\n    toggleFavorite,\n    clearError,\n    protocol,\n    setProtocol: handleSetProtocol,\n    killSwitch,\n    setKillSwitch: handleSetKillSwitch,\n    autoConnect,\n    setAutoConnect: handleSetAutoConnect,\n    doubleVpn,\n    setDoubleVpn: handleSetDoubleVpn,\n    doubleVpnServer,\n    setDoubleVpnServer: handleSetDoubleVpnServer,\n    virtualIp,\n    completeConnection,\n    isPremium,\n    setPremium: handleSetPremium,\n    subscriptionType,\n    subscriptionExpiresAt,\n    setSubscription: handleSetSubscription,\n    biometricLock,\n    setBiometricLock: handleSetBiometricLock,\n    dnsLeakProtection,\n    setDnsLeakProtection: handleSetDnsLeakProtection,\n    adBlocker,\n    setAdBlocker: handleSetAdBlocker,\n  }), [connectionState, connectionError, isConnected, isConnecting, isProtecting, selectedServer, stats, favoriteServerIds, connect, cancelConnection, completeConnection, disconnect, selectServer, toggleFavorite, clearError, protocol, handleSetProtocol, killSwitch, handleSetKillSwitch, autoConnect, handleSetAutoConnect, doubleVpn, handleSetDoubleVpn, doubleVpnServer, handleSetDoubleVpnServer, virtualIp, isPremium, handleSetPremium, subscriptionType, subscriptionExpiresAt, handleSetSubscription, biometricLock, handleSetBiometricLock, dnsLeakProtection, handleSetDnsLeakProtection, adBlocker, handleSetAdBlocker]);\n\n  return <VpnContext.Provider value={value}>{children}</VpnContext.Provider>;\n}\n\nexport function useVpn() {\n  const ctx = useContext(VpnContext);\n  if (!ctx) throw new Error('useVpn must be used within VpnProvider');\n  return ctx;\n}\n","path":null,"size_bytes":21833,"size_tokens":null},"components/components/NoiseBackground.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, StyleSheet, Dimensions, Platform } from 'react-native';\nimport Animated, { useSharedValue, useAnimatedStyle, withRepeat, withTiming, Easing } from 'react-native-reanimated';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport Colors from '@/constants/colors';\n\nconst { width, height } = Dimensions.get('window');\n\nexport function NoiseBackground({ children }: { children: React.ReactNode }) {\n  const orbY1 = useSharedValue(0);\n  const orbY2 = useSharedValue(0);\n  const orbX1 = useSharedValue(0);\n\n  useEffect(() => {\n    orbY1.value = withRepeat(withTiming(-30, { duration: 8000, easing: Easing.inOut(Easing.ease) }), -1, true);\n    orbY2.value = withRepeat(withTiming(25, { duration: 6000, easing: Easing.inOut(Easing.ease) }), -1, true);\n    orbX1.value = withRepeat(withTiming(20, { duration: 10000, easing: Easing.inOut(Easing.ease) }), -1, true);\n  }, []);\n\n  const orb1Style = useAnimatedStyle(() => ({\n    transform: [{ translateY: orbY1.value }, { translateX: orbX1.value }],\n  }));\n\n  const orb2Style = useAnimatedStyle(() => ({\n    transform: [{ translateY: orbY2.value }],\n  }));\n\n  return (\n    <View style={styles.container}>\n      <LinearGradient\n        colors={['#0F0F0F', '#0D0D1A', '#0F0F0F']}\n        start={{ x: 0, y: 0 }}\n        end={{ x: 1, y: 1 }}\n        style={StyleSheet.absoluteFill}\n      />\n      <Animated.View style={[styles.orb1, orb1Style]} />\n      <Animated.View style={[styles.orb2, orb2Style]} />\n      <View style={styles.noiseOverlay} />\n      {children}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#0F0F0F',\n  },\n  orb1: {\n    position: 'absolute',\n    top: '15%',\n    left: '-20%',\n    width: width * 0.8,\n    height: width * 0.8,\n    borderRadius: width * 0.4,\n    backgroundColor: 'rgba(0, 240, 255, 0.04)',\n  },\n  orb2: {\n    position: 'absolute',\n    bottom: '20%',\n    right: '-25%',\n    width: width * 0.7,\n    height: width * 0.7,\n    borderRadius: width * 0.35,\n    backgroundColor: 'rgba(195, 0, 255, 0.04)',\n  },\n  noiseOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(255,255,255,0.008)',\n  },\n});\n","path":null,"size_bytes":2208,"size_tokens":null},"lib/lib/fingerprint-runtime.ts":{"content":"import { Platform } from 'react-native';\n\nlet originalRTCPeerConnection: typeof RTCPeerConnection | null = null;\nlet originalDateTimeFormat: typeof Intl.DateTimeFormat | null = null;\nlet originalGetTimezoneOffset: (() => number) | null = null;\nlet originalToDataURL: ((type?: string, quality?: any) => string) | null = null;\nlet originalGetImageData: ((sx: number, sy: number, sw: number, sh: number) => ImageData) | null = null;\n\nlet webrtcActive = false;\nlet timezoneActive = false;\nlet canvasActive = false;\n\nexport function applyWebRTCMask(enabled: boolean): void {\n  if (Platform.OS !== 'web') return;\n  if (typeof window === 'undefined') return;\n\n  if (enabled && !webrtcActive) {\n    const g = window as any;\n    originalRTCPeerConnection = g.RTCPeerConnection || g.webkitRTCPeerConnection;\n\n    if (originalRTCPeerConnection) {\n      g.RTCPeerConnection = function () {\n        return {\n          createOffer: () => Promise.resolve({ type: 'offer', sdp: '' }),\n          createAnswer: () => Promise.resolve({ type: 'answer', sdp: '' }),\n          setLocalDescription: () => Promise.resolve(),\n          setRemoteDescription: () => Promise.resolve(),\n          addIceCandidate: () => Promise.resolve(),\n          close: () => {},\n          addEventListener: () => {},\n          removeEventListener: () => {},\n          getStats: () => Promise.resolve(new Map()),\n          getSenders: () => [],\n          getReceivers: () => [],\n          onicecandidate: null,\n          ontrack: null,\n          ondatachannel: null,\n          onconnectionstatechange: null,\n          localDescription: null,\n          remoteDescription: null,\n          connectionState: 'closed',\n          iceConnectionState: 'closed',\n          iceGatheringState: 'complete',\n          signalingState: 'closed',\n        };\n      } as any;\n    }\n\n    if (g.webkitRTCPeerConnection) {\n      g.webkitRTCPeerConnection = g.RTCPeerConnection;\n    }\n\n    webrtcActive = true;\n  } else if (!enabled && webrtcActive) {\n    if (originalRTCPeerConnection) {\n      const g = window as any;\n      g.RTCPeerConnection = originalRTCPeerConnection;\n      if (g.webkitRTCPeerConnection) {\n        g.webkitRTCPeerConnection = originalRTCPeerConnection;\n      }\n      originalRTCPeerConnection = null;\n    }\n    webrtcActive = false;\n  }\n}\n\nexport function applyTimezoneSpoofing(enabled: boolean, timezone: string | null, offsetHours: number): void {\n  if (Platform.OS !== 'web') return;\n  if (typeof window === 'undefined') return;\n\n  if (enabled && timezone) {\n    if (!originalDateTimeFormat) {\n      originalDateTimeFormat = Intl.DateTimeFormat;\n    }\n    if (!originalGetTimezoneOffset) {\n      originalGetTimezoneOffset = Date.prototype.getTimezoneOffset;\n    }\n\n    const spoofedTimezone = timezone;\n    const spoofedOffset = -(offsetHours * 60);\n\n    const OrigDTF = originalDateTimeFormat;\n    (Intl as any).DateTimeFormat = function (...args: any[]) {\n      if (args.length >= 2 && args[1]) {\n        args[1] = { ...args[1], timeZone: args[1].timeZone || spoofedTimezone };\n      } else if (args.length < 2) {\n        args[1] = { timeZone: spoofedTimezone };\n      }\n      return new OrigDTF(...args);\n    };\n    (Intl as any).DateTimeFormat.prototype = OrigDTF.prototype;\n    (Intl as any).DateTimeFormat.supportedLocalesOf = OrigDTF.supportedLocalesOf;\n\n    Date.prototype.getTimezoneOffset = function () {\n      return spoofedOffset;\n    };\n\n    timezoneActive = true;\n  } else if (!enabled && timezoneActive) {\n    if (originalDateTimeFormat) {\n      (Intl as any).DateTimeFormat = originalDateTimeFormat;\n      originalDateTimeFormat = null;\n    }\n    if (originalGetTimezoneOffset) {\n      Date.prototype.getTimezoneOffset = originalGetTimezoneOffset;\n      originalGetTimezoneOffset = null;\n    }\n    timezoneActive = false;\n  }\n}\n\nexport function applyCanvasNoise(enabled: boolean, noiseLevel: number = 0.02): void {\n  if (Platform.OS !== 'web') return;\n  if (typeof window === 'undefined') return;\n  if (typeof HTMLCanvasElement === 'undefined') return;\n\n  if (enabled && !canvasActive) {\n    const canvasProto = HTMLCanvasElement.prototype;\n    originalToDataURL = canvasProto.toDataURL;\n\n    canvasProto.toDataURL = function (type?: string, quality?: any): string {\n      try {\n        const ctx = this.getContext('2d');\n        if (ctx) {\n          const w = Math.min(this.width, 4);\n          const h = Math.min(this.height, 4);\n          const imageData = CanvasRenderingContext2D.prototype.getImageData.call(ctx, 0, 0, w, h);\n          for (let i = 0; i < imageData.data.length; i += 4) {\n            imageData.data[i] = Math.max(0, Math.min(255, imageData.data[i] + (Math.random() - 0.5) * noiseLevel * 255));\n            imageData.data[i + 1] = Math.max(0, Math.min(255, imageData.data[i + 1] + (Math.random() - 0.5) * noiseLevel * 255));\n            imageData.data[i + 2] = Math.max(0, Math.min(255, imageData.data[i + 2] + (Math.random() - 0.5) * noiseLevel * 255));\n          }\n          ctx.putImageData(imageData, 0, 0);\n        }\n      } catch (_) {}\n      return originalToDataURL!.call(this, type, quality);\n    };\n\n    const ctx2dProto = CanvasRenderingContext2D.prototype;\n    originalGetImageData = ctx2dProto.getImageData;\n\n    ctx2dProto.getImageData = function (sx: number, sy: number, sw: number, sh: number): ImageData {\n      const data = originalGetImageData!.call(this, sx, sy, sw, sh);\n      for (let i = 0; i < data.data.length; i += 4) {\n        data.data[i] = Math.max(0, Math.min(255, data.data[i] + (Math.random() - 0.5) * noiseLevel * 255));\n        data.data[i + 1] = Math.max(0, Math.min(255, data.data[i + 1] + (Math.random() - 0.5) * noiseLevel * 255));\n        data.data[i + 2] = Math.max(0, Math.min(255, data.data[i + 2] + (Math.random() - 0.5) * noiseLevel * 255));\n      }\n      return data;\n    };\n\n    canvasActive = true;\n  } else if (!enabled && canvasActive) {\n    if (originalToDataURL) {\n      HTMLCanvasElement.prototype.toDataURL = originalToDataURL;\n      originalToDataURL = null;\n    }\n    if (originalGetImageData) {\n      CanvasRenderingContext2D.prototype.getImageData = originalGetImageData;\n      originalGetImageData = null;\n    }\n    canvasActive = false;\n  }\n}\n\nexport function getAppliedProtections(): { webrtc: boolean; timezone: boolean; canvas: boolean } {\n  return {\n    webrtc: webrtcActive,\n    timezone: timezoneActive,\n    canvas: canvasActive,\n  };\n}\n","path":null,"size_bytes":6401,"size_tokens":null},"backend/main.py":{"content":"import time\nimport random\nimport uuid\nimport asyncio\nimport json\nimport threading\nfrom datetime import datetime, timezone\nfrom fastapi import FastAPI, HTTPException, Depends\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom pydantic import BaseModel\nfrom typing import Optional\nfrom sqlalchemy.orm import Session\n\nfrom backend.database import get_db, init_db\nfrom backend.models import User, ServerLog\nfrom backend.auth import (\n    hash_password,\n    verify_password,\n    create_access_token,\n    create_refresh_token,\n    decode_token,\n    get_current_user,\n    get_optional_user,\n)\nfrom backend.no_logs import (\n    create_minimal_log,\n    purge_expired_logs,\n    auto_purge_loop,\n    get_no_logs_policy,\n)\nimport os\n\napp = FastAPI(title=\"xVPN Backend Engine\", version=\"1.0.0\")\n\nRESIDENTIAL_PROXY_URL = os.environ.get(\"RESIDENTIAL_PROXY_URL\", \"socks5://user:pass@p.shifter.io:2742\")\n\nPROXY_CHAIN_CONFIG = {\n    \"proxy_url\": RESIDENTIAL_PROXY_URL,\n    \"redsocks_port\": 12345,\n    \"routing_mode\": \"iptables_redirect\",\n    \"iptables_rules\": [\n        \"iptables -t nat -N REDSOCKS\",\n        \"iptables -t nat -A REDSOCKS -d 0.0.0.0/8 -j RETURN\",\n        \"iptables -t nat -A REDSOCKS -d 10.0.0.0/8 -j RETURN\",\n        \"iptables -t nat -A REDSOCKS -d 127.0.0.0/8 -j RETURN\",\n        \"iptables -t nat -A REDSOCKS -d 172.16.0.0/12 -j RETURN\",\n        \"iptables -t nat -A REDSOCKS -d 192.168.0.0/16 -j RETURN\",\n        f\"iptables -t nat -A REDSOCKS -p tcp -j REDIRECT --to-ports 12345\",\n        \"iptables -t nat -A OUTPUT -p tcp -o wg0 -j REDSOCKS\",\n    ],\n    \"redsocks_config\": {\n        \"local_ip\": \"127.0.0.1\",\n        \"local_port\": 12345,\n        \"ip\": RESIDENTIAL_PROXY_URL.split(\"@\")[-1].split(\":\")[0] if \"@\" in RESIDENTIAL_PROXY_URL else \"p.shifter.io\",\n        \"port\": int(RESIDENTIAL_PROXY_URL.split(\":\")[-1]) if RESIDENTIAL_PROXY_URL.split(\":\")[-1].isdigit() else 2742,\n        \"type\": \"socks5\",\n        \"login\": RESIDENTIAL_PROXY_URL.split(\"//\")[-1].split(\":\")[0] if \"//\" in RESIDENTIAL_PROXY_URL else \"user\",\n    },\n}\n\nheartbeat_monitor_task = None\npurge_task = None\n\n\n@app.on_event(\"startup\")\nasync def on_startup():\n    global heartbeat_monitor_task, purge_task\n\n    init_db()\n\n    async def monitor_loop():\n        while True:\n            try:\n                await asyncio.sleep(KILL_SWITCH_HEARTBEAT_INTERVAL)\n                kill_switch_check_all()\n            except asyncio.CancelledError:\n                break\n            except Exception:\n                pass\n\n    heartbeat_monitor_task = asyncio.create_task(monitor_loop())\n    purge_task = asyncio.create_task(auto_purge_loop())\n\n\n@app.on_event(\"shutdown\")\nasync def on_shutdown():\n    global heartbeat_monitor_task, purge_task\n    for task in [heartbeat_monitor_task, purge_task]:\n        if task:\n            task.cancel()\n            try:\n                await task\n            except asyncio.CancelledError:\n                pass\n\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\nclass RegisterRequest(BaseModel):\n    username: str\n    email: str\n    password: str\n    display_name: Optional[str] = None\n\n\nclass LoginRequest(BaseModel):\n    username: str\n    password: str\n\n\nclass RefreshTokenRequest(BaseModel):\n    refresh_token: str\n\n\nclass UpdateProfileRequest(BaseModel):\n    display_name: Optional[str] = None\n    preferred_protocol: Optional[str] = None\n    kill_switch_default: Optional[bool] = None\n    auto_connect: Optional[bool] = None\n    fingerprint_shield_default: Optional[bool] = None\n    favorite_servers: Optional[list[str]] = None\n\n\n@app.post(\"/api/auth/register\")\nasync def register(req: RegisterRequest, db: Session = Depends(get_db)):\n    if len(req.username) < 3:\n        raise HTTPException(status_code=400, detail=\"Username must be at least 3 characters\")\n    if len(req.password) < 8:\n        raise HTTPException(status_code=400, detail=\"Password must be at least 8 characters\")\n    if \"@\" not in req.email:\n        raise HTTPException(status_code=400, detail=\"Invalid email address\")\n\n    existing = db.query(User).filter(\n        (User.username == req.username) | (User.email == req.email)\n    ).first()\n    if existing:\n        if existing.username == req.username:\n            raise HTTPException(status_code=409, detail=\"Username already taken\")\n        raise HTTPException(status_code=409, detail=\"Email already registered\")\n\n    user = User(\n        username=req.username,\n        email=req.email,\n        password_hash=hash_password(req.password),\n        display_name=req.display_name or req.username,\n    )\n    db.add(user)\n    db.commit()\n    db.refresh(user)\n\n    access_token = create_access_token(user.id, user.username)\n    refresh_token = create_refresh_token(user.id)\n\n    return {\n        \"status\": \"registered\",\n        \"user\": {\n            \"id\": user.id,\n            \"username\": user.username,\n            \"email\": user.email,\n            \"display_name\": user.display_name,\n            \"subscription_tier\": user.subscription_tier,\n            \"created_at\": str(user.created_at),\n        },\n        \"tokens\": {\n            \"access_token\": access_token,\n            \"refresh_token\": refresh_token,\n            \"token_type\": \"bearer\",\n            \"expires_in\": 3600,\n        },\n    }\n\n\n@app.post(\"/api/auth/login\")\nasync def login(req: LoginRequest, db: Session = Depends(get_db)):\n    user = db.query(User).filter(User.username == req.username).first()\n    if not user or not verify_password(req.password, user.password_hash):\n        raise HTTPException(status_code=401, detail=\"Invalid username or password\")\n\n    if user.is_active is not True:\n        raise HTTPException(status_code=403, detail=\"Account is deactivated\")\n\n    user.last_login = datetime.now(timezone.utc)\n    db.commit()\n\n    access_token = create_access_token(user.id, user.username)\n    refresh_token = create_refresh_token(user.id)\n\n    return {\n        \"status\": \"authenticated\",\n        \"user\": {\n            \"id\": user.id,\n            \"username\": user.username,\n            \"email\": user.email,\n            \"display_name\": user.display_name,\n            \"subscription_tier\": user.subscription_tier,\n            \"last_login\": str(user.last_login),\n        },\n        \"tokens\": {\n            \"access_token\": access_token,\n            \"refresh_token\": refresh_token,\n            \"token_type\": \"bearer\",\n            \"expires_in\": 3600,\n        },\n    }\n\n\n@app.post(\"/api/auth/refresh\")\nasync def refresh_token(req: RefreshTokenRequest, db: Session = Depends(get_db)):\n    payload = decode_token(req.refresh_token)\n    if payload.get(\"type\") != \"refresh\":\n        raise HTTPException(status_code=401, detail=\"Invalid token type\")\n\n    user = db.query(User).filter(User.id == payload[\"sub\"]).first()\n    if not user:\n        raise HTTPException(status_code=401, detail=\"User not found\")\n\n    new_access = create_access_token(user.id, user.username)\n    new_refresh = create_refresh_token(user.id)\n\n    return {\n        \"tokens\": {\n            \"access_token\": new_access,\n            \"refresh_token\": new_refresh,\n            \"token_type\": \"bearer\",\n            \"expires_in\": 3600,\n        },\n    }\n\n\n@app.get(\"/api/auth/profile\")\nasync def get_profile(current_user: User = Depends(get_current_user)):\n    return {\n        \"id\": current_user.id,\n        \"username\": current_user.username,\n        \"email\": current_user.email,\n        \"display_name\": current_user.display_name,\n        \"subscription_tier\": current_user.subscription_tier,\n        \"preferred_protocol\": current_user.preferred_protocol,\n        \"kill_switch_default\": current_user.kill_switch_default,\n        \"auto_connect\": current_user.auto_connect,\n        \"fingerprint_shield_default\": current_user.fingerprint_shield_default,\n        \"favorite_servers\": json.loads(current_user.favorite_servers or \"[]\"),\n        \"created_at\": str(current_user.created_at),\n        \"last_login\": str(current_user.last_login) if current_user.last_login else None,\n        \"total_data_transferred_bytes\": current_user.total_data_transferred_bytes,\n        \"total_sessions\": current_user.total_sessions,\n    }\n\n\n@app.put(\"/api/auth/profile\")\nasync def update_profile(\n    req: UpdateProfileRequest,\n    current_user: User = Depends(get_current_user),\n    db: Session = Depends(get_db),\n):\n    if req.display_name is not None:\n        current_user.display_name = req.display_name\n    if req.preferred_protocol is not None:\n        current_user.preferred_protocol = req.preferred_protocol\n    if req.kill_switch_default is not None:\n        current_user.kill_switch_default = req.kill_switch_default\n    if req.auto_connect is not None:\n        current_user.auto_connect = req.auto_connect\n    if req.fingerprint_shield_default is not None:\n        current_user.fingerprint_shield_default = req.fingerprint_shield_default\n    if req.favorite_servers is not None:\n        current_user.favorite_servers = json.dumps(req.favorite_servers)\n\n    current_user.updated_at = datetime.now(timezone.utc)\n    db.commit()\n    db.refresh(current_user)\n\n    return {\n        \"status\": \"updated\",\n        \"profile\": {\n            \"display_name\": current_user.display_name,\n            \"preferred_protocol\": current_user.preferred_protocol,\n            \"kill_switch_default\": current_user.kill_switch_default,\n            \"auto_connect\": current_user.auto_connect,\n            \"fingerprint_shield_default\": current_user.fingerprint_shield_default,\n            \"favorite_servers\": json.loads(current_user.favorite_servers or \"[]\"),\n        },\n    }\n\n\n@app.get(\"/api/no-logs-policy\")\nasync def no_logs_policy():\n    return get_no_logs_policy()\n\n\nSERVERS = [\n    {\n        \"id\": \"us-east-1\",\n        \"name\": \"US East\",\n        \"country\": \"United States\",\n        \"city\": \"New York\",\n        \"flag\": \"US\",\n        \"ip\": \"198.51.100.1\",\n        \"load\": round(random.uniform(15, 65), 1),\n        \"ping\": random.randint(8, 25),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 10000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"us-west-1\",\n        \"name\": \"US West\",\n        \"country\": \"United States\",\n        \"city\": \"Los Angeles\",\n        \"flag\": \"US\",\n        \"ip\": \"198.51.100.2\",\n        \"load\": round(random.uniform(20, 70), 1),\n        \"ping\": random.randint(15, 40),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 10000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"uk-london-1\",\n        \"name\": \"UK London\",\n        \"country\": \"United Kingdom\",\n        \"city\": \"London\",\n        \"flag\": \"GB\",\n        \"ip\": \"203.0.113.1\",\n        \"load\": round(random.uniform(25, 55), 1),\n        \"ping\": random.randint(35, 60),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 8000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"jp-tokyo-1\",\n        \"name\": \"Japan\",\n        \"country\": \"Japan\",\n        \"city\": \"Tokyo\",\n        \"flag\": \"JP\",\n        \"ip\": \"203.0.113.10\",\n        \"load\": round(random.uniform(30, 75), 1),\n        \"ping\": random.randint(70, 120),\n        \"premium\": True,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 6000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"de-frankfurt-1\",\n        \"name\": \"Germany\",\n        \"country\": \"Germany\",\n        \"city\": \"Frankfurt\",\n        \"flag\": \"DE\",\n        \"ip\": \"203.0.113.20\",\n        \"load\": round(random.uniform(15, 50), 1),\n        \"ping\": random.randint(40, 65),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 8000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"sg-singapore-1\",\n        \"name\": \"Singapore\",\n        \"country\": \"Singapore\",\n        \"city\": \"Singapore\",\n        \"flag\": \"SG\",\n        \"ip\": \"203.0.113.30\",\n        \"load\": round(random.uniform(20, 60), 1),\n        \"ping\": random.randint(60, 95),\n        \"premium\": True,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 6000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"au-sydney-1\",\n        \"name\": \"Australia\",\n        \"country\": \"Australia\",\n        \"city\": \"Sydney\",\n        \"flag\": \"AU\",\n        \"ip\": \"203.0.113.40\",\n        \"load\": round(random.uniform(10, 40), 1),\n        \"ping\": random.randint(90, 140),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 5000,\n        \"bandwidth\": \"5 Gbps\",\n    },\n    {\n        \"id\": \"ca-toronto-1\",\n        \"name\": \"Canada\",\n        \"country\": \"Canada\",\n        \"city\": \"Toronto\",\n        \"flag\": \"CA\",\n        \"ip\": \"203.0.113.50\",\n        \"load\": round(random.uniform(15, 45), 1),\n        \"ping\": random.randint(12, 30),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 8000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"nl-amsterdam-1\",\n        \"name\": \"Netherlands\",\n        \"country\": \"Netherlands\",\n        \"city\": \"Amsterdam\",\n        \"flag\": \"NL\",\n        \"ip\": \"203.0.113.60\",\n        \"load\": round(random.uniform(25, 65), 1),\n        \"ping\": random.randint(38, 60),\n        \"premium\": True,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 7000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"ch-zurich-1\",\n        \"name\": \"Switzerland\",\n        \"country\": \"Switzerland\",\n        \"city\": \"Zurich\",\n        \"flag\": \"CH\",\n        \"ip\": \"203.0.113.70\",\n        \"load\": round(random.uniform(10, 35), 1),\n        \"ping\": random.randint(45, 70),\n        \"premium\": True,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 5000,\n        \"bandwidth\": \"5 Gbps\",\n    },\n    {\n        \"id\": \"fr-paris-1\",\n        \"name\": \"France\",\n        \"country\": \"France\",\n        \"city\": \"Paris\",\n        \"flag\": \"FR\",\n        \"ip\": \"203.0.113.80\",\n        \"load\": round(random.uniform(20, 50), 1),\n        \"ping\": random.randint(35, 55),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 7000,\n        \"bandwidth\": \"10 Gbps\",\n    },\n    {\n        \"id\": \"kr-seoul-1\",\n        \"name\": \"South Korea\",\n        \"country\": \"South Korea\",\n        \"city\": \"Seoul\",\n        \"flag\": \"KR\",\n        \"ip\": \"203.0.113.90\",\n        \"load\": round(random.uniform(35, 80), 1),\n        \"ping\": random.randint(80, 120),\n        \"premium\": True,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 5000,\n        \"bandwidth\": \"5 Gbps\",\n    },\n    {\n        \"id\": \"br-saopaulo-1\",\n        \"name\": \"Brazil\",\n        \"country\": \"Brazil\",\n        \"city\": \"Sao Paulo\",\n        \"flag\": \"BR\",\n        \"ip\": \"203.0.113.100\",\n        \"load\": round(random.uniform(20, 55), 1),\n        \"ping\": random.randint(110, 160),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 5000,\n        \"bandwidth\": \"5 Gbps\",\n    },\n    {\n        \"id\": \"in-mumbai-1\",\n        \"name\": \"India\",\n        \"country\": \"India\",\n        \"city\": \"Mumbai\",\n        \"flag\": \"IN\",\n        \"ip\": \"203.0.113.110\",\n        \"load\": round(random.uniform(30, 75), 1),\n        \"ping\": random.randint(90, 130),\n        \"premium\": False,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 5000,\n        \"bandwidth\": \"5 Gbps\",\n    },\n    {\n        \"id\": \"se-stockholm-1\",\n        \"name\": \"Sweden\",\n        \"country\": \"Sweden\",\n        \"city\": \"Stockholm\",\n        \"flag\": \"SE\",\n        \"ip\": \"203.0.113.120\",\n        \"load\": round(random.uniform(8, 30), 1),\n        \"ping\": random.randint(50, 75),\n        \"premium\": True,\n        \"protocol\": \"WireGuard\",\n        \"capacity\": 5000,\n        \"bandwidth\": \"5 Gbps\",\n    },\n]\n\nactive_sessions: dict[str, dict] = {}\n\nKILL_SWITCH_HEARTBEAT_INTERVAL = 10\nKILL_SWITCH_TIMEOUT = 30\n\nkill_switch_registry: dict[str, dict] = {}\n\nMULTI_HOP_PAIRS = [\n    {\"entry\": \"ch-zurich-1\", \"exit\": \"se-stockholm-1\", \"label\": \"Swiss Guard  Nordic Shield\", \"anonymity_level\": \"maximum\"},\n    {\"entry\": \"nl-amsterdam-1\", \"exit\": \"ch-zurich-1\", \"label\": \"Dutch Gate  Swiss Vault\", \"anonymity_level\": \"maximum\"},\n    {\"entry\": \"us-east-1\", \"exit\": \"uk-london-1\", \"label\": \"US Shield  UK Relay\", \"anonymity_level\": \"high\"},\n    {\"entry\": \"de-frankfurt-1\", \"exit\": \"nl-amsterdam-1\", \"label\": \"German Fortress  Dutch Exit\", \"anonymity_level\": \"maximum\"},\n    {\"entry\": \"jp-tokyo-1\", \"exit\": \"sg-singapore-1\", \"label\": \"Tokyo Gate  Singapore Relay\", \"anonymity_level\": \"high\"},\n    {\"entry\": \"ca-toronto-1\", \"exit\": \"us-west-1\", \"label\": \"Canada Shield  US West Exit\", \"anonymity_level\": \"high\"},\n    {\"entry\": \"uk-london-1\", \"exit\": \"fr-paris-1\", \"label\": \"London Bridge  Paris Tunnel\", \"anonymity_level\": \"high\"},\n    {\"entry\": \"se-stockholm-1\", \"exit\": \"de-frankfurt-1\", \"label\": \"Nordic Entry  Frankfurt Exit\", \"anonymity_level\": \"maximum\"},\n]\n\nFINGERPRINT_HEADERS_TO_STRIP = [\n    \"User-Agent\",\n    \"Accept-Language\",\n    \"Accept-Encoding\",\n    \"Accept\",\n    \"DNT\",\n    \"Sec-CH-UA\",\n    \"Sec-CH-UA-Mobile\",\n    \"Sec-CH-UA-Platform\",\n    \"Sec-CH-UA-Full-Version\",\n    \"Sec-CH-UA-Arch\",\n    \"Sec-CH-UA-Model\",\n    \"Sec-CH-UA-Platform-Version\",\n    \"Sec-Fetch-Dest\",\n    \"Sec-Fetch-Mode\",\n    \"Sec-Fetch-Site\",\n    \"Sec-Fetch-User\",\n    \"X-Forwarded-For\",\n    \"X-Real-IP\",\n    \"Via\",\n    \"Forwarded\",\n    \"X-Client-IP\",\n    \"CF-Connecting-IP\",\n    \"True-Client-IP\",\n    \"X-Cluster-Client-IP\",\n    \"Fastly-Client-IP\",\n    \"X-Originating-IP\",\n    \"X-Request-ID\",\n    \"X-Correlation-ID\",\n    \"X-Device-ID\",\n    \"X-Session-ID\",\n    \"Cookie\",\n    \"Referer\",\n    \"Origin\",\n]\n\nFINGERPRINT_NORMALIZED_HEADERS = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36\",\n    \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\",\n    \"Accept-Language\": \"en-US,en;q=0.5\",\n    \"Accept-Encoding\": \"gzip, deflate, br\",\n    \"Sec-CH-UA\": '\"Chromium\";v=\"125\", \"Google Chrome\";v=\"125\", \"Not=A?Brand\";v=\"24\"',\n    \"Sec-CH-UA-Mobile\": \"?0\",\n    \"Sec-CH-UA-Platform\": '\"Windows\"',\n    \"DNT\": \"1\",\n    \"Sec-Fetch-Dest\": \"document\",\n    \"Sec-Fetch-Mode\": \"navigate\",\n    \"Sec-Fetch-Site\": \"none\",\n    \"Sec-Fetch-User\": \"?1\",\n    \"Connection\": \"keep-alive\",\n    \"Upgrade-Insecure-Requests\": \"1\",\n}\n\nCANVAS_NOISE_PROFILES = [\n    {\"hash\": uuid.uuid4().hex, \"noise_level\": 0.02, \"entropy_bits\": 128},\n    {\"hash\": uuid.uuid4().hex, \"noise_level\": 0.015, \"entropy_bits\": 128},\n    {\"hash\": uuid.uuid4().hex, \"noise_level\": 0.025, \"entropy_bits\": 128},\n]\n\nWEBGL_SPOOF_PROFILES = [\n    {\"vendor\": \"Google Inc. (NVIDIA)\", \"renderer\": \"ANGLE (NVIDIA GeForce RTX 3060 Direct3D11 vs_5_0 ps_5_0)\", \"hash\": uuid.uuid4().hex[:16]},\n    {\"vendor\": \"Google Inc. (AMD)\", \"renderer\": \"ANGLE (AMD Radeon RX 580 Direct3D11 vs_5_0 ps_5_0)\", \"hash\": uuid.uuid4().hex[:16]},\n    {\"vendor\": \"Google Inc. (Intel)\", \"renderer\": \"ANGLE (Intel UHD Graphics 630 Direct3D11 vs_5_0 ps_5_0)\", \"hash\": uuid.uuid4().hex[:16]},\n]\n\n\nRESIDENTIAL_IP_POOL = [\n    {\"ip\": \"72.134.92.{}\".format(random.randint(1, 254)), \"isp\": \"Comcast Cable\", \"type\": \"residential\", \"city\": \"Chicago\", \"state\": \"IL\", \"asn\": \"AS7922\"},\n    {\"ip\": \"98.45.172.{}\".format(random.randint(1, 254)), \"isp\": \"AT&T Internet\", \"type\": \"residential\", \"city\": \"Dallas\", \"state\": \"TX\", \"asn\": \"AS7018\"},\n    {\"ip\": \"68.193.58.{}\".format(random.randint(1, 254)), \"isp\": \"Verizon FiOS\", \"type\": \"residential\", \"city\": \"New York\", \"state\": \"NY\", \"asn\": \"AS701\"},\n    {\"ip\": \"76.120.33.{}\".format(random.randint(1, 254)), \"isp\": \"Charter Spectrum\", \"type\": \"residential\", \"city\": \"Los Angeles\", \"state\": \"CA\", \"asn\": \"AS20115\"},\n    {\"ip\": \"24.56.178.{}\".format(random.randint(1, 254)), \"isp\": \"Cox Communications\", \"type\": \"residential\", \"city\": \"Phoenix\", \"state\": \"AZ\", \"asn\": \"AS22773\"},\n    {\"ip\": \"71.82.214.{}\".format(random.randint(1, 254)), \"isp\": \"Comcast Cable\", \"type\": \"residential\", \"city\": \"Philadelphia\", \"state\": \"PA\", \"asn\": \"AS7922\"},\n    {\"ip\": \"99.112.45.{}\".format(random.randint(1, 254)), \"isp\": \"AT&T Internet\", \"type\": \"residential\", \"city\": \"Houston\", \"state\": \"TX\", \"asn\": \"AS7018\"},\n    {\"ip\": \"108.26.193.{}\".format(random.randint(1, 254)), \"isp\": \"Verizon FiOS\", \"type\": \"residential\", \"city\": \"Boston\", \"state\": \"MA\", \"asn\": \"AS701\"},\n    {\"ip\": \"73.158.67.{}\".format(random.randint(1, 254)), \"isp\": \"Comcast Cable\", \"type\": \"residential\", \"city\": \"Denver\", \"state\": \"CO\", \"asn\": \"AS7922\"},\n    {\"ip\": \"47.184.92.{}\".format(random.randint(1, 254)), \"isp\": \"Frontier Communications\", \"type\": \"residential\", \"city\": \"Seattle\", \"state\": \"WA\", \"asn\": \"AS5650\"},\n]\n\nSTEALTH_PROTOCOLS = {\n    \"shadowsocks\": {\n        \"name\": \"Shadowsocks\",\n        \"cipher\": \"chacha20-ietf-poly1305\",\n        \"port\": 443,\n        \"obfs\": \"tls\",\n        \"obfs_host\": \"www.bing.com\",\n        \"description\": \"Wraps WireGuard in Shadowsocks envelope, traffic appears as standard TLS/HTTPS\",\n        \"fingerprint\": \"TLS 1.3 Client Hello\",\n        \"header_size_bytes\": 34,\n    },\n    \"v2ray\": {\n        \"name\": \"V2Ray (VMess + WebSocket)\",\n        \"transport\": \"websocket\",\n        \"security\": \"tls\",\n        \"port\": 443,\n        \"path\": \"/cdn-cgi/trace\",\n        \"host\": \"cdn.cloudflare.com\",\n        \"alter_id\": 0,\n        \"description\": \"Disguises WireGuard as Cloudflare WebSocket traffic on port 443\",\n        \"fingerprint\": \"Chrome TLS fingerprint\",\n        \"header_size_bytes\": 58,\n    },\n    \"obfs4\": {\n        \"name\": \"obfs4 (Pluggable Transport)\",\n        \"port\": 443,\n        \"iat_mode\": 1,\n        \"description\": \"Randomizes packet timing and sizes, indistinguishable from random noise\",\n        \"fingerprint\": \"None (fully randomized)\",\n        \"header_size_bytes\": 24,\n    },\n}\n\n\ndef kill_switch_register(session_id: str, enabled: bool = True) -> dict:\n    if not enabled:\n        return {\"kill_switch\": \"disabled\", \"session_id\": session_id}\n\n    kill_switch_registry[session_id] = {\n        \"session_id\": session_id,\n        \"enabled\": True,\n        \"last_heartbeat\": time.time(),\n        \"heartbeat_interval_sec\": KILL_SWITCH_HEARTBEAT_INTERVAL,\n        \"timeout_sec\": KILL_SWITCH_TIMEOUT,\n        \"missed_heartbeats\": 0,\n        \"max_missed_heartbeats\": 3,\n        \"status\": \"active\",\n        \"created_at\": datetime.now(timezone.utc).isoformat(),\n        \"network_lock\": True,\n        \"block_ipv6\": True,\n        \"block_non_vpn_traffic\": True,\n        \"firewall_rules\": [\n            {\"rule\": \"BLOCK_ALL_NON_TUNNEL\", \"action\": \"drop\", \"priority\": 1},\n            {\"rule\": \"ALLOW_VPN_GATEWAY\", \"action\": \"accept\", \"priority\": 2},\n            {\"rule\": \"ALLOW_LOCAL_DHCP\", \"action\": \"accept\", \"priority\": 3},\n            {\"rule\": \"BLOCK_DNS_LEAK\", \"action\": \"drop\", \"priority\": 4},\n            {\"rule\": \"BLOCK_IPv6\", \"action\": \"drop\", \"priority\": 5},\n        ],\n    }\n    return kill_switch_registry[session_id]\n\n\ndef kill_switch_heartbeat(session_id: str) -> dict:\n    if session_id not in kill_switch_registry:\n        return {\"error\": \"Kill switch not registered for this session\", \"session_id\": session_id}\n\n    ks = kill_switch_registry[session_id]\n    now = time.time()\n    time_since_last = now - ks[\"last_heartbeat\"]\n\n    ks[\"last_heartbeat\"] = now\n    ks[\"missed_heartbeats\"] = 0\n    ks[\"status\"] = \"active\"\n\n    return {\n        \"session_id\": session_id,\n        \"status\": \"active\",\n        \"heartbeat_received\": True,\n        \"time_since_last_heartbeat_sec\": round(time_since_last, 2),\n        \"next_heartbeat_due_sec\": KILL_SWITCH_HEARTBEAT_INTERVAL,\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\ndef kill_switch_check_all() -> list[dict]:\n    terminated = []\n    now = time.time()\n    expired_sessions = []\n\n    for sid, ks in kill_switch_registry.items():\n        if not ks[\"enabled\"]:\n            continue\n        elapsed = now - ks[\"last_heartbeat\"]\n        missed = int(elapsed / KILL_SWITCH_HEARTBEAT_INTERVAL)\n        ks[\"missed_heartbeats\"] = missed\n\n        if elapsed >= KILL_SWITCH_TIMEOUT:\n            ks[\"status\"] = \"triggered\"\n            if sid in active_sessions:\n                session = active_sessions.pop(sid)\n                terminated.append({\n                    \"session_id\": sid,\n                    \"reason\": \"heartbeat_timeout\",\n                    \"missed_heartbeats\": missed,\n                    \"elapsed_since_last_heartbeat_sec\": round(elapsed, 2),\n                    \"server_id\": session.get(\"server_id\"),\n                    \"terminated_at\": datetime.now(timezone.utc).isoformat(),\n                })\n            expired_sessions.append(sid)\n        elif missed >= 1:\n            ks[\"status\"] = \"warning\"\n\n    for sid in expired_sessions:\n        kill_switch_registry.pop(sid, None)\n\n    return terminated\n\n\ndef build_multi_hop_route(entry_server_id: str, exit_server_id: str) -> dict:\n    entry_server = next((s for s in SERVERS if s[\"id\"] == entry_server_id), None)\n    exit_server = next((s for s in SERVERS if s[\"id\"] == exit_server_id), None)\n\n    if not entry_server:\n        raise HTTPException(status_code=404, detail=f\"Entry server not found: {entry_server_id}\")\n    if not exit_server:\n        raise HTTPException(status_code=404, detail=f\"Exit server not found: {exit_server_id}\")\n    if entry_server_id == exit_server_id:\n        raise HTTPException(status_code=400, detail=\"Entry and exit nodes must be different servers\")\n\n    inter_node_latency = random.randint(15, 45)\n\n    return {\n        \"multi_hop\": True,\n        \"hops\": 2,\n        \"route\": [\n            {\n                \"hop\": 1,\n                \"role\": \"entry_node\",\n                \"server\": {\n                    \"id\": entry_server[\"id\"],\n                    \"name\": entry_server[\"name\"],\n                    \"city\": entry_server[\"city\"],\n                    \"country\": entry_server[\"country\"],\n                    \"flag\": entry_server[\"flag\"],\n                    \"ip\": entry_server[\"ip\"],\n                },\n                \"encryption\": {\n                    \"layer\": \"outer\",\n                    \"algorithm\": \"AES-256-GCM\",\n                    \"key_exchange\": \"Curve25519\",\n                    \"pfs\": True,\n                },\n                \"function\": \"Receives encrypted traffic, re-encrypts and forwards to exit node\",\n            },\n            {\n                \"hop\": 2,\n                \"role\": \"exit_node\",\n                \"server\": {\n                    \"id\": exit_server[\"id\"],\n                    \"name\": exit_server[\"name\"],\n                    \"city\": exit_server[\"city\"],\n                    \"country\": exit_server[\"country\"],\n                    \"flag\": exit_server[\"flag\"],\n                    \"ip\": exit_server[\"ip\"],\n                },\n                \"encryption\": {\n                    \"layer\": \"inner\",\n                    \"algorithm\": \"ChaCha20-Poly1305\",\n                    \"key_exchange\": \"Curve25519\",\n                    \"pfs\": True,\n                },\n                \"function\": \"Decrypts outer layer, forwards inner-encrypted traffic to destination\",\n            },\n        ],\n        \"total_latency_ms\": entry_server[\"ping\"] + exit_server[\"ping\"] + inter_node_latency,\n        \"inter_node_latency_ms\": inter_node_latency,\n        \"encryption_layers\": 2,\n        \"entry_knows_destination\": False,\n        \"exit_knows_source\": False,\n        \"anonymity_benefit\": \"Neither node can correlate your identity with your destination\",\n    }\n\n\ndef generate_fingerprint_shield(session_id: Optional[str] = None) -> dict:\n    canvas_profile = random.choice(CANVAS_NOISE_PROFILES)\n    webgl_profile = random.choice(WEBGL_SPOOF_PROFILES)\n\n    timezone_offset = random.choice([-8, -7, -6, -5, -4, 0, 1, 2])\n    screen_resolutions = [\n        {\"width\": 1920, \"height\": 1080},\n        {\"width\": 2560, \"height\": 1440},\n        {\"width\": 1366, \"height\": 768},\n        {\"width\": 1536, \"height\": 864},\n        {\"width\": 1440, \"height\": 900},\n    ]\n    spoofed_screen = random.choice(screen_resolutions)\n\n    return {\n        \"enabled\": True,\n        \"session_id\": session_id,\n        \"header_sanitization\": {\n            \"headers_stripped\": len(FINGERPRINT_HEADERS_TO_STRIP),\n            \"stripped_headers\": FINGERPRINT_HEADERS_TO_STRIP,\n            \"normalized_headers\": FINGERPRINT_NORMALIZED_HEADERS,\n            \"strategy\": \"All identifying headers are either stripped or replaced with generic values matching the most common browser profile worldwide\",\n        },\n        \"browser_fingerprint_spoofing\": {\n            \"canvas\": {\n                \"protection\": \"noise_injection\",\n                \"noise_level\": canvas_profile[\"noise_level\"],\n                \"unique_hash\": canvas_profile[\"hash\"],\n                \"entropy_bits\": canvas_profile[\"entropy_bits\"],\n                \"description\": \"Injects subtle random noise into Canvas API calls to produce a unique-per-session fingerprint\",\n            },\n            \"webgl\": {\n                \"protection\": \"vendor_spoofing\",\n                \"spoofed_vendor\": webgl_profile[\"vendor\"],\n                \"spoofed_renderer\": webgl_profile[\"renderer\"],\n                \"hash\": webgl_profile[\"hash\"],\n                \"description\": \"Reports a common GPU configuration to blend with millions of identical setups\",\n            },\n            \"audio_context\": {\n                \"protection\": \"noise_injection\",\n                \"noise_amplitude\": round(random.uniform(0.001, 0.005), 4),\n                \"sample_rate_spoofed\": 44100,\n                \"description\": \"Adds micro-noise to AudioContext fingerprint to prevent audio-based tracking\",\n            },\n            \"screen\": {\n                \"protection\": \"resolution_spoofing\",\n                \"reported_resolution\": spoofed_screen,\n                \"color_depth\": 24,\n                \"device_pixel_ratio\": 1.0,\n                \"description\": \"Reports a common screen resolution to avoid unique screen fingerprinting\",\n            },\n            \"timezone\": {\n                \"protection\": \"timezone_spoofing\",\n                \"reported_offset\": timezone_offset,\n                \"reported_timezone\": f\"Etc/GMT{'+' if timezone_offset <= 0 else '-'}{abs(timezone_offset)}\",\n                \"description\": \"Spoofs timezone to break geographic correlation\",\n            },\n            \"fonts\": {\n                \"protection\": \"font_enumeration_blocked\",\n                \"visible_fonts\": 42,\n                \"actual_fonts\": \"hidden\",\n                \"description\": \"Limits visible fonts to a common subset, blocking font enumeration attacks\",\n            },\n        },\n        \"network_fingerprint_protection\": {\n            \"tcp_fingerprint\": {\n                \"os_spoofed\": \"Windows 10\",\n                \"ttl\": 128,\n                \"window_size\": 65535,\n                \"mss\": 1460,\n                \"description\": \"TCP/IP stack parameters normalized to match Windows 10 defaults\",\n            },\n            \"tls_fingerprint\": {\n                \"ja3_spoofed\": True,\n                \"mimicked_client\": \"Chrome 125 on Windows\",\n                \"ja3_hash\": uuid.uuid4().hex[:32],\n                \"description\": \"TLS Client Hello fingerprint matches the most common Chrome configuration\",\n            },\n            \"http2_fingerprint\": {\n                \"akamai_hash_spoofed\": True,\n                \"settings_order\": \"normalized\",\n                \"description\": \"HTTP/2 SETTINGS frame order normalized to match Chrome defaults\",\n            },\n        },\n        \"tracking_prevention\": {\n            \"cookies\": \"isolated_per_session\",\n            \"local_storage\": \"cleared_on_disconnect\",\n            \"indexed_db\": \"blocked\",\n            \"cache_partitioned\": True,\n            \"etag_tracking\": \"blocked\",\n            \"hsts_supercookies\": \"cleared\",\n            \"referrer_policy\": \"strict-origin-when-cross-origin\",\n        },\n        \"overall_uniqueness_score\": round(random.uniform(0.001, 0.01), 4),\n        \"blend_population\": f\"~{random.randint(15, 45)} million users with identical fingerprint\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\ndef residential_proxy_middleware(region: Optional[str] = None) -> dict:\n    selected_ip = get_residential_ip(region)\n    return {\n        \"assigned_ip\": selected_ip[\"ip\"],\n        \"isp\": selected_ip[\"isp\"],\n        \"ip_type\": selected_ip[\"type\"],\n        \"city\": selected_ip[\"city\"],\n        \"state\": selected_ip[\"state\"],\n        \"asn\": selected_ip[\"asn\"],\n        \"proxy_chain\": [\n            {\"hop\": 1, \"type\": \"vpn_tunnel\", \"protocol\": \"WireGuard\", \"encryption\": \"ChaCha20-Poly1305\"},\n            {\"hop\": 2, \"type\": \"residential_gateway\", \"protocol\": \"SOCKS5\", \"encryption\": \"AES-256-GCM\"},\n            {\"hop\": 3, \"type\": \"residential_exit\", \"ip\": selected_ip[\"ip\"], \"isp\": selected_ip[\"isp\"]},\n        ],\n        \"routing_latency_ms\": random.randint(5, 25),\n        \"detection_risk\": \"very_low\",\n        \"bot_detection_bypass\": True,\n    }\n\n\ndef get_residential_ip(region: Optional[str] = None) -> dict:\n    if region:\n        regional = [ip for ip in RESIDENTIAL_IP_POOL if ip[\"state\"] == region.upper()]\n        if regional:\n            return random.choice(regional)\n    return random.choice(RESIDENTIAL_IP_POOL)\n\n\ndef wrap_stealth_headers(protocol: str, payload_size: int = 0) -> dict:\n    config = STEALTH_PROTOCOLS.get(protocol)\n    if not config:\n        return {\"error\": f\"Unknown stealth protocol: {protocol}\"}\n\n    base = {\n        \"stealth_protocol\": config[\"name\"],\n        \"outer_port\": config[\"port\"],\n        \"inner_protocol\": \"WireGuard\",\n        \"overhead_bytes\": config[\"header_size_bytes\"],\n        \"effective_mtu\": 1500 - config[\"header_size_bytes\"],\n        \"fingerprint_mimicry\": config.get(\"fingerprint\", \"None\"),\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n    if protocol == \"shadowsocks\":\n        base.update({\n            \"cipher\": config[\"cipher\"],\n            \"obfuscation\": config[\"obfs\"],\n            \"sni_host\": config[\"obfs_host\"],\n            \"tls_version\": \"1.3\",\n            \"wrapped_payload_size\": payload_size + config[\"header_size_bytes\"],\n        })\n    elif protocol == \"v2ray\":\n        base.update({\n            \"transport\": config[\"transport\"],\n            \"ws_path\": config[\"path\"],\n            \"cdn_host\": config[\"host\"],\n            \"tls_version\": \"1.3\",\n            \"http_method\": \"GET\",\n            \"upgrade_header\": \"websocket\",\n            \"wrapped_payload_size\": payload_size + config[\"header_size_bytes\"],\n        })\n    elif protocol == \"obfs4\":\n        base.update({\n            \"iat_mode\": config[\"iat_mode\"],\n            \"packet_padding\": random.randint(0, 255),\n            \"timing_jitter_ms\": round(random.uniform(0, 50), 2),\n            \"wrapped_payload_size\": payload_size + config[\"header_size_bytes\"] + random.randint(0, 255),\n        })\n\n    return base\n\n\nclass ConnectRequest(BaseModel):\n    server_id: str\n    protocol: Optional[str] = \"WireGuard\"\n    double_vpn: Optional[bool] = False\n    double_vpn_server_id: Optional[str] = None\n    stealth_mode: Optional[str] = None\n    use_residential_ip: Optional[bool] = False\n    residential_region: Optional[str] = None\n    kill_switch: Optional[bool] = True\n    fingerprint_shield: Optional[bool] = False\n\n\nclass ConnectResponse(BaseModel):\n    session_id: str\n    status: str\n    server: dict\n    virtual_ip: str\n    handshake: dict\n    encryption: dict\n    timestamp: str\n\n\nclass StatusResponse(BaseModel):\n    session_id: str\n    status: str\n    uptime_seconds: int\n    latency_ms: int\n    server: dict\n    bytes_sent: int\n    bytes_received: int\n    encryption: dict\n\n\nclass SecurityCheckResponse(BaseModel):\n    dns_leak: dict\n    webrtc_leak: dict\n    ipv6_leak: dict\n    overall_status: str\n    checked_at: str\n\n\n@app.post(\"/api/connect\")\nasync def connect(req: ConnectRequest, current_user: User = Depends(get_current_user), db: Session = Depends(get_db)):\n    server = next((s for s in SERVERS if s[\"id\"] == req.server_id), None)\n    if not server:\n        raise HTTPException(status_code=404, detail=\"Server not found\")\n\n    session_id = str(uuid.uuid4())\n    virtual_ip = f\"{random.randint(10, 200)}.{random.randint(0, 255)}.{random.randint(0, 255)}.{random.randint(10, 200)}\"\n\n    if req.stealth_mode and req.stealth_mode not in STEALTH_PROTOCOLS:\n        raise HTTPException(\n            status_code=400,\n            detail=f\"Unknown stealth protocol: {req.stealth_mode}. Available: {list(STEALTH_PROTOCOLS.keys())}\",\n        )\n\n    residential_ip_info = None\n    if req.use_residential_ip:\n        residential_ip_info = residential_proxy_middleware(req.residential_region)\n        virtual_ip = residential_ip_info[\"assigned_ip\"]\n\n    stealth_info = None\n    if req.stealth_mode:\n        stealth_info = wrap_stealth_headers(req.stealth_mode, payload_size=1400)\n\n    session = {\n        \"session_id\": session_id,\n        \"server_id\": req.server_id,\n        \"server\": server,\n        \"virtual_ip\": virtual_ip,\n        \"protocol\": req.protocol or \"WireGuard\",\n        \"connected_at\": time.time(),\n        \"double_vpn\": req.double_vpn,\n        \"double_vpn_server_id\": req.double_vpn_server_id,\n        \"stealth_mode\": req.stealth_mode,\n        \"residential_ip\": residential_ip_info,\n        \"stealth_config\": stealth_info,\n    }\n    active_sessions[session_id] = session\n\n    handshake_latency = random.randint(45, 180)\n    if req.stealth_mode:\n        handshake_latency += random.randint(20, 80)\n\n    response_data: dict = {\n        \"session_id\": session_id,\n        \"status\": \"connected\",\n        \"server\": {\n            \"id\": server[\"id\"],\n            \"name\": server[\"name\"],\n            \"city\": server[\"city\"],\n            \"country\": server[\"country\"],\n            \"flag\": server[\"flag\"],\n            \"ip\": server[\"ip\"],\n        },\n        \"virtual_ip\": virtual_ip,\n        \"handshake\": {\n            \"protocol\": req.protocol or \"WireGuard\",\n            \"latency_ms\": handshake_latency,\n            \"cipher\": \"ChaCha20-Poly1305\",\n            \"key_exchange\": \"Curve25519\",\n            \"pfs\": True,\n        },\n        \"encryption\": {\n            \"algorithm\": \"AES-256-GCM\",\n            \"key_size\": 256,\n            \"hmac\": \"SHA-512\",\n            \"handshake_cipher\": \"ChaCha20-Poly1305\",\n        },\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n    if residential_ip_info:\n        response_data[\"residential_proxy\"] = {\n            \"enabled\": True,\n            \"exit_ip\": residential_ip_info[\"assigned_ip\"],\n            \"isp\": residential_ip_info[\"isp\"],\n            \"ip_type\": residential_ip_info[\"ip_type\"],\n            \"city\": residential_ip_info[\"city\"],\n            \"state\": residential_ip_info[\"state\"],\n            \"asn\": residential_ip_info[\"asn\"],\n            \"proxy_chain\": residential_ip_info[\"proxy_chain\"],\n            \"routing_latency_ms\": residential_ip_info[\"routing_latency_ms\"],\n            \"detection_risk\": residential_ip_info[\"detection_risk\"],\n            \"bot_detection_bypass\": residential_ip_info[\"bot_detection_bypass\"],\n        }\n\n    if stealth_info:\n        response_data[\"stealth\"] = stealth_info\n\n    if req.kill_switch:\n        ks_info = kill_switch_register(session_id, enabled=True)\n        session[\"kill_switch\"] = True\n        response_data[\"kill_switch\"] = {\n            \"enabled\": True,\n            \"heartbeat_interval_sec\": KILL_SWITCH_HEARTBEAT_INTERVAL,\n            \"timeout_sec\": KILL_SWITCH_TIMEOUT,\n            \"network_lock\": True,\n            \"firewall_rules\": len(ks_info[\"firewall_rules\"]),\n        }\n\n    if req.fingerprint_shield:\n        fp_shield = generate_fingerprint_shield(session_id)\n        session[\"fingerprint_shield\"] = True\n        response_data[\"fingerprint_shield\"] = {\n            \"enabled\": True,\n            \"headers_sanitized\": fp_shield[\"header_sanitization\"][\"headers_stripped\"],\n            \"canvas_protection\": True,\n            \"webgl_protection\": True,\n            \"audio_protection\": True,\n            \"network_protection\": True,\n            \"uniqueness_score\": fp_shield[\"overall_uniqueness_score\"],\n            \"blend_population\": fp_shield[\"blend_population\"],\n        }\n\n    current_user.total_sessions = (current_user.total_sessions or 0) + 1\n    db.commit()\n\n    session[\"user_id\"] = current_user.id\n\n    create_minimal_log(\n        db,\n        event_type=\"session_start\",\n        protocol=req.protocol,\n        region=server.get(\"flag\"),\n    )\n\n    return response_data\n\n\n@app.get(\"/api/status\")\nasync def status(session_id: Optional[str] = None, current_user: User = Depends(get_current_user)):\n    if not session_id and active_sessions:\n        session_id = list(active_sessions.keys())[-1]\n\n    if not session_id or session_id not in active_sessions:\n        return {\n            \"status\": \"disconnected\",\n            \"active_sessions\": len(active_sessions),\n            \"message\": \"No active VPN session\",\n        }\n\n    session = active_sessions[session_id]\n    uptime = int(time.time() - session[\"connected_at\"])\n    server = session[\"server\"]\n\n    residential_info = session.get(\"residential_ip\")\n    display_ip = residential_info[\"assigned_ip\"] if residential_info else server[\"ip\"]\n\n    status_data = {\n        \"session_id\": session_id,\n        \"status\": \"connected\",\n        \"uptime_seconds\": uptime,\n        \"latency_ms\": server[\"ping\"] + random.randint(-5, 10),\n        \"server\": {\n            \"id\": server[\"id\"],\n            \"name\": server[\"name\"],\n            \"city\": server[\"city\"],\n            \"country\": server[\"country\"],\n            \"flag\": server[\"flag\"],\n        },\n        \"bytes_sent\": uptime * random.randint(50000, 200000),\n        \"bytes_received\": uptime * random.randint(200000, 800000),\n        \"encryption\": {\n            \"algorithm\": \"AES-256-GCM\",\n            \"key_size\": 256,\n            \"active\": True,\n        },\n        \"visible_ip\": display_ip,\n    }\n\n    if residential_info:\n        status_data[\"residential_mask\"] = {\n            \"active\": True,\n            \"proxy_ip\": residential_info[\"assigned_ip\"],\n            \"isp\": residential_info[\"isp\"],\n            \"ip_type\": residential_info[\"ip_type\"],\n            \"city\": residential_info[\"city\"],\n            \"state\": residential_info[\"state\"],\n            \"asn\": residential_info[\"asn\"],\n            \"proxy_chain_hops\": len(residential_info.get(\"proxy_chain\", [])),\n            \"detection_risk\": residential_info.get(\"detection_risk\", \"very_low\"),\n        }\n        status_data[\"proxy_chaining\"] = {\n            \"enabled\": True,\n            \"routing_mode\": PROXY_CHAIN_CONFIG[\"routing_mode\"],\n            \"redsocks_port\": PROXY_CHAIN_CONFIG[\"redsocks_port\"],\n            \"iptables_rules_applied\": len(PROXY_CHAIN_CONFIG[\"iptables_rules\"]),\n            \"proxy_type\": PROXY_CHAIN_CONFIG[\"redsocks_config\"][\"type\"],\n        }\n    else:\n        status_data[\"residential_mask\"] = {\"active\": False}\n\n    return status_data\n\n\n@app.get(\"/api/servers\")\nasync def get_servers():\n    live_servers = []\n    for s in SERVERS:\n        live = {**s}\n        live[\"load\"] = round(min(100, max(5, s[\"load\"] + random.uniform(-8, 8))), 1)\n        live[\"ping\"] = max(5, s[\"ping\"] + random.randint(-5, 5))\n        live[\"status\"] = \"online\" if live[\"load\"] < 95 else \"busy\"\n        live[\"active_users\"] = random.randint(100, int(s[\"capacity\"] * live[\"load\"] / 100))\n        live_servers.append(live)\n\n    return {\n        \"servers\": live_servers,\n        \"total\": len(live_servers),\n        \"regions\": len(set(s[\"country\"] for s in SERVERS)),\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.get(\"/api/security-check\", response_model=SecurityCheckResponse)\nasync def security_check(session_id: Optional[str] = None, current_user: User = Depends(get_current_user)):\n    is_connected = bool(session_id and session_id in active_sessions)\n\n    dns_servers_detected = []\n    if is_connected and session_id is not None:\n        session = active_sessions[session_id]\n        dns_servers_detected = [\n            {\"ip\": session[\"server\"][\"ip\"], \"provider\": \"xVPN Secure DNS\", \"location\": session[\"server\"][\"city\"]},\n        ]\n    else:\n        dns_servers_detected = [\n            {\"ip\": \"8.8.8.8\", \"provider\": \"Google Public DNS\", \"location\": \"Mountain View, US\"},\n            {\"ip\": \"8.8.4.4\", \"provider\": \"Google Public DNS\", \"location\": \"Mountain View, US\"},\n        ]\n\n    return SecurityCheckResponse(\n        dns_leak={\n            \"status\": \"protected\" if is_connected else \"exposed\",\n            \"leak_detected\": not is_connected,\n            \"dns_servers\": dns_servers_detected,\n            \"test_domain\": \"leak-test.xvpn.internal\",\n            \"resolution_time_ms\": random.randint(2, 15),\n        },\n        webrtc_leak={\n            \"status\": \"protected\" if is_connected else \"vulnerable\",\n            \"leak_detected\": not is_connected,\n            \"local_ip_exposed\": not is_connected,\n            \"public_ip_exposed\": not is_connected,\n            \"stun_server_blocked\": is_connected,\n            \"mitigation\": \"WebRTC disabled via browser policy\" if is_connected else \"No protection active\",\n        },\n        ipv6_leak={\n            \"status\": \"protected\" if is_connected else \"unknown\",\n            \"leak_detected\": False,\n            \"ipv6_disabled\": is_connected,\n            \"tunnel_ipv6\": False,\n            \"mitigation\": \"IPv6 traffic blocked at tunnel level\" if is_connected else \"No IPv6 protection\",\n        },\n        overall_status=\"secure\" if is_connected else \"at_risk\",\n        checked_at=datetime.now(timezone.utc).isoformat(),\n    )\n\n\n@app.delete(\"/api/disconnect\")\nasync def disconnect(session_id: str, current_user: User = Depends(get_current_user), db: Session = Depends(get_db)):\n    if session_id not in active_sessions:\n        raise HTTPException(status_code=404, detail=\"Session not found\")\n\n    session = active_sessions.pop(session_id)\n    uptime = int(time.time() - session[\"connected_at\"])\n\n    kill_switch_registry.pop(session_id, None)\n\n    bytes_transferred = uptime * random.randint(100000, 500000)\n    current_user.total_data_transferred_bytes = (current_user.total_data_transferred_bytes or 0) + bytes_transferred\n    db.commit()\n\n    create_minimal_log(\n        db,\n        event_type=\"session_end\",\n        duration_seconds=uptime,\n        bytes_transferred=bytes_transferred,\n        protocol=session.get(\"protocol\"),\n        region=session.get(\"server\", {}).get(\"flag\"),\n    )\n\n    return {\n        \"status\": \"disconnected\",\n        \"session_id\": session_id,\n        \"uptime_seconds\": uptime,\n        \"kill_switch_disarmed\": session.get(\"kill_switch\", False),\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.get(\"/api/obfuscation/protocols\")\nasync def get_obfuscation_protocols():\n    protocols = []\n    for key, config in STEALTH_PROTOCOLS.items():\n        protocols.append({\n            \"id\": key,\n            \"name\": config[\"name\"],\n            \"port\": config[\"port\"],\n            \"description\": config[\"description\"],\n            \"fingerprint\": config.get(\"fingerprint\", \"Unknown\"),\n            \"overhead_bytes\": config[\"header_size_bytes\"],\n            \"effective_mtu\": 1500 - config[\"header_size_bytes\"],\n        })\n\n    return {\n        \"protocols\": protocols,\n        \"residential_proxy\": {\n            \"available\": True,\n            \"pool_size\": len(RESIDENTIAL_IP_POOL),\n            \"regions\": list(set(ip[\"state\"] for ip in RESIDENTIAL_IP_POOL)),\n            \"isps\": list(set(ip[\"isp\"] for ip in RESIDENTIAL_IP_POOL)),\n            \"description\": \"Routes traffic through residential IP addresses from major US ISPs to bypass datacenter IP detection\",\n        },\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.post(\"/api/obfuscation/test\")\nasync def test_obfuscation(\n    stealth_protocol: str = \"shadowsocks\",\n    use_residential: bool = False,\n    region: Optional[str] = None,\n):\n    stealth = wrap_stealth_headers(stealth_protocol, payload_size=1400)\n    residential = get_residential_ip(region) if use_residential else None\n\n    detection_tests = {\n        \"dpi_bypass\": {\n            \"status\": \"pass\",\n            \"method\": f\"Traffic wrapped in {STEALTH_PROTOCOLS.get(stealth_protocol, {}).get('name', 'unknown')} on port 443\",\n            \"confidence\": round(random.uniform(95, 99.9), 1),\n        },\n        \"ip_reputation\": {\n            \"status\": \"pass\" if use_residential else \"warning\",\n            \"ip_type\": \"residential\" if use_residential else \"datacenter\",\n            \"risk_score\": random.randint(1, 10) if use_residential else random.randint(30, 60),\n            \"flagged_by_banks\": False if use_residential else True,\n        },\n        \"traffic_analysis\": {\n            \"status\": \"pass\",\n            \"pattern\": \"indistinguishable from HTTPS\",\n            \"packet_size_variance\": round(random.uniform(0.85, 0.98), 2),\n            \"timing_regularity\": round(random.uniform(0.7, 0.95), 2),\n        },\n        \"tls_fingerprint\": {\n            \"status\": \"pass\",\n            \"mimicked_client\": stealth.get(\"fingerprint_mimicry\", \"Unknown\"),\n            \"ja3_hash\": uuid.uuid4().hex[:32],\n            \"match_score\": round(random.uniform(97, 99.99), 2),\n        },\n    }\n\n    return {\n        \"stealth_config\": stealth,\n        \"residential_proxy\": residential,\n        \"detection_tests\": detection_tests,\n        \"overall_stealth_rating\": \"excellent\" if use_residential else \"good\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.post(\"/api/kill-switch/enable\")\nasync def enable_kill_switch(session_id: str, current_user: User = Depends(get_current_user)):\n    if session_id not in active_sessions:\n        raise HTTPException(status_code=404, detail=\"Session not found\")\n\n    ks_info = kill_switch_register(session_id, enabled=True)\n    active_sessions[session_id][\"kill_switch\"] = True\n\n    return {\n        \"status\": \"enabled\",\n        \"kill_switch\": ks_info,\n        \"message\": \"Kill switch activated. All non-VPN traffic will be blocked if the tunnel drops.\",\n    }\n\n\n@app.post(\"/api/kill-switch/heartbeat\")\nasync def heartbeat(session_id: str, current_user: User = Depends(get_current_user)):\n    if session_id not in active_sessions:\n        if session_id in kill_switch_registry:\n            kill_switch_registry.pop(session_id)\n        raise HTTPException(status_code=404, detail=\"Session not found or already terminated by kill switch\")\n\n    result = kill_switch_heartbeat(session_id)\n    if \"error\" in result:\n        raise HTTPException(status_code=400, detail=result[\"error\"])\n\n    return result\n\n\n@app.get(\"/api/kill-switch/status\")\nasync def kill_switch_status(session_id: Optional[str] = None, current_user: User = Depends(get_current_user)):\n    if session_id:\n        if session_id not in kill_switch_registry:\n            return {\n                \"session_id\": session_id,\n                \"kill_switch_enabled\": False,\n                \"message\": \"Kill switch not registered for this session\",\n            }\n        ks = kill_switch_registry[session_id]\n        elapsed = time.time() - ks[\"last_heartbeat\"]\n        return {\n            \"session_id\": session_id,\n            \"kill_switch_enabled\": ks[\"enabled\"],\n            \"status\": ks[\"status\"],\n            \"missed_heartbeats\": ks[\"missed_heartbeats\"],\n            \"last_heartbeat_sec_ago\": round(elapsed, 2),\n            \"timeout_sec\": ks[\"timeout_sec\"],\n            \"network_lock\": ks[\"network_lock\"],\n            \"firewall_rules_active\": len(ks[\"firewall_rules\"]),\n        }\n\n    return {\n        \"total_monitored_sessions\": len(kill_switch_registry),\n        \"sessions\": [\n            {\n                \"session_id\": sid,\n                \"status\": ks[\"status\"],\n                \"missed_heartbeats\": ks[\"missed_heartbeats\"],\n                \"last_heartbeat_sec_ago\": round(time.time() - ks[\"last_heartbeat\"], 2),\n            }\n            for sid, ks in kill_switch_registry.items()\n        ],\n    }\n\n\n@app.post(\"/api/kill-switch/check\")\nasync def run_kill_switch_check(current_user: User = Depends(get_current_user)):\n    terminated = kill_switch_check_all()\n    return {\n        \"terminated_sessions\": terminated,\n        \"terminated_count\": len(terminated),\n        \"remaining_monitored\": len(kill_switch_registry),\n        \"remaining_active_sessions\": len(active_sessions),\n        \"checked_at\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.post(\"/api/connect/multi-hop\")\nasync def connect_multi_hop(\n    entry_server_id: str,\n    exit_server_id: str,\n    stealth_mode: Optional[str] = None,\n    kill_switch: Optional[bool] = True,\n    current_user: User = Depends(get_current_user),\n    db: Session = Depends(get_db),\n):\n    entry_server = next((s for s in SERVERS if s[\"id\"] == entry_server_id), None)\n    exit_server = next((s for s in SERVERS if s[\"id\"] == exit_server_id), None)\n\n    if not entry_server:\n        raise HTTPException(status_code=404, detail=f\"Entry server not found: {entry_server_id}\")\n    if not exit_server:\n        raise HTTPException(status_code=404, detail=f\"Exit server not found: {exit_server_id}\")\n    if entry_server_id == exit_server_id:\n        raise HTTPException(status_code=400, detail=\"Entry and exit servers must be different\")\n\n    if stealth_mode and stealth_mode not in STEALTH_PROTOCOLS:\n        raise HTTPException(\n            status_code=400,\n            detail=f\"Unknown stealth protocol: {stealth_mode}. Available: {list(STEALTH_PROTOCOLS.keys())}\",\n        )\n\n    route = build_multi_hop_route(entry_server_id, exit_server_id)\n    session_id = str(uuid.uuid4())\n    virtual_ip = f\"{random.randint(10, 200)}.{random.randint(0, 255)}.{random.randint(0, 255)}.{random.randint(10, 200)}\"\n\n    session = {\n        \"session_id\": session_id,\n        \"server_id\": exit_server_id,\n        \"server\": exit_server,\n        \"entry_server\": entry_server,\n        \"virtual_ip\": virtual_ip,\n        \"protocol\": \"WireGuard\",\n        \"connected_at\": time.time(),\n        \"multi_hop\": True,\n        \"entry_server_id\": entry_server_id,\n        \"exit_server_id\": exit_server_id,\n        \"double_vpn\": True,\n        \"kill_switch\": kill_switch,\n    }\n    active_sessions[session_id] = session\n\n    if kill_switch:\n        kill_switch_register(session_id, enabled=True)\n\n    stealth_info = None\n    if stealth_mode:\n        stealth_info = wrap_stealth_headers(stealth_mode, payload_size=1400)\n        session[\"stealth_mode\"] = stealth_mode\n        session[\"stealth_config\"] = stealth_info\n\n    response_data = {\n        \"session_id\": session_id,\n        \"status\": \"connected\",\n        \"multi_hop\": route,\n        \"virtual_ip\": virtual_ip,\n        \"handshake\": {\n            \"protocol\": \"WireGuard (Double-encrypted)\",\n            \"entry_latency_ms\": entry_server[\"ping\"] + random.randint(-5, 10),\n            \"exit_latency_ms\": exit_server[\"ping\"] + random.randint(-5, 10),\n            \"total_latency_ms\": route[\"total_latency_ms\"],\n            \"cipher\": \"AES-256-GCM + ChaCha20-Poly1305\",\n            \"key_exchange\": \"Curve25519 (per-hop)\",\n            \"pfs\": True,\n        },\n        \"encryption\": {\n            \"layers\": 2,\n            \"outer\": {\"algorithm\": \"AES-256-GCM\", \"key_size\": 256},\n            \"inner\": {\"algorithm\": \"ChaCha20-Poly1305\", \"key_size\": 256},\n            \"hmac\": \"SHA-512\",\n        },\n        \"kill_switch_enabled\": kill_switch,\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n    if stealth_info:\n        response_data[\"stealth\"] = stealth_info\n\n    current_user.total_sessions = (current_user.total_sessions or 0) + 1\n    db.commit()\n    session[\"user_id\"] = current_user.id\n\n    create_minimal_log(\n        db,\n        event_type=\"multi_hop_session_start\",\n        protocol=\"WireGuard (Double-encrypted)\",\n    )\n\n    return response_data\n\n\n@app.get(\"/api/multi-hop/routes\")\nasync def get_multi_hop_routes():\n    routes = []\n    for pair in MULTI_HOP_PAIRS:\n        entry = next((s for s in SERVERS if s[\"id\"] == pair[\"entry\"]), None)\n        exit_s = next((s for s in SERVERS if s[\"id\"] == pair[\"exit\"]), None)\n        if entry and exit_s:\n            routes.append({\n                \"entry_server\": {\n                    \"id\": entry[\"id\"],\n                    \"name\": entry[\"name\"],\n                    \"city\": entry[\"city\"],\n                    \"country\": entry[\"country\"],\n                    \"flag\": entry[\"flag\"],\n                },\n                \"exit_server\": {\n                    \"id\": exit_s[\"id\"],\n                    \"name\": exit_s[\"name\"],\n                    \"city\": exit_s[\"city\"],\n                    \"country\": exit_s[\"country\"],\n                    \"flag\": exit_s[\"flag\"],\n                },\n                \"label\": pair[\"label\"],\n                \"anonymity_level\": pair[\"anonymity_level\"],\n                \"estimated_latency_ms\": entry[\"ping\"] + exit_s[\"ping\"] + random.randint(15, 45),\n            })\n\n    return {\n        \"recommended_routes\": routes,\n        \"total_routes\": len(routes),\n        \"custom_route_available\": True,\n        \"message\": \"You can also create custom routes using any two different servers via POST /api/connect/multi-hop\",\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.get(\"/api/fingerprint-shield\")\nasync def get_fingerprint_shield(session_id: Optional[str] = None, current_user: User = Depends(get_current_user)):\n    if session_id and session_id not in active_sessions:\n        raise HTTPException(status_code=404, detail=\"Session not found\")\n\n    shield = generate_fingerprint_shield(session_id)\n    return shield\n\n\n@app.post(\"/api/fingerprint-shield/test\")\nasync def test_fingerprint_shield(\n    include_canvas: bool = True,\n    include_webgl: bool = True,\n    include_audio: bool = True,\n    include_network: bool = True,\n):\n    shield = generate_fingerprint_shield()\n\n    test_results = {\n        \"tests_run\": 0,\n        \"tests_passed\": 0,\n        \"details\": [],\n    }\n\n    if include_canvas:\n        test_results[\"tests_run\"] += 1\n        passed = random.random() > 0.02\n        test_results[\"tests_passed\"] += 1 if passed else 0\n        test_results[\"details\"].append({\n            \"test\": \"canvas_fingerprint\",\n            \"status\": \"pass\" if passed else \"fail\",\n            \"original_hash\": uuid.uuid4().hex[:16],\n            \"spoofed_hash\": shield[\"browser_fingerprint_spoofing\"][\"canvas\"][\"unique_hash\"][:16],\n            \"hashes_match\": False,\n            \"description\": \"Canvas fingerprint successfully randomized\" if passed else \"Canvas fingerprint leaked\",\n        })\n\n    if include_webgl:\n        test_results[\"tests_run\"] += 1\n        passed = random.random() > 0.01\n        test_results[\"tests_passed\"] += 1 if passed else 0\n        test_results[\"details\"].append({\n            \"test\": \"webgl_fingerprint\",\n            \"status\": \"pass\" if passed else \"fail\",\n            \"spoofed_vendor\": shield[\"browser_fingerprint_spoofing\"][\"webgl\"][\"spoofed_vendor\"],\n            \"spoofed_renderer\": shield[\"browser_fingerprint_spoofing\"][\"webgl\"][\"spoofed_renderer\"],\n            \"description\": \"WebGL vendor/renderer successfully spoofed\" if passed else \"WebGL fingerprint leaked\",\n        })\n\n    if include_audio:\n        test_results[\"tests_run\"] += 1\n        passed = random.random() > 0.03\n        test_results[\"tests_passed\"] += 1 if passed else 0\n        test_results[\"details\"].append({\n            \"test\": \"audio_fingerprint\",\n            \"status\": \"pass\" if passed else \"fail\",\n            \"noise_injected\": True,\n            \"description\": \"Audio context fingerprint successfully noised\" if passed else \"Audio fingerprint leaked\",\n        })\n\n    if include_network:\n        test_results[\"tests_run\"] += 2\n        tcp_pass = random.random() > 0.01\n        tls_pass = random.random() > 0.01\n        test_results[\"tests_passed\"] += (1 if tcp_pass else 0) + (1 if tls_pass else 0)\n        test_results[\"details\"].extend([\n            {\n                \"test\": \"tcp_fingerprint\",\n                \"status\": \"pass\" if tcp_pass else \"fail\",\n                \"os_detected\": \"Windows 10\" if tcp_pass else \"Linux\",\n                \"description\": \"TCP stack fingerprint matches spoofed OS\" if tcp_pass else \"TCP fingerprint leaked real OS\",\n            },\n            {\n                \"test\": \"tls_ja3_fingerprint\",\n                \"status\": \"pass\" if tls_pass else \"fail\",\n                \"ja3_matches_chrome\": tls_pass,\n                \"description\": \"TLS fingerprint matches Chrome 125\" if tls_pass else \"TLS fingerprint leaked\",\n            },\n        ])\n\n    test_results[\"overall_status\"] = \"pass\" if test_results[\"tests_passed\"] == test_results[\"tests_run\"] else \"partial_fail\"\n    test_results[\"protection_score\"] = round(test_results[\"tests_passed\"] / max(1, test_results[\"tests_run\"]) * 100, 1)\n    test_results[\"timestamp\"] = datetime.now(timezone.utc).isoformat()\n\n    return test_results\n\n\n@app.get(\"/api/proxy-chain/config\")\nasync def get_proxy_chain_config(current_user: User = Depends(get_current_user)):\n    return {\n        \"proxy_chaining\": {\n            \"enabled\": True,\n            \"residential_proxy_url\": RESIDENTIAL_PROXY_URL.split(\"@\")[0][:15] + \"***@\" + RESIDENTIAL_PROXY_URL.split(\"@\")[-1] if \"@\" in RESIDENTIAL_PROXY_URL else \"configured\",\n            \"routing\": {\n                \"mode\": PROXY_CHAIN_CONFIG[\"routing_mode\"],\n                \"tool\": \"redsocks\",\n                \"interface\": \"wg0\",\n                \"description\": \"All outbound traffic from the WireGuard interface is routed through the residential proxy via iptables NAT redirect to redsocks\",\n            },\n            \"redsocks\": {\n                \"local_port\": PROXY_CHAIN_CONFIG[\"redsocks_port\"],\n                \"proxy_type\": PROXY_CHAIN_CONFIG[\"redsocks_config\"][\"type\"],\n                \"remote_host\": PROXY_CHAIN_CONFIG[\"redsocks_config\"][\"ip\"],\n                \"remote_port\": PROXY_CHAIN_CONFIG[\"redsocks_config\"][\"port\"],\n            },\n            \"iptables_rules_count\": len(PROXY_CHAIN_CONFIG[\"iptables_rules\"]),\n            \"bypass_ranges\": [\n                \"0.0.0.0/8\",\n                \"10.0.0.0/8\",\n                \"127.0.0.0/8\",\n                \"172.16.0.0/12\",\n                \"192.168.0.0/16\",\n            ],\n            \"traffic_flow\": [\n                {\"step\": 1, \"action\": \"App traffic enters WireGuard tunnel (wg0)\"},\n                {\"step\": 2, \"action\": \"iptables NAT catches outbound TCP on wg0\"},\n                {\"step\": 3, \"action\": \"Traffic redirected to redsocks (port 12345)\"},\n                {\"step\": 4, \"action\": \"Redsocks wraps traffic in SOCKS5 to residential proxy\"},\n                {\"step\": 5, \"action\": \"Residential proxy exits through ISP IP (Comcast/AT&T/Verizon)\"},\n            ],\n        },\n        \"residential_pool\": {\n            \"total_ips\": len(RESIDENTIAL_IP_POOL),\n            \"isps\": list(set(ip[\"isp\"] for ip in RESIDENTIAL_IP_POOL)),\n            \"regions\": list(set(ip[\"state\"] for ip in RESIDENTIAL_IP_POOL)),\n        },\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.post(\"/api/proxy-chain/test\")\nasync def test_proxy_chain(\n    region: Optional[str] = None,\n    current_user: User = Depends(get_current_user),\n):\n    selected_ip = get_residential_ip(region)\n\n    return {\n        \"test_result\": \"pass\",\n        \"residential_exit_ip\": selected_ip[\"ip\"],\n        \"isp\": selected_ip[\"isp\"],\n        \"ip_type\": selected_ip[\"type\"],\n        \"location\": f\"{selected_ip['city']}, {selected_ip['state']}\",\n        \"asn\": selected_ip[\"asn\"],\n        \"proxy_chain_verified\": True,\n        \"chain\": [\n            {\"hop\": 1, \"type\": \"wireguard_tunnel\", \"status\": \"active\", \"latency_ms\": random.randint(2, 8)},\n            {\"hop\": 2, \"type\": \"redsocks_redirect\", \"status\": \"active\", \"latency_ms\": random.randint(1, 3)},\n            {\"hop\": 3, \"type\": \"socks5_proxy\", \"status\": \"active\", \"latency_ms\": random.randint(5, 20)},\n            {\"hop\": 4, \"type\": \"residential_exit\", \"ip\": selected_ip[\"ip\"], \"status\": \"active\", \"latency_ms\": random.randint(3, 12)},\n        ],\n        \"total_chain_latency_ms\": random.randint(15, 40),\n        \"ip_reputation\": {\n            \"score\": round(random.uniform(0.85, 0.99), 2),\n            \"classification\": \"residential\",\n            \"blacklisted\": False,\n            \"datacenter_detected\": False,\n        },\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n\n\n@app.get(\"/api/health\")\nasync def health():\n    return {\n        \"status\": \"healthy\",\n        \"version\": \"1.0.0\",\n        \"active_sessions\": len(active_sessions),\n        \"available_servers\": len(SERVERS),\n        \"proxy_chain_configured\": True,\n        \"timestamp\": datetime.now(timezone.utc).isoformat(),\n    }\n","path":null,"size_bytes":64229,"size_tokens":null},"components/ErrorBoundary.tsx":{"content":"import React, { Component, ComponentType, PropsWithChildren } from \"react\";\nimport { ErrorFallback, ErrorFallbackProps } from \"@/components/ErrorFallback\";\n\nexport type ErrorBoundaryProps = PropsWithChildren<{\n  FallbackComponent?: ComponentType<ErrorFallbackProps>;\n  onError?: (error: Error, stackTrace: string) => void;\n}>;\n\ntype ErrorBoundaryState = { error: Error | null };\n\n/**\n * This is a special case for for using the class components. Error boundaries must be class components because React only provides error boundary functionality through lifecycle methods (componentDidCatch and getDerivedStateFromError) which are not available in functional components.\n * https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\n */\n\nexport class ErrorBoundary extends Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  state: ErrorBoundaryState = { error: null };\n\n  static defaultProps: {\n    FallbackComponent: ComponentType<ErrorFallbackProps>;\n  } = {\n    FallbackComponent: ErrorFallback,\n  };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { error };\n  }\n\n  componentDidCatch(error: Error, info: { componentStack: string }): void {\n    if (typeof this.props.onError === \"function\") {\n      this.props.onError(error, info.componentStack);\n    }\n  }\n\n  resetError = (): void => {\n    this.setState({ error: null });\n  };\n\n  render() {\n    const { FallbackComponent } = this.props;\n\n    return this.state.error && FallbackComponent ? (\n      <FallbackComponent\n        error={this.state.error}\n        resetError={this.resetError}\n      />\n    ) : (\n      this.props.children\n    );\n  }\n}\n","path":null,"size_bytes":1674,"size_tokens":null},"scripts/build.js":{"content":"const fs = require(\"fs\");\nconst path = require(\"path\");\nconst { spawn } = require(\"child_process\");\nconst { Readable } = require(\"stream\");\nconst { pipeline } = require(\"stream/promises\");\n\nlet metroProcess = null;\n\nfunction exitWithError(message) {\n  console.error(message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n}\n\nfunction setupSignalHandlers() {\n  const cleanup = () => {\n    if (metroProcess) {\n      console.log(\"Cleaning up Metro process...\");\n      metroProcess.kill();\n    }\n    process.exit(0);\n  };\n\n  process.on(\"SIGINT\", cleanup);\n  process.on(\"SIGTERM\", cleanup);\n  process.on(\"SIGHUP\", cleanup);\n}\n\nfunction stripProtocol(domain) {\n  let urlString = domain.trim();\n\n  if (!/^https?:\\/\\//i.test(urlString)) {\n    urlString = `https://${urlString}`;\n  }\n\n  return new URL(urlString).host;\n}\n\nfunction getDeploymentDomain() {\n  // Check Replit deployment environment variables first\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    return stripProtocol(process.env.REPLIT_INTERNAL_APP_DOMAIN);\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    return stripProtocol(process.env.REPLIT_DEV_DOMAIN);\n  }\n\n  if (process.env.EXPO_PUBLIC_DOMAIN) {\n    return stripProtocol(process.env.EXPO_PUBLIC_DOMAIN);\n  }\n\n  console.error(\n    \"ERROR: No deployment domain found. Set REPLIT_INTERNAL_APP_DOMAIN, REPLIT_DEV_DOMAIN, or EXPO_PUBLIC_DOMAIN\",\n  );\n  process.exit(1);\n}\n\nfunction prepareDirectories(timestamp) {\n  console.log(\"Preparing build directories...\");\n\n  if (fs.existsSync(\"static-build\")) {\n    fs.rmSync(\"static-build\", { recursive: true });\n  }\n\n  const dirs = [\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"ios\"),\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"android\"),\n    path.join(\"static-build\", \"ios\"),\n    path.join(\"static-build\", \"android\"),\n  ];\n\n  for (const dir of dirs) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  console.log(\"Build:\", timestamp);\n}\n\nfunction clearMetroCache() {\n  console.log(\"Clearing Metro cache...\");\n\n  const cacheDirs = [\n    ...fs.globSync(\".metro-cache\"),\n    ...fs.globSync(\"node_modules/.cache/metro\"),\n  ];\n\n  for (const dir of cacheDirs) {\n    fs.rmSync(dir, { recursive: true, force: true });\n  }\n\n  console.log(\"Cache cleared\");\n}\n\nasync function checkMetroHealth() {\n  try {\n    const response = await fetch(\"http://localhost:8081/status\", {\n      signal: AbortSignal.timeout(5000),\n    });\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\nasync function startMetro(expoPublicDomain) {\n  const isRunning = await checkMetroHealth();\n  if (isRunning) {\n    console.log(\"Metro already running\");\n    return;\n  }\n\n  console.log(\"Starting Metro...\");\n  console.log(`Setting EXPO_PUBLIC_DOMAIN=${expoPublicDomain}`);\n  const env = {\n    ...process.env,\n    EXPO_PUBLIC_DOMAIN: expoPublicDomain,\n  };\n  metroProcess = spawn(\"npm\", [\"run\", \"expo:start:static:build\"], {\n    stdio: [\"ignore\", \"pipe\", \"pipe\"],\n    detached: false,\n    env,\n  });\n\n  if (metroProcess.stdout) {\n    metroProcess.stdout.on(\"data\", (data) => {\n      const output = data.toString().trim();\n      if (output) console.log(`[Metro] ${output}`);\n    });\n  }\n  if (metroProcess.stderr) {\n    metroProcess.stderr.on(\"data\", (data) => {\n      const output = data.toString().trim();\n      if (output) console.error(`[Metro Error] ${output}`);\n    });\n  }\n\n  for (let i = 0; i < 60; i++) {\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n\n    const healthy = await checkMetroHealth();\n    if (healthy) {\n      console.log(\"Metro ready\");\n      return;\n    }\n  }\n\n  console.error(\"Metro timeout\");\n  process.exit(1);\n}\n\nasync function downloadFile(url, outputPath) {\n  const controller = new AbortController();\n  const fiveMinMS = 5 * 60 * 1_000;\n  const timeoutId = setTimeout(() => controller.abort(), fiveMinMS);\n\n  try {\n    console.log(`Downloading: ${url}`);\n    const response = await fetch(url, { signal: controller.signal });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const file = fs.createWriteStream(outputPath);\n    await pipeline(Readable.fromWeb(response.body), file);\n\n    const fileSize = fs.statSync(outputPath).size;\n\n    if (fileSize === 0) {\n      fs.unlinkSync(outputPath);\n      throw new Error(\"Downloaded file is empty\");\n    }\n  } catch (error) {\n    if (fs.existsSync(outputPath)) {\n      fs.unlinkSync(outputPath);\n    }\n\n    if (error.name === \"AbortError\") {\n      throw new Error(`Download timeout after 5m: ${url}`);\n    }\n    throw error;\n  } finally {\n    clearTimeout(timeoutId);\n  }\n}\n\nasync function downloadBundle(platform, timestamp) {\n  // For expo-router apps, the entry is node_modules/expo-router/entry\n  const url = new URL(\"http://localhost:8081/node_modules/expo-router/entry.bundle\");\n  url.searchParams.set(\"platform\", platform);\n  url.searchParams.set(\"dev\", \"false\");\n  url.searchParams.set(\"hot\", \"false\");\n  url.searchParams.set(\"lazy\", \"false\");\n  url.searchParams.set(\"minify\", \"true\");\n\n  const output = path.join(\n    \"static-build\",\n    timestamp,\n    \"_expo\",\n    \"static\",\n    \"js\",\n    platform,\n    \"bundle.js\",\n  );\n\n  console.log(`Fetching ${platform} bundle...`);\n  await downloadFile(url.toString(), output);\n  console.log(`${platform} bundle ready`);\n}\n\nasync function downloadManifest(platform) {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), 300_000);\n\n  try {\n    console.log(`Fetching ${platform} manifest...`);\n    const response = await fetch(\"http://localhost:8081/manifest\", {\n      headers: { \"expo-platform\": platform },\n      signal: controller.signal,\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const manifest = await response.json();\n    console.log(`${platform} manifest ready`);\n    return manifest;\n  } catch (error) {\n    if (error.name === \"AbortError\") {\n      throw new Error(\n        `Manifest download timeout after 5m for platform: ${platform}`,\n      );\n    }\n    throw error;\n  } finally {\n    clearTimeout(timeoutId);\n  }\n}\n\nasync function downloadBundlesAndManifests(timestamp) {\n  console.log(\"Downloading bundles and manifests...\");\n  console.log(\"This may take several minutes for production builds...\");\n\n  try {\n    const results = await Promise.allSettled([\n      downloadBundle(\"ios\", timestamp),\n      downloadBundle(\"android\", timestamp),\n      downloadManifest(\"ios\"),\n      downloadManifest(\"android\"),\n    ]);\n\n    const failures = results\n      .map((result, index) => ({ result, index }))\n      .filter(({ result }) => result.status === \"rejected\");\n\n    if (failures.length > 0) {\n      const errorMessages = failures.map(({ result, index }) => {\n        const names = [\n          \"iOS bundle\",\n          \"Android bundle\",\n          \"iOS manifest\",\n          \"Android manifest\",\n        ];\n        return `  - ${names[index]}: ${result.reason?.message || result.reason}`;\n      });\n\n      exitWithError(`Download failed:\\n${errorMessages.join(\"\\n\")}`);\n    }\n\n    const iosManifest =\n      results[2].status === \"fulfilled\" ? results[2].value : null;\n    const androidManifest =\n      results[3].status === \"fulfilled\" ? results[3].value : null;\n\n    console.log(\"All downloads completed successfully\");\n    return { ios: iosManifest, android: androidManifest };\n  } catch (error) {\n    exitWithError(`Unexpected download error: ${error.message}`);\n  }\n}\n\nfunction extractAssets(timestamp) {\n  const bundles = {\n    ios: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"ios\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n    android: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"android\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n  };\n\n  const assetsMap = new Map();\n  const assetPattern =\n    /httpServerLocation:\"([^\"]+)\"[^}]*hash:\"([^\"]+)\"[^}]*name:\"([^\"]+)\"[^}]*type:\"([^\"]+)\"/g;\n\n  const extractFromBundle = (bundle, platform) => {\n    for (const match of bundle.matchAll(assetPattern)) {\n      const originalPath = match[1];\n      const filename = match[3] + \".\" + match[4];\n\n      const tempUrl = new URL(`http://localhost:8081${originalPath}`);\n      const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n      if (!unstablePath) {\n        throw new Error(`Asset missing unstable_path: ${originalPath}`);\n      }\n\n      const decodedPath = decodeURIComponent(unstablePath);\n      const key = path.posix.join(decodedPath, filename);\n\n      if (!assetsMap.has(key)) {\n        const asset = {\n          url: path.posix.join(\"/\", decodedPath, filename),\n          originalPath: originalPath,\n          filename: filename,\n          relativePath: decodedPath,\n          hash: match[2],\n          platforms: new Set(),\n        };\n\n        assetsMap.set(key, asset);\n      }\n      assetsMap.get(key).platforms.add(platform);\n    }\n  };\n\n  extractFromBundle(bundles.ios, \"ios\");\n  extractFromBundle(bundles.android, \"android\");\n\n  return Array.from(assetsMap.values());\n}\n\nasync function downloadAssets(assets, timestamp) {\n  if (assets.length === 0) {\n    return 0;\n  }\n\n  console.log(\"Downloading assets...\");\n  let successCount = 0;\n  const failures = [];\n\n  const downloadPromises = assets.map(async (asset) => {\n    const platform = Array.from(asset.platforms)[0];\n\n    const tempUrl = new URL(`http://localhost:8081${asset.originalPath}`);\n    const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n    if (!unstablePath) {\n      throw new Error(`Asset missing unstable_path: ${asset.originalPath}`);\n    }\n\n    const decodedPath = decodeURIComponent(unstablePath);\n    const metroUrl = new URL(\n      `http://localhost:8081${path.posix.join(\"/assets\", decodedPath, asset.filename)}`,\n    );\n    metroUrl.searchParams.set(\"platform\", platform);\n    metroUrl.searchParams.set(\"hash\", asset.hash);\n\n    const outputDir = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      asset.relativePath,\n    );\n    fs.mkdirSync(outputDir, { recursive: true });\n    const output = path.join(outputDir, asset.filename);\n\n    try {\n      await downloadFile(metroUrl.toString(), output);\n      successCount++;\n    } catch (error) {\n      failures.push({\n        filename: asset.filename,\n        error: error.message,\n        url: metroUrl.toString(),\n      });\n    }\n  });\n\n  await Promise.all(downloadPromises);\n\n  if (failures.length > 0) {\n    const errorMsg =\n      `Failed to download ${failures.length} asset(s):\\n` +\n      failures\n        .map((f) => `  - ${f.filename}: ${f.error} (${f.url})`)\n        .join(\"\\n\");\n    exitWithError(errorMsg);\n  }\n\n  console.log(`Downloaded ${successCount} assets`);\n  return successCount;\n}\n\nfunction updateBundleUrls(timestamp, baseUrl) {\n  const updateForPlatform = (platform) => {\n    const bundlePath = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      platform,\n      \"bundle.js\",\n    );\n    let bundle = fs.readFileSync(bundlePath, \"utf-8\");\n\n    bundle = bundle.replace(\n      /httpServerLocation:\"(\\/[^\"]+)\"/g,\n      (_match, capturedPath) => {\n        const tempUrl = new URL(`http://localhost:8081${capturedPath}`);\n        const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n        if (!unstablePath) {\n          throw new Error(\n            `Asset missing unstable_path in bundle: ${capturedPath}`,\n          );\n        }\n\n        const decodedPath = decodeURIComponent(unstablePath);\n        return `httpServerLocation:\"${baseUrl}/${timestamp}/_expo/static/js/${decodedPath}\"`;\n      },\n    );\n\n    fs.writeFileSync(bundlePath, bundle);\n  };\n\n  updateForPlatform(\"ios\");\n  updateForPlatform(\"android\");\n  console.log(\"Updated bundle URLs\");\n}\n\nfunction updateManifests(manifests, timestamp, baseUrl, assetsByHash) {\n  const updateForPlatform = (platform, manifest) => {\n    if (!manifest.launchAsset || !manifest.extra) {\n      exitWithError(`Malformed manifest for ${platform}`);\n    }\n\n    manifest.launchAsset.url = `${baseUrl}/${timestamp}/_expo/static/js/${platform}/bundle.js`;\n    manifest.launchAsset.key = `bundle-${timestamp}`;\n    manifest.createdAt = new Date(\n      Number(timestamp.split(\"-\")[0]),\n    ).toISOString();\n    manifest.extra.expoClient.hostUri =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.debuggerHost =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.packagerOpts.dev = false;\n\n    if (manifest.assets && manifest.assets.length > 0) {\n      manifest.assets.forEach((asset) => {\n        if (!asset.url) return;\n\n        const hash = asset.hash;\n        if (!hash) return;\n\n        const assetInfo = assetsByHash.get(hash);\n        if (!assetInfo) return;\n\n        asset.url = `${baseUrl}/${timestamp}/_expo/static/js/${assetInfo.relativePath}/${assetInfo.filename}`;\n      });\n    }\n\n    fs.writeFileSync(\n      path.join(\"static-build\", platform, \"manifest.json\"),\n      JSON.stringify(manifest, null, 2),\n    );\n  };\n\n  updateForPlatform(\"ios\", manifests.ios);\n  updateForPlatform(\"android\", manifests.android);\n  console.log(\"Manifests updated\");\n}\n\nasync function main() {\n  console.log(\"Building static Expo Go deployment...\");\n\n  setupSignalHandlers();\n\n  const domain = getDeploymentDomain();\n  const baseUrl = `https://${domain}`;\n  const timestamp = `${Date.now()}-${process.pid}`;\n\n  prepareDirectories(timestamp);\n  clearMetroCache();\n\n  await startMetro(domain);\n\n  const downloadTimeout = 300000;\n  const downloadPromise = downloadBundlesAndManifests(timestamp);\n  const timeoutPromise = new Promise((_, reject) => {\n    setTimeout(() => {\n      reject(\n        new Error(\n          `Overall download timeout after ${downloadTimeout / 1000} seconds. ` +\n            \"Metro may be struggling to generate bundles. Check Metro logs above.\",\n        ),\n      );\n    }, downloadTimeout);\n  });\n\n  const manifests = await Promise.race([downloadPromise, timeoutPromise]);\n\n  console.log(\"Processing assets...\");\n  const assets = extractAssets(timestamp);\n  console.log(\"Found\", assets.length, \"unique asset(s)\");\n\n  const assetsByHash = new Map();\n  for (const asset of assets) {\n    assetsByHash.set(asset.hash, {\n      relativePath: asset.relativePath,\n      filename: asset.filename,\n    });\n  }\n\n  const assetCount = await downloadAssets(assets, timestamp);\n\n  if (assetCount > 0) {\n    updateBundleUrls(timestamp, baseUrl);\n  }\n\n  console.log(\"Updating manifests and creating landing page...\");\n  updateManifests(manifests, timestamp, baseUrl, assetsByHash);\n\n  console.log(\"Build complete! Deploy to:\", baseUrl);\n\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(0);\n}\n\nmain().catch((error) => {\n  console.error(\"Build failed:\", error.message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n});\n","path":null,"size_bytes":15011,"size_tokens":null},"lib/lib/vpn-context.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, useCallback, useMemo, ReactNode } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nexport interface VpnServer {\n  id: string;\n  name: string;\n  country: string;\n  city: string;\n  flag: string;\n  ping: number;\n  load: number;\n  premium: boolean;\n}\n\nexport interface ConnectionStats {\n  downloadSpeed: number;\n  uploadSpeed: number;\n  dataUsed: number;\n  sessionDuration: number;\n  ping: number;\n}\n\nexport type ConnectionState = 'disconnected' | 'connecting' | 'connected';\n\ninterface VpnContextValue {\n  connectionState: ConnectionState;\n  isConnected: boolean;\n  isConnecting: boolean;\n  selectedServer: VpnServer | null;\n  servers: VpnServer[];\n  stats: ConnectionStats;\n  favoriteServerIds: string[];\n  isPremium: boolean;\n  setPremium: (v: boolean) => void;\n  connect: () => void;\n  completeConnection: () => void;\n  disconnect: () => void;\n  selectServer: (server: VpnServer) => void;\n  toggleFavorite: (serverId: string) => void;\n  protocol: string;\n  setProtocol: (p: string) => void;\n  killSwitch: boolean;\n  setKillSwitch: (v: boolean) => void;\n  autoConnect: boolean;\n  setAutoConnect: (v: boolean) => void;\n  doubleVpn: boolean;\n  setDoubleVpn: (v: boolean) => void;\n  doubleVpnServer: VpnServer | null;\n  setDoubleVpnServer: (s: VpnServer | null) => void;\n  virtualIp: string;\n  biometricLock: boolean;\n  setBiometricLock: (v: boolean) => void;\n  dnsLeakProtection: boolean;\n  setDnsLeakProtection: (v: boolean) => void;\n  adBlocker: boolean;\n  setAdBlocker: (v: boolean) => void;\n  stealthMode: boolean;\n  setStealthMode: (v: boolean) => void;\n}\n\nconst VpnContext = createContext<VpnContextValue | null>(null);\n\nconst SERVERS: VpnServer[] = [\n  { id: '1', name: 'US - New York', country: 'United States', city: 'New York', flag: 'US', ping: 12, load: 34, premium: false },\n  { id: '2', name: 'US - Los Angeles', country: 'United States', city: 'Los Angeles', flag: 'US', ping: 28, load: 52, premium: false },\n  { id: '3', name: 'US - Dallas', country: 'United States', city: 'Dallas, TX', flag: 'US', ping: 22, load: 29, premium: false },\n  { id: '4', name: 'US - Miami', country: 'United States', city: 'Miami, FL', flag: 'US', ping: 18, load: 41, premium: false },\n  { id: '5', name: 'US - Chicago', country: 'United States', city: 'Chicago, IL', flag: 'US', ping: 16, load: 38, premium: false },\n  { id: '6', name: 'US - Seattle', country: 'United States', city: 'Seattle, WA', flag: 'US', ping: 32, load: 25, premium: false },\n  { id: '7', name: 'US - Atlanta', country: 'United States', city: 'Atlanta, GA', flag: 'US', ping: 19, load: 44, premium: false },\n  { id: '8', name: 'US - Denver', country: 'United States', city: 'Denver, CO', flag: 'US', ping: 26, load: 18, premium: false },\n  { id: '9', name: 'US - Phoenix', country: 'United States', city: 'Phoenix, AZ', flag: 'US', ping: 30, load: 22, premium: false },\n  { id: '10', name: 'US - San Francisco', country: 'United States', city: 'San Francisco, CA', flag: 'US', ping: 31, load: 58, premium: true },\n  { id: '11', name: 'US - Washington DC', country: 'United States', city: 'Washington, DC', flag: 'US', ping: 14, load: 47, premium: true },\n  { id: '12', name: 'US - Houston', country: 'United States', city: 'Houston, TX', flag: 'US', ping: 24, load: 33, premium: false },\n  { id: '13', name: 'Canada - Toronto', country: 'Canada', city: 'Toronto', flag: 'CA', ping: 18, load: 37, premium: false },\n  { id: '14', name: 'Canada - Vancouver', country: 'Canada', city: 'Vancouver', flag: 'CA', ping: 35, load: 28, premium: false },\n  { id: '15', name: 'Canada - Montreal', country: 'Canada', city: 'Montreal', flag: 'CA', ping: 20, load: 31, premium: false },\n  { id: '16', name: 'UK - London', country: 'United Kingdom', city: 'London', flag: 'GB', ping: 45, load: 41, premium: false },\n  { id: '17', name: 'UK - Manchester', country: 'United Kingdom', city: 'Manchester', flag: 'GB', ping: 48, load: 32, premium: false },\n  { id: '18', name: 'Germany - Frankfurt', country: 'Germany', city: 'Frankfurt', flag: 'DE', ping: 52, load: 28, premium: false },\n  { id: '19', name: 'Germany - Berlin', country: 'Germany', city: 'Berlin', flag: 'DE', ping: 55, load: 35, premium: false },\n  { id: '20', name: 'France - Paris', country: 'France', city: 'Paris', flag: 'FR', ping: 42, load: 31, premium: false },\n  { id: '21', name: 'France - Marseille', country: 'France', city: 'Marseille', flag: 'FR', ping: 46, load: 19, premium: false },\n  { id: '22', name: 'Netherlands - Amsterdam', country: 'Netherlands', city: 'Amsterdam', flag: 'NL', ping: 48, load: 55, premium: true },\n  { id: '23', name: 'Switzerland - Zurich', country: 'Switzerland', city: 'Zurich', flag: 'CH', ping: 56, load: 18, premium: true },\n  { id: '24', name: 'Sweden - Stockholm', country: 'Sweden', city: 'Stockholm', flag: 'SE', ping: 61, load: 15, premium: true },\n  { id: '25', name: 'Norway - Oslo', country: 'Norway', city: 'Oslo', flag: 'NO', ping: 63, load: 12, premium: true },\n  { id: '26', name: 'Denmark - Copenhagen', country: 'Denmark', city: 'Copenhagen', flag: 'DK', ping: 58, load: 20, premium: false },\n  { id: '27', name: 'Spain - Madrid', country: 'Spain', city: 'Madrid', flag: 'ES', ping: 50, load: 36, premium: false },\n  { id: '28', name: 'Italy - Milan', country: 'Italy', city: 'Milan', flag: 'IT', ping: 54, load: 42, premium: false },\n  { id: '29', name: 'Austria - Vienna', country: 'Austria', city: 'Vienna', flag: 'AT', ping: 57, load: 24, premium: false },\n  { id: '30', name: 'Poland - Warsaw', country: 'Poland', city: 'Warsaw', flag: 'PL', ping: 60, load: 30, premium: false },\n  { id: '31', name: 'Ireland - Dublin', country: 'Ireland', city: 'Dublin', flag: 'IE', ping: 44, load: 26, premium: false },\n  { id: '32', name: 'Japan - Tokyo', country: 'Japan', city: 'Tokyo', flag: 'JP', ping: 89, load: 63, premium: true },\n  { id: '33', name: 'Japan - Osaka', country: 'Japan', city: 'Osaka', flag: 'JP', ping: 92, load: 48, premium: true },\n  { id: '34', name: 'Singapore', country: 'Singapore', city: 'Singapore', flag: 'SG', ping: 78, load: 45, premium: true },\n  { id: '35', name: 'South Korea - Seoul', country: 'South Korea', city: 'Seoul', flag: 'KR', ping: 95, load: 71, premium: true },\n  { id: '36', name: 'Hong Kong', country: 'Hong Kong', city: 'Hong Kong', flag: 'HK', ping: 82, load: 54, premium: true },\n  { id: '37', name: 'Taiwan - Taipei', country: 'Taiwan', city: 'Taipei', flag: 'TW', ping: 86, load: 39, premium: true },\n  { id: '38', name: 'Australia - Sydney', country: 'Australia', city: 'Sydney', flag: 'AU', ping: 112, load: 22, premium: false },\n  { id: '39', name: 'Australia - Melbourne', country: 'Australia', city: 'Melbourne', flag: 'AU', ping: 118, load: 28, premium: false },\n  { id: '40', name: 'New Zealand - Auckland', country: 'New Zealand', city: 'Auckland', flag: 'NZ', ping: 125, load: 14, premium: false },\n  { id: '41', name: 'Brazil - Sao Paulo', country: 'Brazil', city: 'Sao Paulo', flag: 'BR', ping: 134, load: 42, premium: false },\n  { id: '42', name: 'Mexico - Mexico City', country: 'Mexico', city: 'Mexico City', flag: 'MX', ping: 38, load: 35, premium: false },\n  { id: '43', name: 'Argentina - Buenos Aires', country: 'Argentina', city: 'Buenos Aires', flag: 'AR', ping: 142, load: 20, premium: false },\n  { id: '44', name: 'India - Mumbai', country: 'India', city: 'Mumbai', flag: 'IN', ping: 108, load: 67, premium: false },\n  { id: '45', name: 'India - Chennai', country: 'India', city: 'Chennai', flag: 'IN', ping: 115, load: 52, premium: false },\n  { id: '46', name: 'UAE - Dubai', country: 'UAE', city: 'Dubai', flag: 'AE', ping: 98, load: 40, premium: true },\n  { id: '47', name: 'Israel - Tel Aviv', country: 'Israel', city: 'Tel Aviv', flag: 'IL', ping: 72, load: 33, premium: true },\n  { id: '48', name: 'South Africa - Johannesburg', country: 'South Africa', city: 'Johannesburg', flag: 'ZA', ping: 155, load: 18, premium: false },\n  { id: '49', name: 'Romania - Bucharest', country: 'Romania', city: 'Bucharest', flag: 'RO', ping: 62, load: 16, premium: false },\n  { id: '50', name: 'Czech Republic - Prague', country: 'Czech Republic', city: 'Prague', flag: 'CZ', ping: 53, load: 21, premium: false },\n];\n\nfunction generateVirtualIp(): string {\n  const c = Math.floor(Math.random() * 254) + 1;\n  const d = Math.floor(Math.random() * 254) + 1;\n  return `185.203.${c}.${d}`;\n}\n\nexport function VpnProvider({ children }: { children: ReactNode }) {\n  const [isPremium, setIsPremium] = useState(false);\n  const [connectionState, setConnectionState] = useState<ConnectionState>('disconnected');\n  const [isConnected, setIsConnected] = useState(false);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [selectedServer, setSelectedServer] = useState<VpnServer | null>(SERVERS[0]);\n  const [favoriteServerIds, setFavoriteServerIds] = useState<string[]>([]);\n  const [protocol, setProtocol] = useState('WireGuard');\n  const [killSwitch, setKillSwitch] = useState(true);\n  const [autoConnect, setAutoConnect] = useState(false);\n  const [doubleVpn, setDoubleVpn] = useState(false);\n  const [doubleVpnServer, setDoubleVpnServer] = useState<VpnServer | null>(SERVERS[3]);\n  const [virtualIp, setVirtualIp] = useState('---');\n  const [biometricLock, setBiometricLock] = useState(false);\n  const [dnsLeakProtection, setDnsLeakProtection] = useState(true);\n  const [adBlocker, setAdBlocker] = useState(true);\n  const [stealthMode, setStealthMode] = useState(false);\n  const [stats, setStats] = useState<ConnectionStats>({\n    downloadSpeed: 0,\n    uploadSpeed: 0,\n    dataUsed: 0,\n    sessionDuration: 0,\n    ping: 0,\n  });\n\n  useEffect(() => {\n    AsyncStorage.getItem('xvpn_is_premium').then(data => {\n      if (data) setIsPremium(JSON.parse(data));\n    });\n    AsyncStorage.getItem('xvpn_favorites').then(data => {\n      if (data) setFavoriteServerIds(JSON.parse(data));\n    });\n    AsyncStorage.getItem('xvpn_server').then(data => {\n      if (data) {\n        const s = SERVERS.find(srv => srv.id === data);\n        if (s) setSelectedServer(s);\n      }\n    });\n    AsyncStorage.getItem('xvpn_settings').then(data => {\n      if (data) {\n        const settings = JSON.parse(data);\n        if (settings.protocol) setProtocol(settings.protocol);\n        if (settings.killSwitch !== undefined) setKillSwitch(settings.killSwitch);\n        if (settings.autoConnect !== undefined) setAutoConnect(settings.autoConnect);\n        if (settings.doubleVpn !== undefined) setDoubleVpn(settings.doubleVpn);\n        if (settings.doubleVpnServerId) {\n          const dvs = SERVERS.find(srv => srv.id === settings.doubleVpnServerId);\n          if (dvs) setDoubleVpnServer(dvs);\n        }\n        if (settings.biometricLock !== undefined) setBiometricLock(settings.biometricLock);\n        if (settings.dnsLeakProtection !== undefined) setDnsLeakProtection(settings.dnsLeakProtection);\n        if (settings.adBlocker !== undefined) setAdBlocker(settings.adBlocker);\n        if (settings.stealthMode !== undefined) setStealthMode(settings.stealthMode);\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    let interval: ReturnType<typeof setInterval>;\n    if (isConnected) {\n      let baseDown = 45 + Math.random() * 30;\n      let baseUp = 15 + Math.random() * 15;\n      let driftDirection = 1;\n      let tickCounter = 0;\n\n      interval = setInterval(() => {\n        tickCounter++;\n\n        if (tickCounter % 7 === 0) {\n          driftDirection = Math.random() > 0.5 ? 1 : -1;\n          baseDown = Math.max(20, Math.min(120, baseDown + driftDirection * (Math.random() * 8)));\n          baseUp = Math.max(5, Math.min(50, baseUp + driftDirection * (Math.random() * 4)));\n        }\n\n        const jitterDown = (Math.random() - 0.5) * 12;\n        const jitterUp = (Math.random() - 0.5) * 6;\n\n        const microPause = Math.random() > 0.95 ? -baseDown * 0.3 : 0;\n\n        const burstFactor = Math.random() > 0.92 ? 1.4 + Math.random() * 0.3 : 1;\n\n        const dataJitter = 0.015 + Math.random() * 0.06 + (Math.random() > 0.9 ? Math.random() * 0.08 : 0);\n\n        const intervalJitter = Math.random() > 0.85 ? Math.floor(Math.random() * 2) : 0;\n\n        setStats(prev => ({\n          downloadSpeed: Math.max(0, (baseDown + jitterDown + microPause) * burstFactor),\n          uploadSpeed: Math.max(0, (baseUp + jitterUp) * burstFactor),\n          dataUsed: prev.dataUsed + dataJitter,\n          sessionDuration: prev.sessionDuration + 1 + intervalJitter,\n          ping: Math.max(1, (selectedServer?.ping || 20) + Math.floor(Math.random() * 12) - 6 + (Math.random() > 0.9 ? Math.floor(Math.random() * 15) : 0)),\n        }));\n      }, 1000);\n    }\n    return () => clearInterval(interval);\n  }, [isConnected, selectedServer]);\n\n  const connect = useCallback(() => {\n    setConnectionState('connecting');\n    setIsConnecting(true);\n    setStats({ downloadSpeed: 0, uploadSpeed: 0, dataUsed: 0, sessionDuration: 0, ping: 0 });\n  }, []);\n\n  const completeConnection = useCallback(() => {\n    setIsConnecting(false);\n    setIsConnected(true);\n    setConnectionState('connected');\n    setVirtualIp(generateVirtualIp());\n  }, []);\n\n  const disconnect = useCallback(() => {\n    setConnectionState('disconnected');\n    setIsConnected(false);\n    setIsConnecting(false);\n    setVirtualIp('---');\n    setStats({ downloadSpeed: 0, uploadSpeed: 0, dataUsed: 0, sessionDuration: 0, ping: 0 });\n  }, []);\n\n  const selectServer = useCallback((server: VpnServer) => {\n    setSelectedServer(server);\n    AsyncStorage.setItem('xvpn_server', server.id);\n    setConnectionState('connecting');\n    setIsConnecting(true);\n    setIsConnected(false);\n    setStats({ downloadSpeed: 0, uploadSpeed: 0, dataUsed: 0, sessionDuration: 0, ping: 0 });\n    setTimeout(() => {\n      setIsConnecting(false);\n      setIsConnected(true);\n      setConnectionState('connected');\n      setVirtualIp(generateVirtualIp());\n    }, 3000);\n  }, []);\n\n  const toggleFavorite = useCallback((serverId: string) => {\n    setFavoriteServerIds(prev => {\n      const next = prev.includes(serverId)\n        ? prev.filter(id => id !== serverId)\n        : [...prev, serverId];\n      AsyncStorage.setItem('xvpn_favorites', JSON.stringify(next));\n      return next;\n    });\n  }, []);\n\n  const saveSetting = useCallback((key: string, val: unknown) => {\n    AsyncStorage.getItem('xvpn_settings').then(data => {\n      const settings = data ? JSON.parse(data) : {};\n      settings[key] = val;\n      AsyncStorage.setItem('xvpn_settings', JSON.stringify(settings));\n    });\n  }, []);\n\n  const handleSetProtocol = useCallback((p: string) => {\n    setProtocol(p);\n    saveSetting('protocol', p);\n  }, [saveSetting]);\n\n  const handleSetKillSwitch = useCallback((v: boolean) => {\n    setKillSwitch(v);\n    saveSetting('killSwitch', v);\n  }, [saveSetting]);\n\n  const handleSetAutoConnect = useCallback((v: boolean) => {\n    setAutoConnect(v);\n    saveSetting('autoConnect', v);\n  }, [saveSetting]);\n\n  const handleSetDoubleVpn = useCallback((v: boolean) => {\n    setDoubleVpn(v);\n    saveSetting('doubleVpn', v);\n  }, [saveSetting]);\n\n  const handleSetDoubleVpnServer = useCallback((s: VpnServer | null) => {\n    setDoubleVpnServer(s);\n    saveSetting('doubleVpnServerId', s?.id || null);\n  }, [saveSetting]);\n\n  const handleSetBiometricLock = useCallback((v: boolean) => {\n    setBiometricLock(v);\n    saveSetting('biometricLock', v);\n  }, [saveSetting]);\n\n  const handleSetDnsLeakProtection = useCallback((v: boolean) => {\n    setDnsLeakProtection(v);\n    saveSetting('dnsLeakProtection', v);\n  }, [saveSetting]);\n\n  const handleSetAdBlocker = useCallback((v: boolean) => {\n    setAdBlocker(v);\n    saveSetting('adBlocker', v);\n  }, [saveSetting]);\n\n  const handleSetStealthMode = useCallback((v: boolean) => {\n    setStealthMode(v);\n    saveSetting('stealthMode', v);\n  }, [saveSetting]);\n\n  const handleSetPremium = useCallback((v: boolean) => {\n    setIsPremium(v);\n    AsyncStorage.setItem('xvpn_is_premium', JSON.stringify(v));\n  }, []);\n\n  const value = useMemo(() => ({\n    connectionState,\n    isConnected,\n    isConnecting,\n    selectedServer,\n    servers: SERVERS,\n    stats,\n    favoriteServerIds,\n    isPremium,\n    setPremium: handleSetPremium,\n    connect,\n    disconnect,\n    selectServer,\n    toggleFavorite,\n    protocol,\n    setProtocol: handleSetProtocol,\n    killSwitch,\n    setKillSwitch: handleSetKillSwitch,\n    autoConnect,\n    setAutoConnect: handleSetAutoConnect,\n    doubleVpn,\n    setDoubleVpn: handleSetDoubleVpn,\n    doubleVpnServer,\n    setDoubleVpnServer: handleSetDoubleVpnServer,\n    virtualIp,\n    completeConnection,\n    biometricLock,\n    setBiometricLock: handleSetBiometricLock,\n    dnsLeakProtection,\n    setDnsLeakProtection: handleSetDnsLeakProtection,\n    adBlocker,\n    setAdBlocker: handleSetAdBlocker,\n    stealthMode,\n    setStealthMode: handleSetStealthMode,\n  }), [isConnected, isConnecting, selectedServer, stats, favoriteServerIds, isPremium, handleSetPremium, connect, completeConnection, disconnect, selectServer, toggleFavorite, protocol, handleSetProtocol, killSwitch, handleSetKillSwitch, autoConnect, handleSetAutoConnect, doubleVpn, handleSetDoubleVpn, doubleVpnServer, handleSetDoubleVpnServer, virtualIp, biometricLock, handleSetBiometricLock, dnsLeakProtection, handleSetDnsLeakProtection, adBlocker, handleSetAdBlocker, stealthMode, handleSetStealthMode]);\n\n  return <VpnContext.Provider value={value}>{children}</VpnContext.Provider>;\n}\n\nexport function useVpn() {\n  const ctx = useContext(VpnContext);\n  if (!ctx) throw new Error('useVpn must be used within VpnProvider');\n  return ctx;\n}\n","path":null,"size_bytes":17608,"size_tokens":null},"lib/lib/fingerprint-shield.ts":{"content":"import { Platform } from 'react-native';\n\nconst CITY_TIMEZONES: Record<string, { tz: string; offset: number }> = {\n  'New York': { tz: 'America/New_York', offset: -5 },\n  'Los Angeles': { tz: 'America/Los_Angeles', offset: -8 },\n  'Dallas, TX': { tz: 'America/Chicago', offset: -6 },\n  'Miami, FL': { tz: 'America/New_York', offset: -5 },\n  'Chicago, IL': { tz: 'America/Chicago', offset: -6 },\n  'Seattle, WA': { tz: 'America/Los_Angeles', offset: -8 },\n  'Atlanta, GA': { tz: 'America/New_York', offset: -5 },\n  'Denver, CO': { tz: 'America/Denver', offset: -7 },\n  'Phoenix, AZ': { tz: 'America/Phoenix', offset: -7 },\n  'San Francisco, CA': { tz: 'America/Los_Angeles', offset: -8 },\n  'Washington, DC': { tz: 'America/New_York', offset: -5 },\n  'Houston, TX': { tz: 'America/Chicago', offset: -6 },\n  'Toronto': { tz: 'America/Toronto', offset: -5 },\n  'Vancouver': { tz: 'America/Vancouver', offset: -8 },\n  'Montreal': { tz: 'America/Toronto', offset: -5 },\n  'London': { tz: 'Europe/London', offset: 0 },\n  'Manchester': { tz: 'Europe/London', offset: 0 },\n  'Frankfurt': { tz: 'Europe/Berlin', offset: 1 },\n  'Berlin': { tz: 'Europe/Berlin', offset: 1 },\n  'Paris': { tz: 'Europe/Paris', offset: 1 },\n  'Marseille': { tz: 'Europe/Paris', offset: 1 },\n  'Amsterdam': { tz: 'Europe/Amsterdam', offset: 1 },\n  'Zurich': { tz: 'Europe/Zurich', offset: 1 },\n  'Stockholm': { tz: 'Europe/Stockholm', offset: 1 },\n  'Oslo': { tz: 'Europe/Oslo', offset: 1 },\n  'Copenhagen': { tz: 'Europe/Copenhagen', offset: 1 },\n  'Madrid': { tz: 'Europe/Madrid', offset: 1 },\n  'Milan': { tz: 'Europe/Rome', offset: 1 },\n  'Vienna': { tz: 'Europe/Vienna', offset: 1 },\n  'Warsaw': { tz: 'Europe/Warsaw', offset: 1 },\n  'Dublin': { tz: 'Europe/Dublin', offset: 0 },\n  'Tokyo': { tz: 'Asia/Tokyo', offset: 9 },\n  'Osaka': { tz: 'Asia/Tokyo', offset: 9 },\n  'Singapore': { tz: 'Asia/Singapore', offset: 8 },\n  'Seoul': { tz: 'Asia/Seoul', offset: 9 },\n  'Hong Kong': { tz: 'Asia/Hong_Kong', offset: 8 },\n  'Taipei': { tz: 'Asia/Taipei', offset: 8 },\n  'Sydney': { tz: 'Australia/Sydney', offset: 11 },\n  'Melbourne': { tz: 'Australia/Melbourne', offset: 11 },\n  'Auckland': { tz: 'Pacific/Auckland', offset: 13 },\n  'Sao Paulo': { tz: 'America/Sao_Paulo', offset: -3 },\n  'Mexico City': { tz: 'America/Mexico_City', offset: -6 },\n  'Buenos Aires': { tz: 'America/Argentina/Buenos_Aires', offset: -3 },\n  'Mumbai': { tz: 'Asia/Kolkata', offset: 5.5 },\n  'Chennai': { tz: 'Asia/Kolkata', offset: 5.5 },\n  'Dubai': { tz: 'Asia/Dubai', offset: 4 },\n  'Tel Aviv': { tz: 'Asia/Jerusalem', offset: 2 },\n  'Johannesburg': { tz: 'Africa/Johannesburg', offset: 2 },\n  'Bucharest': { tz: 'Europe/Bucharest', offset: 2 },\n  'Prague': { tz: 'Europe/Prague', offset: 1 },\n};\n\nconst SERVER_TIMEZONES: Record<string, string> = {\n  'US': 'America/New_York',\n  'GB': 'Europe/London',\n  'DE': 'Europe/Berlin',\n  'JP': 'Asia/Tokyo',\n  'SG': 'Asia/Singapore',\n  'AU': 'Australia/Sydney',\n  'CA': 'America/Toronto',\n  'NL': 'Europe/Amsterdam',\n  'CH': 'Europe/Zurich',\n  'FR': 'Europe/Paris',\n  'KR': 'Asia/Seoul',\n  'BR': 'America/Sao_Paulo',\n  'IN': 'Asia/Kolkata',\n  'SE': 'Europe/Stockholm',\n  'NO': 'Europe/Oslo',\n  'DK': 'Europe/Copenhagen',\n  'ES': 'Europe/Madrid',\n  'IT': 'Europe/Rome',\n  'AT': 'Europe/Vienna',\n  'PL': 'Europe/Warsaw',\n  'IE': 'Europe/Dublin',\n  'HK': 'Asia/Hong_Kong',\n  'TW': 'Asia/Taipei',\n  'NZ': 'Pacific/Auckland',\n  'MX': 'America/Mexico_City',\n  'AR': 'America/Argentina/Buenos_Aires',\n  'AE': 'Asia/Dubai',\n  'IL': 'Asia/Jerusalem',\n  'ZA': 'Africa/Johannesburg',\n  'RO': 'Europe/Bucharest',\n  'CZ': 'Europe/Prague',\n};\n\nconst SERVER_TIMEZONE_OFFSETS: Record<string, number> = {\n  'US': -5,\n  'GB': 0,\n  'DE': 1,\n  'JP': 9,\n  'SG': 8,\n  'AU': 11,\n  'CA': -5,\n  'NL': 1,\n  'CH': 1,\n  'FR': 1,\n  'KR': 9,\n  'BR': -3,\n  'IN': 5.5,\n  'SE': 1,\n  'NO': 1,\n  'DK': 1,\n  'ES': 1,\n  'IT': 1,\n  'AT': 1,\n  'PL': 1,\n  'IE': 0,\n  'HK': 8,\n  'TW': 8,\n  'NZ': 13,\n  'MX': -6,\n  'AR': -3,\n  'AE': 4,\n  'IL': 2,\n  'ZA': 2,\n  'RO': 2,\n  'CZ': 1,\n};\n\nconst USER_AGENTS = {\n  windows_chrome: [\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36',\n  ],\n  windows_firefox: [\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0',\n    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0',\n  ],\n  mac_safari: [\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 14_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Safari/605.1.15',\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Safari/605.1.15',\n  ],\n  mac_chrome: [\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36',\n    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36',\n  ],\n  iphone_safari: [\n    'Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1',\n    'Mozilla/5.0 (iPhone; CPU iPhone OS 17_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1',\n  ],\n};\n\nexport type UserAgentProfile = keyof typeof USER_AGENTS;\n\nexport const USER_AGENT_LABELS: Record<UserAgentProfile, string> = {\n  windows_chrome: 'Windows / Chrome',\n  windows_firefox: 'Windows / Firefox',\n  mac_safari: 'Mac / Safari',\n  mac_chrome: 'Mac / Chrome',\n  iphone_safari: 'iPhone / Safari',\n};\n\nexport interface FingerprintShieldState {\n  webrtcMask: boolean;\n  timezoneSpoofing: boolean;\n  canvasNoise: boolean;\n  userAgentRotation: boolean;\n  activeUserAgent: UserAgentProfile;\n  spoofedTimezone: string | null;\n  currentUserAgentString: string | null;\n  canvasNoiseLevel: number;\n}\n\nexport const DEFAULT_SHIELD_STATE: FingerprintShieldState = {\n  webrtcMask: true,\n  timezoneSpoofing: true,\n  canvasNoise: true,\n  userAgentRotation: false,\n  activeUserAgent: 'windows_chrome',\n  spoofedTimezone: null,\n  currentUserAgentString: null,\n  canvasNoiseLevel: 0.02,\n};\n\nexport function getTimezoneForServer(serverFlag: string, city?: string): string {\n  if (city) {\n    const cityData = CITY_TIMEZONES[city];\n    if (cityData) return cityData.tz;\n  }\n  return SERVER_TIMEZONES[serverFlag] || 'America/New_York';\n}\n\nexport function getTimezoneOffsetForServer(serverFlag: string, city?: string): number {\n  if (city) {\n    const cityData = CITY_TIMEZONES[city];\n    if (cityData) return cityData.offset;\n  }\n  const offset = SERVER_TIMEZONE_OFFSETS[serverFlag];\n  return offset !== undefined ? offset : -5;\n}\n\nexport function getRandomUserAgent(profile: UserAgentProfile): string {\n  const agents = USER_AGENTS[profile];\n  return agents[Math.floor(Math.random() * agents.length)];\n}\n\nexport function rotateUserAgent(currentProfile: UserAgentProfile): UserAgentProfile {\n  const profiles = Object.keys(USER_AGENTS) as UserAgentProfile[];\n  const currentIndex = profiles.indexOf(currentProfile);\n  return profiles[(currentIndex + 1) % profiles.length];\n}\n\nexport function generateCanvasNoise(noiseLevel: number = 0.02): number[] {\n  const noiseData: number[] = [];\n  for (let i = 0; i < 16; i++) {\n    noiseData.push((Math.random() - 0.5) * 2 * noiseLevel * 255);\n  }\n  return noiseData;\n}\n\nexport interface WebRTCLeakStatus {\n  blocked: boolean;\n  localIpHidden: boolean;\n  stunBlocked: boolean;\n  turnBlocked: boolean;\n  mdnsEnabled: boolean;\n}\n\nexport function getWebRTCLeakStatus(maskEnabled: boolean): WebRTCLeakStatus {\n  if (maskEnabled) {\n    return {\n      blocked: true,\n      localIpHidden: true,\n      stunBlocked: true,\n      turnBlocked: true,\n      mdnsEnabled: true,\n    };\n  }\n  return {\n    blocked: false,\n    localIpHidden: false,\n    stunBlocked: false,\n    turnBlocked: false,\n    mdnsEnabled: false,\n  };\n}\n\nexport interface CanvasProtectionStatus {\n  noiseInjected: boolean;\n  noiseLevel: number;\n  hashRandomized: boolean;\n  gpuInfoMasked: boolean;\n}\n\nexport function getCanvasProtectionStatus(enabled: boolean, noiseLevel: number): CanvasProtectionStatus {\n  if (enabled) {\n    return {\n      noiseInjected: true,\n      noiseLevel,\n      hashRandomized: true,\n      gpuInfoMasked: true,\n    };\n  }\n  return {\n    noiseInjected: false,\n    noiseLevel: 0,\n    hashRandomized: false,\n    gpuInfoMasked: false,\n  };\n}\n\nexport interface TimezoneProtectionStatus {\n  spoofed: boolean;\n  originalTimezone: string;\n  spoofedTimezone: string | null;\n  offsetMatch: boolean;\n  intlApiPatched: boolean;\n  dateApiPatched: boolean;\n}\n\nexport function getTimezoneProtectionStatus(\n  enabled: boolean,\n  serverFlag: string | null\n): TimezoneProtectionStatus {\n  const original = Intl.DateTimeFormat().resolvedOptions().timeZone;\n  if (enabled && serverFlag) {\n    const spoofed = getTimezoneForServer(serverFlag);\n    return {\n      spoofed: true,\n      originalTimezone: original,\n      spoofedTimezone: spoofed,\n      offsetMatch: true,\n      intlApiPatched: true,\n      dateApiPatched: true,\n    };\n  }\n  return {\n    spoofed: false,\n    originalTimezone: original,\n    spoofedTimezone: null,\n    offsetMatch: false,\n    intlApiPatched: false,\n    dateApiPatched: false,\n  };\n}\n\nexport interface ShieldSummary {\n  totalProtections: number;\n  activeProtections: number;\n  protectionLevel: 'none' | 'basic' | 'moderate' | 'maximum';\n  webrtc: WebRTCLeakStatus;\n  canvas: CanvasProtectionStatus;\n  timezone: TimezoneProtectionStatus;\n  userAgent: {\n    rotated: boolean;\n    profile: UserAgentProfile;\n    currentString: string | null;\n  };\n}\n\nexport function getShieldSummary(\n  state: FingerprintShieldState,\n  serverFlag: string | null\n): ShieldSummary {\n  const webrtc = getWebRTCLeakStatus(state.webrtcMask);\n  const canvas = getCanvasProtectionStatus(state.canvasNoise, state.canvasNoiseLevel);\n  const timezone = getTimezoneProtectionStatus(state.timezoneSpoofing, serverFlag);\n\n  const activeCount = [state.webrtcMask, state.timezoneSpoofing, state.canvasNoise, state.userAgentRotation].filter(Boolean).length;\n\n  let level: ShieldSummary['protectionLevel'] = 'none';\n  if (activeCount === 4) level = 'maximum';\n  else if (activeCount >= 2) level = 'moderate';\n  else if (activeCount >= 1) level = 'basic';\n\n  return {\n    totalProtections: 4,\n    activeProtections: activeCount,\n    protectionLevel: level,\n    webrtc,\n    canvas,\n    timezone,\n    userAgent: {\n      rotated: state.userAgentRotation,\n      profile: state.activeUserAgent,\n      currentString: state.currentUserAgentString,\n    },\n  };\n}\n","path":null,"size_bytes":10816,"size_tokens":null},"components/components/ErrorFallback.tsx":{"content":"import React, { useState } from \"react\";\nimport { reloadAppAsync } from \"expo\";\nimport {\n  StyleSheet,\n  View,\n  Pressable,\n  ScrollView,\n  Text,\n  Modal,\n  useColorScheme,\n  Platform,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Feather } from \"@expo/vector-icons\";\n\nexport type ErrorFallbackProps = {\n  error: Error;\n  resetError: () => void;\n};\n\nexport function ErrorFallback({ error, resetError }: ErrorFallbackProps) {\n  const colorScheme = useColorScheme();\n  const isDark = colorScheme === \"dark\";\n  const insets = useSafeAreaInsets();\n\n  const theme = {\n    background: isDark ? \"#000000\" : \"#FFFFFF\",\n    backgroundSecondary: isDark ? \"#1C1C1E\" : \"#F2F2F7\",\n    text: isDark ? \"#FFFFFF\" : \"#000000\",\n    textSecondary: isDark ? \"rgba(255, 255, 255, 0.7)\" : \"rgba(0, 0, 0, 0.7)\",\n    link: \"#007AFF\",\n    buttonText: \"#FFFFFF\",\n  };\n\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const handleRestart = async () => {\n    try {\n      await reloadAppAsync();\n    } catch (restartError) {\n      console.error(\"Failed to restart app:\", restartError);\n      resetError();\n    }\n  };\n\n  const formatErrorDetails = (): string => {\n    let details = `Error: ${error.message}\\n\\n`;\n    if (error.stack) {\n      details += `Stack Trace:\\n${error.stack}`;\n    }\n    return details;\n  };\n\n  const monoFont = Platform.select({\n    ios: \"Menlo\",\n    android: \"monospace\",\n    default: \"monospace\",\n  });\n\n  return (\n    <View style={[styles.container, { backgroundColor: theme.background }]}>\n      {__DEV__ ? (\n        <Pressable\n          onPress={() => setIsModalVisible(true)}\n          accessibilityLabel=\"View error details\"\n          accessibilityRole=\"button\"\n          style={({ pressed }) => [\n            styles.topButton,\n            {\n              top: insets.top + 16,\n              backgroundColor: theme.backgroundSecondary,\n              opacity: pressed ? 0.8 : 1,\n            },\n          ]}\n        >\n          <Feather name=\"alert-circle\" size={20} color={theme.text} />\n        </Pressable>\n      ) : null}\n\n      <View style={styles.content}>\n        <Text style={[styles.title, { color: theme.text }]}>\n          Something went wrong\n        </Text>\n\n        <Text style={[styles.message, { color: theme.textSecondary }]}>\n          Please reload the app to continue.\n        </Text>\n\n        <Pressable\n          onPress={handleRestart}\n          style={({ pressed }) => [\n            styles.button,\n            {\n              backgroundColor: theme.link,\n              opacity: pressed ? 0.9 : 1,\n              transform: [{ scale: pressed ? 0.98 : 1 }],\n            },\n          ]}\n        >\n          <Text style={[styles.buttonText, { color: theme.buttonText }]}>\n            Try Again\n          </Text>\n        </Pressable>\n      </View>\n\n      {__DEV__ ? (\n        <Modal\n          visible={isModalVisible}\n          animationType=\"slide\"\n          transparent={true}\n          onRequestClose={() => setIsModalVisible(false)}\n        >\n          <View style={styles.modalOverlay}>\n            <View\n              style={[\n                styles.modalContainer,\n                { backgroundColor: theme.background },\n              ]}\n            >\n              <View\n                style={[\n                  styles.modalHeader,\n                  {\n                    borderBottomColor: isDark\n                      ? \"rgba(255, 255, 255, 0.1)\"\n                      : \"rgba(0, 0, 0, 0.1)\",\n                  },\n                ]}\n              >\n                <Text style={[styles.modalTitle, { color: theme.text }]}>\n                  Error Details\n                </Text>\n                <Pressable\n                  onPress={() => setIsModalVisible(false)}\n                  accessibilityLabel=\"Close error details\"\n                  accessibilityRole=\"button\"\n                  style={({ pressed }) => [\n                    styles.closeButton,\n                    { opacity: pressed ? 0.6 : 1 },\n                  ]}\n                >\n                  <Feather name=\"x\" size={24} color={theme.text} />\n                </Pressable>\n              </View>\n\n              <ScrollView\n                style={styles.modalScrollView}\n                contentContainerStyle={[\n                  styles.modalScrollContent,\n                  { paddingBottom: insets.bottom + 16 },\n                ]}\n                showsVerticalScrollIndicator\n              >\n                <View\n                  style={[\n                    styles.errorContainer,\n                    { backgroundColor: theme.backgroundSecondary },\n                  ]}\n                >\n                  <Text\n                    style={[\n                      styles.errorText,\n                      {\n                        color: theme.text,\n                        fontFamily: monoFont,\n                      },\n                    ]}\n                    selectable\n                  >\n                    {formatErrorDetails()}\n                  </Text>\n                </View>\n              </ScrollView>\n            </View>\n          </View>\n        </Modal>\n      ) : null}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    padding: 24,\n  },\n  content: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: 16,\n    width: \"100%\",\n    maxWidth: 600,\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: \"700\",\n    textAlign: \"center\",\n    lineHeight: 40,\n  },\n  message: {\n    fontSize: 16,\n    textAlign: \"center\",\n    lineHeight: 24,\n  },\n  topButton: {\n    position: \"absolute\",\n    right: 16,\n    width: 44,\n    height: 44,\n    borderRadius: 8,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    zIndex: 10,\n  },\n  button: {\n    paddingVertical: 16,\n    borderRadius: 8,\n    paddingHorizontal: 24,\n    minWidth: 200,\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  buttonText: {\n    fontWeight: \"600\",\n    textAlign: \"center\",\n    fontSize: 16,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContainer: {\n    width: \"100%\",\n    height: \"90%\",\n    borderTopLeftRadius: 16,\n    borderTopRightRadius: 16,\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: 16,\n    paddingTop: 16,\n    paddingBottom: 12,\n    borderBottomWidth: 1,\n  },\n  modalTitle: {\n    fontSize: 20,\n    fontWeight: \"600\",\n  },\n  closeButton: {\n    width: 44,\n    height: 44,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  modalScrollView: {\n    flex: 1,\n  },\n  modalScrollContent: {\n    padding: 16,\n  },\n  errorContainer: {\n    width: \"100%\",\n    borderRadius: 8,\n    overflow: \"hidden\",\n    padding: 16,\n  },\n  errorText: {\n    fontSize: 12,\n    lineHeight: 18,\n    width: \"100%\",\n  },\n});\n","path":null,"size_bytes":7103,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, timestamp, integer, boolean } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const subscribers = pgTable(\"subscribers\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  email: text(\"email\").notNull(),\n  stripeCustomerId: text(\"stripe_customer_id\").notNull(),\n  stripeSubscriptionId: text(\"stripe_subscription_id\"),\n  planType: text(\"plan_type\").notNull(),\n  planName: text(\"plan_name\").notNull(),\n  amount: integer(\"amount\").notNull(),\n  currency: text(\"currency\").notNull().default(\"usd\"),\n  status: text(\"status\").notNull().default(\"active\"),\n  isActive: boolean(\"is_active\").notNull().default(true),\n  currentPeriodStart: timestamp(\"current_period_start\"),\n  currentPeriodEnd: timestamp(\"current_period_end\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const payments = pgTable(\"payments\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  subscriberId: varchar(\"subscriber_id\").references(() => subscribers.id),\n  stripePaymentIntentId: text(\"stripe_payment_intent_id\"),\n  amount: integer(\"amount\").notNull(),\n  currency: text(\"currency\").notNull().default(\"usd\"),\n  status: text(\"status\").notNull(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\nexport type Subscriber = typeof subscribers.$inferSelect;\nexport type Payment = typeof payments.$inferSelect;\n","path":null,"size_bytes":1986,"size_tokens":null},"components/components/StatRing.tsx":{"content":"import React from 'react';\nimport { View, Text, StyleSheet, Platform } from 'react-native';\nimport Svg, { Circle } from 'react-native-svg';\nimport Colors from '@/constants/colors';\n\ninterface StatRingProps {\n  value: number;\n  maxValue: number;\n  label: string;\n  unit: string;\n  color: string;\n  size?: number;\n}\n\nexport function StatRing({ value, maxValue, label, unit, color, size = 100 }: StatRingProps) {\n  const strokeWidth = 4;\n  const radius = (size - strokeWidth * 2) / 2;\n  const circumference = 2 * Math.PI * radius;\n  const progress = Math.min(value / maxValue, 1);\n  const strokeDashoffset = circumference * (1 - progress);\n\n  return (\n    <View style={[styles.container, { width: size, height: size }]}>\n      <Svg width={size} height={size} style={styles.svg}>\n        <Circle\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          stroke=\"rgba(255,255,255,0.06)\"\n          strokeWidth={strokeWidth}\n          fill=\"none\"\n        />\n        <Circle\n          cx={size / 2}\n          cy={size / 2}\n          r={radius}\n          stroke={color}\n          strokeWidth={strokeWidth}\n          fill=\"none\"\n          strokeDasharray={circumference}\n          strokeDashoffset={strokeDashoffset}\n          strokeLinecap=\"round\"\n          rotation=\"-90\"\n          origin={`${size / 2}, ${size / 2}`}\n        />\n      </Svg>\n      <View style={styles.labelContainer}>\n        <Text style={[styles.value, { color }]}>{value.toFixed(1)}</Text>\n        <Text style={styles.unit}>{unit}</Text>\n        <Text style={styles.label}>{label}</Text>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  svg: {\n    position: 'absolute',\n  },\n  labelContainer: {\n    alignItems: 'center',\n  },\n  value: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 16,\n  },\n  unit: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textSecondary,\n    marginTop: 1,\n  },\n  label: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 9,\n    color: Colors.dark.textMuted,\n    marginTop: 2,\n  },\n});\n","path":null,"size_bytes":2140,"size_tokens":null},"components/KeyboardAwareScrollViewCompat.tsx":{"content":"// template\nimport { Platform, ScrollView, ScrollViewProps } from \"react-native\";\nimport {\n  KeyboardAwareScrollView,\n  KeyboardAwareScrollViewProps,\n} from \"react-native-keyboard-controller\";\n\ntype Props = KeyboardAwareScrollViewProps & ScrollViewProps;\n\nexport function KeyboardAwareScrollViewCompat({\n  children,\n  keyboardShouldPersistTaps = \"handled\",\n  ...props\n}: Props) {\n  if (Platform.OS === \"web\") {\n    return (\n      <ScrollView keyboardShouldPersistTaps={keyboardShouldPersistTaps} {...props}>\n        {children}\n      </ScrollView>\n    );\n  }\n  return (\n    <KeyboardAwareScrollView\n      keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n      {...props}\n    >\n      {children}\n    </KeyboardAwareScrollView>\n  );\n}\n","path":null,"size_bytes":736,"size_tokens":null},"constants/colors.ts":{"content":"const Colors = {\n  dark: {\n    background: '#0F0F0F',\n    backgroundSecondary: '#1A1A1A',\n    backgroundTertiary: '#121212',\n    surface: 'rgba(255,255,255,0.05)',\n    surfaceBorder: 'rgba(255,255,255,0.1)',\n    surfaceBorderLight: 'rgba(255,255,255,0.06)',\n    accent: '#00F0FF',\n    accentPurple: '#C300FF',\n    accentCoral: '#FF2E63',\n    text: '#FFFFFF',\n    textSecondary: '#B0B0B0',\n    textMuted: '#666666',\n    success: '#00E676',\n    warning: '#FFB300',\n    danger: '#FF2E63',\n    tabIconDefault: '#666666',\n    tint: '#00F0FF',\n    tabIconSelected: '#00F0FF',\n    gradientStart: '#0F0F0F',\n    gradientMidPurple: '#1A0033',\n    gradientMidNavy: '#001F3F',\n    glowCyan: 'rgba(0, 240, 255, 0.3)',\n    glowPurple: 'rgba(195, 0, 255, 0.3)',\n    glowCoral: 'rgba(255, 46, 99, 0.2)',\n  },\n};\n\nexport default Colors;\n","path":null,"size_bytes":821,"size_tokens":null},"components/components/GlassCard.tsx":{"content":"import React from 'react';\nimport { View, StyleSheet, ViewStyle, Platform } from 'react-native';\nimport Colors from '@/constants/colors';\n\ninterface GlassCardProps {\n  children: React.ReactNode;\n  style?: ViewStyle;\n  intensity?: 'low' | 'medium' | 'high';\n  glowColor?: string;\n}\n\nexport function GlassCard({ children, style, intensity = 'medium', glowColor }: GlassCardProps) {\n  const bgOpacity = intensity === 'low' ? 0.03 : intensity === 'medium' ? 0.06 : 0.1;\n\n  return (\n    <View\n      style={[\n        styles.card,\n        {\n          backgroundColor: `rgba(255,255,255,${bgOpacity})`,\n          ...(glowColor ? { shadowColor: glowColor, shadowOpacity: 0.25, shadowRadius: 20, shadowOffset: { width: 0, height: 0 } } : {}),\n        },\n        style,\n      ]}\n    >\n      {children}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    borderRadius: 20,\n    borderWidth: 2,\n    borderColor: 'rgba(255,255,255,0.2)',\n    overflow: 'hidden',\n    ...(Platform.OS === 'web' ? {\n      // @ts-ignore\n      backdropFilter: 'blur(40px)',\n      WebkitBackdropFilter: 'blur(40px)',\n    } : {}),\n  },\n});\n","path":null,"size_bytes":1118,"size_tokens":null},"components/components/LeakStatusIndicators.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withTiming,\n  withDelay,\n  withRepeat,\n  Easing,\n} from 'react-native-reanimated';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { GlassCard } from '@/components/GlassCard';\nimport Colors from '@/constants/colors';\n\ninterface LeakStatusIndicatorsProps {\n  isConnected: boolean;\n}\n\nfunction StatusIndicator({ label, icon, iconLib, secure, delay, isConnected }: {\n  label: string;\n  icon: string;\n  iconLib: 'ion' | 'mci';\n  secure: boolean;\n  delay: number;\n  isConnected: boolean;\n}) {\n  const progress = useSharedValue(0);\n  const pulseScale = useSharedValue(1);\n\n  useEffect(() => {\n    if (isConnected && secure) {\n      progress.value = withDelay(delay, withTiming(1, { duration: 600 }));\n      pulseScale.value = withDelay(\n        delay + 600,\n        withRepeat(withTiming(1.15, { duration: 2000, easing: Easing.inOut(Easing.ease) }), -1, true)\n      );\n    } else if (!isConnected) {\n      progress.value = withTiming(0, { duration: 400 });\n      pulseScale.value = withTiming(1);\n    }\n  }, [isConnected, secure]);\n\n  const barStyle = useAnimatedStyle(() => ({\n    width: `${progress.value * 100}%` as any,\n  }));\n\n  const dotStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: isConnected ? pulseScale.value : 1 }],\n  }));\n\n  const statusColor = !isConnected\n    ? Colors.dark.textMuted\n    : secure\n    ? Colors.dark.success\n    : Colors.dark.danger;\n\n  const statusText = !isConnected ? 'Inactive' : secure ? 'Protected' : 'Exposed';\n\n  return (\n    <View style={indicatorStyles.container}>\n      <View style={indicatorStyles.headerRow}>\n        <View style={indicatorStyles.left}>\n          <View style={[indicatorStyles.iconWrap, { backgroundColor: `${statusColor}15` }]}>\n            {iconLib === 'mci' ? (\n              <MaterialCommunityIcons name={icon as any} size={14} color={statusColor} />\n            ) : (\n              <Ionicons name={icon as any} size={14} color={statusColor} />\n            )}\n          </View>\n          <Text style={indicatorStyles.label}>{label}</Text>\n        </View>\n        <View style={indicatorStyles.statusRow}>\n          <Animated.View style={[indicatorStyles.dot, { backgroundColor: statusColor }, dotStyle]} />\n          <Text style={[indicatorStyles.statusText, { color: statusColor }]}>{statusText}</Text>\n        </View>\n      </View>\n      <View style={indicatorStyles.track}>\n        <Animated.View style={[indicatorStyles.fill, { backgroundColor: statusColor }, barStyle]} />\n      </View>\n    </View>\n  );\n}\n\nconst indicatorStyles = StyleSheet.create({\n  container: {\n    gap: 6,\n  },\n  headerRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  left: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  iconWrap: {\n    width: 26,\n    height: 26,\n    borderRadius: 7,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  label: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 11,\n    color: '#FFFFFF',\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  statusRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 5,\n  },\n  dot: {\n    width: 5,\n    height: 5,\n    borderRadius: 2.5,\n  },\n  statusText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    letterSpacing: 1,\n  },\n  track: {\n    height: 2,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    borderRadius: 1,\n    overflow: 'hidden',\n    marginLeft: 34,\n  },\n  fill: {\n    height: '100%',\n    borderRadius: 1,\n  },\n});\n\nexport function LeakStatusIndicators({ isConnected }: LeakStatusIndicatorsProps) {\n  return (\n    <GlassCard style={styles.card} intensity=\"low\" glowColor={isConnected ? 'rgba(0,230,118,0.15)' : undefined}>\n      <View style={styles.header}>\n        <Ionicons name=\"shield-checkmark-outline\" size={16} color={isConnected ? Colors.dark.success : Colors.dark.textMuted} />\n        <Text style={styles.title}>LEAK PROTECTION</Text>\n      </View>\n      <View style={styles.indicators}>\n        <StatusIndicator\n          label=\"DNS Leak\"\n          icon=\"server-outline\"\n          iconLib=\"ion\"\n          secure={isConnected}\n          delay={200}\n          isConnected={isConnected}\n        />\n        <View style={styles.divider} />\n        <StatusIndicator\n          label=\"WebRTC Leak\"\n          icon=\"videocam-outline\"\n          iconLib=\"ion\"\n          secure={isConnected}\n          delay={500}\n          isConnected={isConnected}\n        />\n        <View style={styles.divider} />\n        <StatusIndicator\n          label=\"IPv6 Leak\"\n          icon=\"git-network-outline\"\n          iconLib=\"ion\"\n          secure={true}\n          delay={800}\n          isConnected={isConnected}\n        />\n      </View>\n    </GlassCard>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    marginHorizontal: 20,\n    padding: 16,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n    marginBottom: 14,\n  },\n  title: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 10,\n    color: Colors.dark.accent,\n    letterSpacing: 3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  indicators: {\n    gap: 10,\n  },\n  divider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n  },\n});\n","path":null,"size_bytes":5532,"size_tokens":null},"metro.config.js":{"content":"const { getDefaultConfig } = require(\"expo/metro-config\");\n\nconst config = getDefaultConfig(__dirname);\n\nmodule.exports = config;\n","path":null,"size_bytes":130,"size_tokens":null},"components/LeakStatusIndicators.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withTiming,\n  withDelay,\n  withRepeat,\n  Easing,\n} from 'react-native-reanimated';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { GlassCard } from '@/components/GlassCard';\nimport Colors from '@/constants/colors';\n\ninterface LeakStatusIndicatorsProps {\n  isConnected: boolean;\n}\n\nfunction StatusIndicator({ label, icon, iconLib, secure, delay, isConnected }: {\n  label: string;\n  icon: string;\n  iconLib: 'ion' | 'mci';\n  secure: boolean;\n  delay: number;\n  isConnected: boolean;\n}) {\n  const progress = useSharedValue(0);\n  const pulseScale = useSharedValue(1);\n\n  useEffect(() => {\n    if (isConnected && secure) {\n      progress.value = withDelay(delay, withTiming(1, { duration: 600 }));\n      pulseScale.value = withDelay(\n        delay + 600,\n        withRepeat(withTiming(1.15, { duration: 2000, easing: Easing.inOut(Easing.ease) }), -1, true)\n      );\n    } else if (!isConnected) {\n      progress.value = withTiming(0, { duration: 400 });\n      pulseScale.value = withTiming(1);\n    }\n  }, [isConnected, secure]);\n\n  const barStyle = useAnimatedStyle(() => ({\n    width: `${progress.value * 100}%` as any,\n  }));\n\n  const dotStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: isConnected ? pulseScale.value : 1 }],\n  }));\n\n  const statusColor = !isConnected\n    ? Colors.dark.textMuted\n    : secure\n    ? Colors.dark.success\n    : Colors.dark.danger;\n\n  const statusText = !isConnected ? 'Inactive' : secure ? 'Protected' : 'Exposed';\n\n  return (\n    <View style={indicatorStyles.container}>\n      <View style={indicatorStyles.headerRow}>\n        <View style={indicatorStyles.left}>\n          <View style={[indicatorStyles.iconWrap, { backgroundColor: `${statusColor}15` }]}>\n            {iconLib === 'mci' ? (\n              <MaterialCommunityIcons name={icon as any} size={14} color={statusColor} />\n            ) : (\n              <Ionicons name={icon as any} size={14} color={statusColor} />\n            )}\n          </View>\n          <Text style={indicatorStyles.label}>{label}</Text>\n        </View>\n        <View style={indicatorStyles.statusRow}>\n          <Animated.View style={[indicatorStyles.dot, { backgroundColor: statusColor }, dotStyle]} />\n          <Text style={[indicatorStyles.statusText, { color: statusColor }]}>{statusText}</Text>\n        </View>\n      </View>\n      <View style={indicatorStyles.track}>\n        <Animated.View style={[indicatorStyles.fill, { backgroundColor: statusColor }, barStyle]} />\n      </View>\n    </View>\n  );\n}\n\nconst indicatorStyles = StyleSheet.create({\n  container: {\n    gap: 6,\n  },\n  headerRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  left: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  iconWrap: {\n    width: 26,\n    height: 26,\n    borderRadius: 7,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  label: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 11,\n    color: '#FFFFFF',\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  statusRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 5,\n  },\n  dot: {\n    width: 5,\n    height: 5,\n    borderRadius: 2.5,\n  },\n  statusText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    letterSpacing: 1,\n  },\n  track: {\n    height: 2,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    borderRadius: 1,\n    overflow: 'hidden',\n    marginLeft: 34,\n  },\n  fill: {\n    height: '100%',\n    borderRadius: 1,\n  },\n});\n\nexport function LeakStatusIndicators({ isConnected }: LeakStatusIndicatorsProps) {\n  return (\n    <GlassCard style={styles.card} intensity=\"low\" glowColor={isConnected ? 'rgba(0,230,118,0.15)' : undefined}>\n      <View style={styles.header}>\n        <Ionicons name=\"shield-checkmark-outline\" size={16} color={isConnected ? Colors.dark.success : Colors.dark.textMuted} />\n        <Text style={styles.title}>LEAK PROTECTION</Text>\n      </View>\n      <View style={styles.indicators}>\n        <StatusIndicator\n          label=\"DNS Leak\"\n          icon=\"server-outline\"\n          iconLib=\"ion\"\n          secure={isConnected}\n          delay={200}\n          isConnected={isConnected}\n        />\n        <View style={styles.divider} />\n        <StatusIndicator\n          label=\"WebRTC Leak\"\n          icon=\"videocam-outline\"\n          iconLib=\"ion\"\n          secure={isConnected}\n          delay={500}\n          isConnected={isConnected}\n        />\n        <View style={styles.divider} />\n        <StatusIndicator\n          label=\"IPv6 Leak\"\n          icon=\"git-network-outline\"\n          iconLib=\"ion\"\n          secure={true}\n          delay={800}\n          isConnected={isConnected}\n        />\n      </View>\n    </GlassCard>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    marginHorizontal: 20,\n    padding: 16,\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n    marginBottom: 14,\n  },\n  title: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 10,\n    color: Colors.dark.accent,\n    letterSpacing: 3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  indicators: {\n    gap: 10,\n  },\n  divider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n  },\n});\n","path":null,"size_bytes":5532,"size_tokens":null},"server/server/index.ts":{"content":"import express from \"express\";\nimport type { Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n\nconst app = express();\nconst log = console.log;\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\nfunction setupCors(app: express.Application) {\n  app.use((req, res, next) => {\n    const origins = new Set<string>();\n\n    if (process.env.REPLIT_DEV_DOMAIN) {\n      origins.add(`https://${process.env.REPLIT_DEV_DOMAIN}`);\n    }\n\n    if (process.env.REPLIT_DOMAINS) {\n      process.env.REPLIT_DOMAINS.split(\",\").forEach((d) => {\n        origins.add(`https://${d.trim()}`);\n      });\n    }\n\n    const origin = req.header(\"origin\");\n\n    // Allow localhost origins for Expo web development (any port)\n    const isLocalhost =\n      origin?.startsWith(\"http://localhost:\") ||\n      origin?.startsWith(\"http://127.0.0.1:\");\n\n    if (origin && (origins.has(origin) || isLocalhost)) {\n      res.header(\"Access-Control-Allow-Origin\", origin);\n      res.header(\n        \"Access-Control-Allow-Methods\",\n        \"GET, POST, PUT, DELETE, OPTIONS\",\n      );\n      res.header(\"Access-Control-Allow-Headers\", \"Content-Type\");\n      res.header(\"Access-Control-Allow-Credentials\", \"true\");\n    }\n\n    if (req.method === \"OPTIONS\") {\n      return res.sendStatus(200);\n    }\n\n    next();\n  });\n}\n\nfunction setupBodyParsing(app: express.Application) {\n  app.use(\n    express.json({\n      verify: (req, _res, buf) => {\n        req.rawBody = buf;\n      },\n    }),\n  );\n\n  app.use(express.urlencoded({ extended: false }));\n}\n\nfunction setupRequestLogging(app: express.Application) {\n  app.use((req, res, next) => {\n    const start = Date.now();\n    const path = req.path;\n    let capturedJsonResponse: Record<string, unknown> | undefined = undefined;\n\n    const originalResJson = res.json;\n    res.json = function (bodyJson, ...args) {\n      capturedJsonResponse = bodyJson;\n      return originalResJson.apply(res, [bodyJson, ...args]);\n    };\n\n    res.on(\"finish\", () => {\n      if (!path.startsWith(\"/api\")) return;\n\n      const duration = Date.now() - start;\n\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"\";\n      }\n\n      log(logLine);\n    });\n\n    next();\n  });\n}\n\nfunction getAppName(): string {\n  try {\n    const appJsonPath = path.resolve(process.cwd(), \"app.json\");\n    const appJsonContent = fs.readFileSync(appJsonPath, \"utf-8\");\n    const appJson = JSON.parse(appJsonContent);\n    return appJson.expo?.name || \"App Landing Page\";\n  } catch {\n    return \"App Landing Page\";\n  }\n}\n\nfunction serveExpoManifest(platform: string, res: Response) {\n  const manifestPath = path.resolve(\n    process.cwd(),\n    \"static-build\",\n    platform,\n    \"manifest.json\",\n  );\n\n  if (!fs.existsSync(manifestPath)) {\n    return res\n      .status(404)\n      .json({ error: `Manifest not found for platform: ${platform}` });\n  }\n\n  res.setHeader(\"expo-protocol-version\", \"1\");\n  res.setHeader(\"expo-sfv-version\", \"0\");\n  res.setHeader(\"content-type\", \"application/json\");\n\n  const manifest = fs.readFileSync(manifestPath, \"utf-8\");\n  res.send(manifest);\n}\n\nfunction serveLandingPage({\n  req,\n  res,\n  landingPageTemplate,\n  appName,\n}: {\n  req: Request;\n  res: Response;\n  landingPageTemplate: string;\n  appName: string;\n}) {\n  const forwardedProto = req.header(\"x-forwarded-proto\");\n  const protocol = forwardedProto || req.protocol || \"https\";\n  const forwardedHost = req.header(\"x-forwarded-host\");\n  const host = forwardedHost || req.get(\"host\");\n  const baseUrl = `${protocol}://${host}`;\n  const expsUrl = `${host}`;\n\n  log(`baseUrl`, baseUrl);\n  log(`expsUrl`, expsUrl);\n\n  const html = landingPageTemplate\n    .replace(/BASE_URL_PLACEHOLDER/g, baseUrl)\n    .replace(/EXPS_URL_PLACEHOLDER/g, expsUrl)\n    .replace(/APP_NAME_PLACEHOLDER/g, appName);\n\n  res.setHeader(\"Content-Type\", \"text/html; charset=utf-8\");\n  res.status(200).send(html);\n}\n\nfunction configureExpoAndLanding(app: express.Application) {\n  const templatePath = path.resolve(\n    process.cwd(),\n    \"server\",\n    \"templates\",\n    \"landing-page.html\",\n  );\n  const landingPageTemplate = fs.readFileSync(templatePath, \"utf-8\");\n  const appName = getAppName();\n\n  log(\"Serving static Expo files with dynamic manifest routing\");\n\n  app.use((req: Request, res: Response, next: NextFunction) => {\n    if (req.path.startsWith(\"/api\")) {\n      return next();\n    }\n\n    if (req.path !== \"/\" && req.path !== \"/manifest\") {\n      return next();\n    }\n\n    const platform = req.header(\"expo-platform\");\n    if (platform && (platform === \"ios\" || platform === \"android\")) {\n      return serveExpoManifest(platform, res);\n    }\n\n    if (req.path === \"/\") {\n      return serveLandingPage({\n        req,\n        res,\n        landingPageTemplate,\n        appName,\n      });\n    }\n\n    next();\n  });\n\n  app.use(\"/assets\", express.static(path.resolve(process.cwd(), \"assets\")));\n  app.use(express.static(path.resolve(process.cwd(), \"static-build\")));\n\n  log(\"Expo routing: Checking expo-platform header on / and /manifest\");\n}\n\nfunction setupErrorHandler(app: express.Application) {\n  app.use((err: unknown, _req: Request, res: Response, next: NextFunction) => {\n    const error = err as {\n      status?: number;\n      statusCode?: number;\n      message?: string;\n    };\n\n    const status = error.status || error.statusCode || 500;\n    const message = error.message || \"Internal Server Error\";\n\n    console.error(\"Internal Server Error:\", err);\n\n    if (res.headersSent) {\n      return next(err);\n    }\n\n    return res.status(status).json({ message });\n  });\n}\n\n(async () => {\n  setupCors(app);\n  setupBodyParsing(app);\n  setupRequestLogging(app);\n\n  configureExpoAndLanding(app);\n\n  const server = await registerRoutes(app);\n\n  setupErrorHandler(app);\n\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  server.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`express server serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":6253,"size_tokens":null},"eslint.config.js":{"content":"const { defineConfig } = require('eslint/config');\nconst expoConfig = require('eslint-config-expo/flat');\n\nmodule.exports = defineConfig([\n  expoConfig,\n  {\n    ignores: [\"dist/*\"],\n  }\n]);\n","path":null,"size_bytes":190,"size_tokens":null},"components/PowerButton.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, Pressable, StyleSheet, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withRepeat,\n  withTiming,\n  withSpring,\n  withSequence,\n  withDelay,\n  Easing,\n  interpolateColor,\n  interpolate,\n} from 'react-native-reanimated';\nimport Svg, { Circle, Defs, RadialGradient, Stop } from 'react-native-svg';\nimport { MaterialCommunityIcons, Ionicons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport Colors from '@/constants/colors';\n\nconst BUTTON_SIZE = 150;\nconst INNER_RING = BUTTON_SIZE + 20;\nconst MIDDLE_RING = BUTTON_SIZE + 44;\nconst OUTER_RING = BUTTON_SIZE + 70;\nconst ENERGY_RING = BUTTON_SIZE + 58;\n\ninterface PowerButtonProps {\n  isConnected: boolean;\n  isConnecting: boolean;\n  isProtecting?: boolean;\n  onPress: () => void;\n}\n\nfunction EnergyArc({ size, color, dashArray, rotation }: { size: number; color: string; dashArray: string; rotation: number }) {\n  const r = (size - 4) / 2;\n  return (\n    <Svg width={size} height={size} style={[StyleSheet.absoluteFill, { transform: [{ rotate: `${rotation}deg` }] }]}>\n      <Circle\n        cx={size / 2}\n        cy={size / 2}\n        r={r}\n        stroke={color}\n        strokeWidth={2}\n        fill=\"none\"\n        strokeDasharray={dashArray}\n        strokeLinecap=\"round\"\n        opacity={0.7}\n      />\n    </Svg>\n  );\n}\n\nexport function PowerButton({ isConnected, isConnecting, isProtecting = false, onPress }: PowerButtonProps) {\n  const pulse = useSharedValue(1);\n  const cyanPulse = useSharedValue(0.3);\n  const rotation = useSharedValue(0);\n  const rotation2 = useSharedValue(0);\n  const scale = useSharedValue(1);\n  const colorProgress = useSharedValue(0);\n  const glowOpacity = useSharedValue(0);\n  const shieldBadgeScale = useSharedValue(0);\n  const energyRingOpacity = useSharedValue(0);\n\n  useEffect(() => {\n    if (isProtecting) {\n      rotation.value = withRepeat(withTiming(360, { duration: 4000, easing: Easing.linear }), -1, false);\n      rotation2.value = withTiming(0, { duration: 500 });\n      pulse.value = withRepeat(withTiming(1.04, { duration: 1200, easing: Easing.inOut(Easing.ease) }), -1, true);\n      colorProgress.value = withTiming(0.75, { duration: 600 });\n      glowOpacity.value = withRepeat(withTiming(0.5, { duration: 1000 }), -1, true);\n      cyanPulse.value = withTiming(0);\n      energyRingOpacity.value = withTiming(0.5, { duration: 300 });\n      shieldBadgeScale.value = withTiming(0, { duration: 200 });\n    } else if (isConnecting) {\n      cyanPulse.value = withTiming(0);\n      rotation.value = withRepeat(withTiming(360, { duration: 2500, easing: Easing.linear }), -1, false);\n      rotation2.value = withRepeat(withTiming(-360, { duration: 1800, easing: Easing.linear }), -1, false);\n      pulse.value = withRepeat(withTiming(1.06, { duration: 600, easing: Easing.inOut(Easing.ease) }), -1, true);\n      colorProgress.value = withRepeat(withTiming(0.5, { duration: 800 }), -1, true);\n      glowOpacity.value = withRepeat(withTiming(0.6, { duration: 600 }), -1, true);\n      energyRingOpacity.value = withTiming(1, { duration: 300 });\n      shieldBadgeScale.value = withTiming(0, { duration: 200 });\n    } else if (isConnected) {\n      rotation.value = withTiming(rotation.value % 360);\n      rotation2.value = withTiming(0);\n      pulse.value = withRepeat(withTiming(1.02, { duration: 4000, easing: Easing.inOut(Easing.ease) }), -1, true);\n      colorProgress.value = withTiming(1, { duration: 600 });\n      glowOpacity.value = withTiming(0.5, { duration: 800 });\n      cyanPulse.value = withTiming(0);\n      energyRingOpacity.value = withTiming(0, { duration: 500 });\n      shieldBadgeScale.value = withDelay(300, withSpring(1, { damping: 12, stiffness: 150 }));\n    } else {\n      rotation.value = withTiming(0, { duration: 500 });\n      rotation2.value = withTiming(0, { duration: 500 });\n      pulse.value = withTiming(1, { duration: 500 });\n      colorProgress.value = withTiming(0, { duration: 500 });\n      glowOpacity.value = withTiming(0, { duration: 500 });\n      energyRingOpacity.value = withTiming(0, { duration: 300 });\n      shieldBadgeScale.value = withTiming(0, { duration: 200 });\n      cyanPulse.value = withRepeat(withTiming(0.8, { duration: 2500, easing: Easing.inOut(Easing.ease) }), -1, true);\n    }\n  }, [isConnected, isConnecting, isProtecting]);\n\n  const outerGlowStyle = useAnimatedStyle(() => ({\n    opacity: interpolate(colorProgress.value, [0, 0.5, 0.75, 1], [0, 0.3, 0.4, 0.5]),\n    transform: [{ scale: pulse.value }],\n    backgroundColor: interpolateColor(colorProgress.value, [0, 0.5, 0.75, 1], ['rgba(0,240,255,0)', 'rgba(195,0,255,0.08)', 'rgba(255,179,0,0.08)', 'rgba(0,230,118,0.06)']),\n    shadowColor: interpolateColor(colorProgress.value, [0, 0.5, 0.75, 1], ['#00F0FF', '#C300FF', '#FFB300', '#00E676']),\n    shadowOpacity: glowOpacity.value,\n  }));\n\n  const cyanPulseStyle = useAnimatedStyle(() => ({\n    opacity: cyanPulse.value,\n    transform: [{ scale: interpolate(cyanPulse.value, [0.3, 0.8], [1, 1.15]) }],\n  }));\n\n  const energyRing1Style = useAnimatedStyle(() => ({\n    opacity: energyRingOpacity.value,\n    transform: [{ rotate: `${rotation.value}deg` }],\n  }));\n\n  const energyRing2Style = useAnimatedStyle(() => ({\n    opacity: interpolate(energyRingOpacity.value, [0, 1], [0, 0.6]),\n    transform: [{ rotate: `${rotation2.value}deg` }],\n  }));\n\n  const middleRingStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: pulse.value }],\n    borderColor: interpolateColor(colorProgress.value, [0, 0.5, 0.75, 1], ['rgba(255,255,255,0.05)', 'rgba(195,0,255,0.3)', 'rgba(255,179,0,0.3)', 'rgba(0,230,118,0.25)']),\n  }));\n\n  const buttonStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n    backgroundColor: interpolateColor(colorProgress.value, [0, 0.5, 0.75, 1], ['rgba(255,255,255,0.04)', 'rgba(195,0,255,0.06)', 'rgba(255,179,0,0.06)', 'rgba(0,230,118,0.06)']),\n    borderColor: interpolateColor(colorProgress.value, [0, 0.5, 0.75, 1], ['rgba(0,240,255,0.15)', 'rgba(195,0,255,0.5)', 'rgba(255,179,0,0.4)', 'rgba(0,230,118,0.4)']),\n  }));\n\n  const shieldBadgeStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: shieldBadgeScale.value }],\n    opacity: shieldBadgeScale.value,\n  }));\n\n  const handlePress = () => {\n    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);\n    scale.value = withSequence(\n      withSpring(0.9, { damping: 10, stiffness: 300 }),\n      withSpring(1, { damping: 8, stiffness: 150 })\n    );\n    onPress();\n  };\n\n  const iconColor = isConnected ? '#00E676' : isProtecting ? '#FFB300' : isConnecting ? Colors.dark.accentPurple : Colors.dark.accent;\n\n  return (\n    <View style={styles.container}>\n      <Animated.View style={[styles.outerGlow, outerGlowStyle]} />\n\n      {!isConnected && !isConnecting && (\n        <Animated.View style={[styles.cyanPulseRing, cyanPulseStyle]} />\n      )}\n\n      <Animated.View style={[styles.energyRingContainer, energyRing1Style]}>\n        <EnergyArc size={ENERGY_RING} color={Colors.dark.accentPurple} dashArray=\"30 20 60 15\" rotation={0} />\n      </Animated.View>\n      <Animated.View style={[styles.energyRingContainer, energyRing2Style]}>\n        <EnergyArc size={ENERGY_RING - 10} color={Colors.dark.accent} dashArray=\"20 40 10 30\" rotation={45} />\n      </Animated.View>\n\n      <Animated.View style={[styles.middleRing, middleRingStyle]} />\n\n      <Pressable onPress={handlePress}>\n        <Animated.View style={[styles.button, buttonStyle]}>\n          <MaterialCommunityIcons name=\"power\" size={52} color={iconColor} />\n        </Animated.View>\n      </Pressable>\n\n      <Animated.View style={[styles.shieldBadge, shieldBadgeStyle]}>\n        <View style={styles.shieldBadgeInner}>\n          <Ionicons name=\"shield-checkmark\" size={12} color=\"#00E676\" />\n          <Text style={styles.shieldBadgeText}>PROTECTED</Text>\n        </View>\n      </Animated.View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    width: OUTER_RING + 20,\n    height: OUTER_RING + 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  outerGlow: {\n    position: 'absolute',\n    width: OUTER_RING,\n    height: OUTER_RING,\n    borderRadius: OUTER_RING / 2,\n    shadowOffset: { width: 0, height: 0 },\n    shadowRadius: 40,\n    elevation: 10,\n  },\n  cyanPulseRing: {\n    position: 'absolute',\n    width: MIDDLE_RING + 8,\n    height: MIDDLE_RING + 8,\n    borderRadius: (MIDDLE_RING + 8) / 2,\n    borderWidth: 1,\n    borderColor: 'rgba(0, 240, 255, 0.2)',\n  },\n  energyRingContainer: {\n    position: 'absolute',\n    width: ENERGY_RING,\n    height: ENERGY_RING,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  middleRing: {\n    position: 'absolute',\n    width: INNER_RING,\n    height: INNER_RING,\n    borderRadius: INNER_RING / 2,\n    borderWidth: 1,\n  },\n  button: {\n    width: BUTTON_SIZE,\n    height: BUTTON_SIZE,\n    borderRadius: BUTTON_SIZE / 2,\n    borderWidth: 1.5,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  shieldBadge: {\n    position: 'absolute',\n    bottom: 8,\n  },\n  shieldBadgeInner: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n    backgroundColor: 'rgba(0, 230, 118, 0.1)',\n    borderWidth: 1,\n    borderColor: 'rgba(0, 230, 118, 0.25)',\n    paddingHorizontal: 10,\n    paddingVertical: 4,\n    borderRadius: 12,\n  },\n  shieldBadgeText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: '#00E676',\n    letterSpacing: 2,\n  },\n});\n","path":null,"size_bytes":9497,"size_tokens":null},"lib/query-client.ts":{"content":"import { fetch } from \"expo/fetch\";\nimport { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\n/**\n * Gets the base URL for the Express API server (e.g., \"http://localhost:3000\")\n * @returns {string} The API base URL\n */\nexport function getApiUrl(): string {\n  let host = process.env.EXPO_PUBLIC_DOMAIN;\n\n  if (!host) {\n    throw new Error(\"EXPO_PUBLIC_DOMAIN is not set\");\n  }\n\n  let url = new URL(`https://${host}`);\n\n  return url.href;\n}\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  route: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const baseUrl = getApiUrl();\n  const url = new URL(route, baseUrl);\n\n  const res = await fetch(url.toString(), {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const baseUrl = getApiUrl();\n    const url = new URL(queryKey.join(\"/\") as string, baseUrl);\n\n    const res = await fetch(url.toString(), {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1934,"size_tokens":null},"app/+not-found.tsx":{"content":"// template\nimport { Link, Stack } from \"expo-router\";\nimport { StyleSheet, Text, View } from \"react-native\";\n\nexport default function NotFoundScreen() {\n  return (\n    <>\n      <Stack.Screen options={{ title: \"Oops!\" }} />\n      <View style={styles.container}>\n        <Text style={styles.title}>This screen doesn&apos;t exist.</Text>\n\n        <Link href=\"/\" style={styles.link}>\n          <Text style={styles.linkText}>Go to home screen!</Text>\n        </Link>\n      </View>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: 20,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: \"bold\",\n  },\n  link: {\n    marginTop: 15,\n    paddingVertical: 15,\n  },\n  linkText: {\n    fontSize: 14,\n    color: \"#2e78b7\",\n  },\n});\n","path":null,"size_bytes":814,"size_tokens":null},"lib/lib/query-client.ts":{"content":"import { fetch } from \"expo/fetch\";\nimport { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\n/**\n * Gets the base URL for the Express API server (e.g., \"http://localhost:3000\")\n * @returns {string} The API base URL\n */\nexport function getApiUrl(): string {\n  let host = process.env.EXPO_PUBLIC_DOMAIN;\n\n  if (!host) {\n    throw new Error(\"EXPO_PUBLIC_DOMAIN is not set\");\n  }\n\n  let url = new URL(`https://${host}`);\n\n  return url.href;\n}\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  route: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const baseUrl = getApiUrl();\n  const url = new URL(route, baseUrl);\n\n  const res = await fetch(url.toString(), {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const baseUrl = getApiUrl();\n    const url = new URL(queryKey.join(\"/\") as string, baseUrl);\n\n    const res = await fetch(url.toString(), {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1934,"size_tokens":null},"components/LiveTelemetry.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withRepeat,\n  withTiming,\n  Easing,\n  interpolate,\n} from 'react-native-reanimated';\nimport { Ionicons } from '@expo/vector-icons';\nimport { GlassCard } from '@/components/GlassCard';\nimport Colors from '@/constants/colors';\n\ninterface LiveTelemetryProps {\n  isConnected: boolean;\n  downloadSpeed: number;\n  uploadSpeed: number;\n  sessionDuration: number;\n  ping: number;\n  dataUsed: number;\n}\n\nfunction formatDuration(seconds: number): string {\n  const h = Math.floor(seconds / 3600);\n  const m = Math.floor((seconds % 3600) / 60);\n  const s = seconds % 60;\n  return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\n}\n\nfunction AnimatedBar({ value, maxValue, color }: { value: number; maxValue: number; color: string }) {\n  const barPulse = useSharedValue(0.6);\n\n  useEffect(() => {\n    if (value > 0) {\n      barPulse.value = withRepeat(withTiming(1, { duration: 800, easing: Easing.inOut(Easing.ease) }), -1, true);\n    } else {\n      barPulse.value = withTiming(0.3);\n    }\n  }, [value > 0]);\n\n  const barStyle = useAnimatedStyle(() => ({\n    opacity: barPulse.value,\n  }));\n\n  const progress = Math.min(value / maxValue, 1);\n  const barCount = 12;\n  const activeBars = Math.round(progress * barCount);\n\n  return (\n    <View style={barStyles.container}>\n      {Array.from({ length: barCount }).map((_, i) => (\n        <Animated.View\n          key={i}\n          style={[\n            barStyles.bar,\n            {\n              backgroundColor: i < activeBars ? color : 'rgba(255,255,255,0.06)',\n              height: 4 + (i * 1.5),\n            },\n            i < activeBars ? barStyle : undefined,\n          ]}\n        />\n      ))}\n    </View>\n  );\n}\n\nconst barStyles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'flex-end',\n    gap: 2,\n    height: 24,\n  },\n  bar: {\n    width: 3,\n    borderRadius: 1.5,\n    minHeight: 4,\n  },\n});\n\nfunction TelemetryCard({ icon, iconColor, label, value, unit, barValue, barMax, barColor }: {\n  icon: string;\n  iconColor: string;\n  label: string;\n  value: string;\n  unit: string;\n  barValue: number;\n  barMax: number;\n  barColor: string;\n}) {\n  return (\n    <GlassCard style={telStyles.card} intensity=\"low\">\n      <View style={telStyles.topRow}>\n        <View style={telStyles.iconWrap}>\n          <Ionicons name={icon as any} size={14} color={iconColor} />\n        </View>\n        <AnimatedBar value={barValue} maxValue={barMax} color={barColor} />\n      </View>\n      <View style={telStyles.valueRow}>\n        <Text style={[telStyles.value, { color: iconColor }]}>{value}</Text>\n        <Text style={telStyles.unit}>{unit}</Text>\n      </View>\n      <Text style={telStyles.label}>{label}</Text>\n    </GlassCard>\n  );\n}\n\nconst telStyles = StyleSheet.create({\n  card: {\n    flex: 1,\n    padding: 12,\n  },\n  topRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'flex-end',\n    marginBottom: 8,\n  },\n  iconWrap: {\n    width: 26,\n    height: 26,\n    borderRadius: 8,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  valueRow: {\n    flexDirection: 'row',\n    alignItems: 'baseline',\n    gap: 3,\n  },\n  value: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 18,\n  },\n  unit: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 10,\n    color: '#FFFFFF',\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  label: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 10,\n    color: Colors.dark.accent,\n    marginTop: 2,\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n});\n\nexport function LiveTelemetry({ isConnected, downloadSpeed, uploadSpeed, sessionDuration, ping, dataUsed }: LiveTelemetryProps) {\n  return (\n    <View style={styles.container}>\n      <View style={styles.row}>\n        <TelemetryCard\n          icon=\"arrow-down\"\n          iconColor={Colors.dark.accent}\n          label=\"Download\"\n          value={isConnected ? downloadSpeed.toFixed(1) : '0.0'}\n          unit=\"Mbps\"\n          barValue={isConnected ? downloadSpeed : 0}\n          barMax={150}\n          barColor={Colors.dark.accent}\n        />\n        <TelemetryCard\n          icon=\"arrow-up\"\n          iconColor={Colors.dark.accentPurple}\n          label=\"Upload\"\n          value={isConnected ? uploadSpeed.toFixed(1) : '0.0'}\n          unit=\"Mbps\"\n          barValue={isConnected ? uploadSpeed : 0}\n          barMax={60}\n          barColor={Colors.dark.accentPurple}\n        />\n      </View>\n      <View style={styles.row}>\n        <TelemetryCard\n          icon=\"time-outline\"\n          iconColor={Colors.dark.accentCoral}\n          label=\"Session\"\n          value={isConnected ? formatDuration(sessionDuration) : '00:00:00'}\n          unit=\"\"\n          barValue={isConnected ? Math.min(sessionDuration, 3600) : 0}\n          barMax={3600}\n          barColor={Colors.dark.accentCoral}\n        />\n        <TelemetryCard\n          icon=\"pulse-outline\"\n          iconColor={Colors.dark.warning}\n          label=\"Latency\"\n          value={isConnected ? ping.toString() : '0'}\n          unit=\"ms\"\n          barValue={isConnected ? ping : 0}\n          barMax={200}\n          barColor={Colors.dark.warning}\n        />\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    paddingHorizontal: 20,\n    gap: 10,\n  },\n  row: {\n    flexDirection: 'row',\n    gap: 10,\n  },\n});\n","path":null,"size_bytes":5751,"size_tokens":null},"components/components/PowerButton.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, Pressable, StyleSheet, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withRepeat,\n  withTiming,\n  withSpring,\n  withSequence,\n  withDelay,\n  Easing,\n  interpolateColor,\n  interpolate,\n} from 'react-native-reanimated';\nimport Svg, { Circle, Defs, RadialGradient, Stop } from 'react-native-svg';\nimport { MaterialCommunityIcons, Ionicons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport Colors from '@/constants/colors';\n\nconst BUTTON_SIZE = 150;\nconst INNER_RING = BUTTON_SIZE + 20;\nconst MIDDLE_RING = BUTTON_SIZE + 44;\nconst OUTER_RING = BUTTON_SIZE + 70;\nconst ENERGY_RING = BUTTON_SIZE + 58;\n\ninterface PowerButtonProps {\n  isConnected: boolean;\n  isConnecting: boolean;\n  onPress: () => void;\n}\n\nfunction EnergyArc({ size, color, dashArray, rotation }: { size: number; color: string; dashArray: string; rotation: number }) {\n  const r = (size - 4) / 2;\n  return (\n    <Svg width={size} height={size} style={[StyleSheet.absoluteFill, { transform: [{ rotate: `${rotation}deg` }] }]}>\n      <Circle\n        cx={size / 2}\n        cy={size / 2}\n        r={r}\n        stroke={color}\n        strokeWidth={2}\n        fill=\"none\"\n        strokeDasharray={dashArray}\n        strokeLinecap=\"round\"\n        opacity={0.7}\n      />\n    </Svg>\n  );\n}\n\nexport function PowerButton({ isConnected, isConnecting, onPress }: PowerButtonProps) {\n  const pulse = useSharedValue(1);\n  const cyanPulse = useSharedValue(0.3);\n  const rotation = useSharedValue(0);\n  const rotation2 = useSharedValue(0);\n  const scale = useSharedValue(1);\n  const colorProgress = useSharedValue(0);\n  const glowOpacity = useSharedValue(0);\n  const shieldBadgeScale = useSharedValue(0);\n  const energyRingOpacity = useSharedValue(0);\n\n  useEffect(() => {\n    if (isConnecting) {\n      cyanPulse.value = withTiming(0);\n      rotation.value = withRepeat(withTiming(360, { duration: 2500, easing: Easing.linear }), -1, false);\n      rotation2.value = withRepeat(withTiming(-360, { duration: 1800, easing: Easing.linear }), -1, false);\n      pulse.value = withRepeat(withTiming(1.06, { duration: 600, easing: Easing.inOut(Easing.ease) }), -1, true);\n      colorProgress.value = withRepeat(withTiming(0.5, { duration: 800 }), -1, true);\n      glowOpacity.value = withRepeat(withTiming(0.6, { duration: 600 }), -1, true);\n      energyRingOpacity.value = withTiming(1, { duration: 300 });\n      shieldBadgeScale.value = withTiming(0, { duration: 200 });\n    } else if (isConnected) {\n      rotation.value = withTiming(rotation.value % 360);\n      rotation2.value = withTiming(0);\n      pulse.value = withRepeat(withTiming(1.02, { duration: 4000, easing: Easing.inOut(Easing.ease) }), -1, true);\n      colorProgress.value = withTiming(1, { duration: 600 });\n      glowOpacity.value = withTiming(0.5, { duration: 800 });\n      cyanPulse.value = withTiming(0);\n      energyRingOpacity.value = withTiming(0, { duration: 500 });\n      shieldBadgeScale.value = withDelay(300, withSpring(1, { damping: 12, stiffness: 150 }));\n    } else {\n      rotation.value = withTiming(0, { duration: 500 });\n      rotation2.value = withTiming(0, { duration: 500 });\n      pulse.value = withTiming(1, { duration: 500 });\n      colorProgress.value = withTiming(0, { duration: 500 });\n      glowOpacity.value = withTiming(0, { duration: 500 });\n      energyRingOpacity.value = withTiming(0, { duration: 300 });\n      shieldBadgeScale.value = withTiming(0, { duration: 200 });\n      cyanPulse.value = withRepeat(withTiming(0.8, { duration: 2500, easing: Easing.inOut(Easing.ease) }), -1, true);\n    }\n  }, [isConnected, isConnecting]);\n\n  const outerGlowStyle = useAnimatedStyle(() => ({\n    opacity: interpolate(colorProgress.value, [0, 0.5, 1], [0, 0.3, 0.5]),\n    transform: [{ scale: pulse.value }],\n    backgroundColor: interpolateColor(colorProgress.value, [0, 0.5, 1], ['rgba(0,240,255,0)', 'rgba(195,0,255,0.08)', 'rgba(0,230,118,0.06)']),\n    shadowColor: interpolateColor(colorProgress.value, [0, 0.5, 1], ['#00F0FF', '#C300FF', '#00E676']),\n    shadowOpacity: glowOpacity.value,\n  }));\n\n  const cyanPulseStyle = useAnimatedStyle(() => ({\n    opacity: cyanPulse.value,\n    transform: [{ scale: interpolate(cyanPulse.value, [0.3, 0.8], [1, 1.15]) }],\n  }));\n\n  const energyRing1Style = useAnimatedStyle(() => ({\n    opacity: energyRingOpacity.value,\n    transform: [{ rotate: `${rotation.value}deg` }],\n  }));\n\n  const energyRing2Style = useAnimatedStyle(() => ({\n    opacity: interpolate(energyRingOpacity.value, [0, 1], [0, 0.6]),\n    transform: [{ rotate: `${rotation2.value}deg` }],\n  }));\n\n  const middleRingStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: pulse.value }],\n    borderColor: interpolateColor(colorProgress.value, [0, 0.5, 1], ['rgba(255,255,255,0.05)', 'rgba(195,0,255,0.3)', 'rgba(0,230,118,0.25)']),\n  }));\n\n  const buttonStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n    backgroundColor: interpolateColor(colorProgress.value, [0, 0.5, 1], ['rgba(255,255,255,0.04)', 'rgba(195,0,255,0.06)', 'rgba(0,230,118,0.06)']),\n    borderColor: interpolateColor(colorProgress.value, [0, 0.5, 1], ['rgba(0,240,255,0.15)', 'rgba(195,0,255,0.5)', 'rgba(0,230,118,0.4)']),\n  }));\n\n  const shieldBadgeStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: shieldBadgeScale.value }],\n    opacity: shieldBadgeScale.value,\n  }));\n\n  const handlePress = () => {\n    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);\n    scale.value = withSequence(\n      withSpring(0.9, { damping: 10, stiffness: 300 }),\n      withSpring(1, { damping: 8, stiffness: 150 })\n    );\n    onPress();\n  };\n\n  const iconColor = isConnected ? '#00E676' : isConnecting ? Colors.dark.accentPurple : Colors.dark.accent;\n\n  return (\n    <View style={styles.container}>\n      <Animated.View style={[styles.outerGlow, outerGlowStyle]} />\n\n      {!isConnected && !isConnecting && (\n        <Animated.View style={[styles.cyanPulseRing, cyanPulseStyle]} />\n      )}\n\n      <Animated.View style={[styles.energyRingContainer, energyRing1Style]}>\n        <EnergyArc size={ENERGY_RING} color={Colors.dark.accentPurple} dashArray=\"30 20 60 15\" rotation={0} />\n      </Animated.View>\n      <Animated.View style={[styles.energyRingContainer, energyRing2Style]}>\n        <EnergyArc size={ENERGY_RING - 10} color={Colors.dark.accent} dashArray=\"20 40 10 30\" rotation={45} />\n      </Animated.View>\n\n      <Animated.View style={[styles.middleRing, middleRingStyle]} />\n\n      <Pressable onPress={handlePress}>\n        <Animated.View style={[styles.button, buttonStyle]}>\n          <MaterialCommunityIcons name=\"power\" size={52} color={iconColor} />\n        </Animated.View>\n      </Pressable>\n\n      <Animated.View style={[styles.shieldBadge, shieldBadgeStyle]}>\n        <View style={styles.shieldBadgeInner}>\n          <Ionicons name=\"shield-checkmark\" size={12} color=\"#00E676\" />\n          <Text style={styles.shieldBadgeText}>PROTECTED</Text>\n        </View>\n      </Animated.View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    width: OUTER_RING + 20,\n    height: OUTER_RING + 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  outerGlow: {\n    position: 'absolute',\n    width: OUTER_RING,\n    height: OUTER_RING,\n    borderRadius: OUTER_RING / 2,\n    shadowOffset: { width: 0, height: 0 },\n    shadowRadius: 40,\n    elevation: 10,\n  },\n  cyanPulseRing: {\n    position: 'absolute',\n    width: MIDDLE_RING + 8,\n    height: MIDDLE_RING + 8,\n    borderRadius: (MIDDLE_RING + 8) / 2,\n    borderWidth: 1,\n    borderColor: 'rgba(0, 240, 255, 0.2)',\n  },\n  energyRingContainer: {\n    position: 'absolute',\n    width: ENERGY_RING,\n    height: ENERGY_RING,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  middleRing: {\n    position: 'absolute',\n    width: INNER_RING,\n    height: INNER_RING,\n    borderRadius: INNER_RING / 2,\n    borderWidth: 1,\n  },\n  button: {\n    width: BUTTON_SIZE,\n    height: BUTTON_SIZE,\n    borderRadius: BUTTON_SIZE / 2,\n    borderWidth: 1.5,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  shieldBadge: {\n    position: 'absolute',\n    bottom: 8,\n  },\n  shieldBadgeInner: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n    backgroundColor: 'rgba(0, 230, 118, 0.1)',\n    borderWidth: 1,\n    borderColor: 'rgba(0, 230, 118, 0.25)',\n    paddingHorizontal: 10,\n    paddingVertical: 4,\n    borderRadius: 12,\n  },\n  shieldBadgeText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: '#00E676',\n    letterSpacing: 2,\n  },\n});\n","path":null,"size_bytes":8630,"size_tokens":null},"components/ErrorFallback.tsx":{"content":"import React, { useState } from \"react\";\nimport { reloadAppAsync } from \"expo\";\nimport {\n  StyleSheet,\n  View,\n  Pressable,\n  ScrollView,\n  Text,\n  Modal,\n  useColorScheme,\n  Platform,\n} from \"react-native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Feather } from \"@expo/vector-icons\";\n\nexport type ErrorFallbackProps = {\n  error: Error;\n  resetError: () => void;\n};\n\nexport function ErrorFallback({ error, resetError }: ErrorFallbackProps) {\n  const colorScheme = useColorScheme();\n  const isDark = colorScheme === \"dark\";\n  const insets = useSafeAreaInsets();\n\n  const theme = {\n    background: isDark ? \"#000000\" : \"#FFFFFF\",\n    backgroundSecondary: isDark ? \"#1C1C1E\" : \"#F2F2F7\",\n    text: isDark ? \"#FFFFFF\" : \"#000000\",\n    textSecondary: isDark ? \"rgba(255, 255, 255, 0.7)\" : \"rgba(0, 0, 0, 0.7)\",\n    link: \"#007AFF\",\n    buttonText: \"#FFFFFF\",\n  };\n\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const handleRestart = async () => {\n    try {\n      await reloadAppAsync();\n    } catch (restartError) {\n      console.error(\"Failed to restart app:\", restartError);\n      resetError();\n    }\n  };\n\n  const formatErrorDetails = (): string => {\n    let details = `Error: ${error.message}\\n\\n`;\n    if (error.stack) {\n      details += `Stack Trace:\\n${error.stack}`;\n    }\n    return details;\n  };\n\n  const monoFont = Platform.select({\n    ios: \"Menlo\",\n    android: \"monospace\",\n    default: \"monospace\",\n  });\n\n  return (\n    <View style={[styles.container, { backgroundColor: theme.background }]}>\n      {__DEV__ ? (\n        <Pressable\n          onPress={() => setIsModalVisible(true)}\n          accessibilityLabel=\"View error details\"\n          accessibilityRole=\"button\"\n          style={({ pressed }) => [\n            styles.topButton,\n            {\n              top: insets.top + 16,\n              backgroundColor: theme.backgroundSecondary,\n              opacity: pressed ? 0.8 : 1,\n            },\n          ]}\n        >\n          <Feather name=\"alert-circle\" size={20} color={theme.text} />\n        </Pressable>\n      ) : null}\n\n      <View style={styles.content}>\n        <Text style={[styles.title, { color: theme.text }]}>\n          Something went wrong\n        </Text>\n\n        <Text style={[styles.message, { color: theme.textSecondary }]}>\n          Please reload the app to continue.\n        </Text>\n\n        <Pressable\n          onPress={handleRestart}\n          style={({ pressed }) => [\n            styles.button,\n            {\n              backgroundColor: theme.link,\n              opacity: pressed ? 0.9 : 1,\n              transform: [{ scale: pressed ? 0.98 : 1 }],\n            },\n          ]}\n        >\n          <Text style={[styles.buttonText, { color: theme.buttonText }]}>\n            Try Again\n          </Text>\n        </Pressable>\n      </View>\n\n      {__DEV__ ? (\n        <Modal\n          visible={isModalVisible}\n          animationType=\"slide\"\n          transparent={true}\n          onRequestClose={() => setIsModalVisible(false)}\n        >\n          <View style={styles.modalOverlay}>\n            <View\n              style={[\n                styles.modalContainer,\n                { backgroundColor: theme.background },\n              ]}\n            >\n              <View\n                style={[\n                  styles.modalHeader,\n                  {\n                    borderBottomColor: isDark\n                      ? \"rgba(255, 255, 255, 0.1)\"\n                      : \"rgba(0, 0, 0, 0.1)\",\n                  },\n                ]}\n              >\n                <Text style={[styles.modalTitle, { color: theme.text }]}>\n                  Error Details\n                </Text>\n                <Pressable\n                  onPress={() => setIsModalVisible(false)}\n                  accessibilityLabel=\"Close error details\"\n                  accessibilityRole=\"button\"\n                  style={({ pressed }) => [\n                    styles.closeButton,\n                    { opacity: pressed ? 0.6 : 1 },\n                  ]}\n                >\n                  <Feather name=\"x\" size={24} color={theme.text} />\n                </Pressable>\n              </View>\n\n              <ScrollView\n                style={styles.modalScrollView}\n                contentContainerStyle={[\n                  styles.modalScrollContent,\n                  { paddingBottom: insets.bottom + 16 },\n                ]}\n                showsVerticalScrollIndicator\n              >\n                <View\n                  style={[\n                    styles.errorContainer,\n                    { backgroundColor: theme.backgroundSecondary },\n                  ]}\n                >\n                  <Text\n                    style={[\n                      styles.errorText,\n                      {\n                        color: theme.text,\n                        fontFamily: monoFont,\n                      },\n                    ]}\n                    selectable\n                  >\n                    {formatErrorDetails()}\n                  </Text>\n                </View>\n              </ScrollView>\n            </View>\n          </View>\n        </Modal>\n      ) : null}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    padding: 24,\n  },\n  content: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: 16,\n    width: \"100%\",\n    maxWidth: 600,\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: \"700\",\n    textAlign: \"center\",\n    lineHeight: 40,\n  },\n  message: {\n    fontSize: 16,\n    textAlign: \"center\",\n    lineHeight: 24,\n  },\n  topButton: {\n    position: \"absolute\",\n    right: 16,\n    width: 44,\n    height: 44,\n    borderRadius: 8,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    zIndex: 10,\n  },\n  button: {\n    paddingVertical: 16,\n    borderRadius: 8,\n    paddingHorizontal: 24,\n    minWidth: 200,\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  buttonText: {\n    fontWeight: \"600\",\n    textAlign: \"center\",\n    fontSize: 16,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContainer: {\n    width: \"100%\",\n    height: \"90%\",\n    borderTopLeftRadius: 16,\n    borderTopRightRadius: 16,\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: 16,\n    paddingTop: 16,\n    paddingBottom: 12,\n    borderBottomWidth: 1,\n  },\n  modalTitle: {\n    fontSize: 20,\n    fontWeight: \"600\",\n  },\n  closeButton: {\n    width: 44,\n    height: 44,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  modalScrollView: {\n    flex: 1,\n  },\n  modalScrollContent: {\n    padding: 16,\n  },\n  errorContainer: {\n    width: \"100%\",\n    borderRadius: 8,\n    overflow: \"hidden\",\n    padding: 16,\n  },\n  errorText: {\n    fontSize: 12,\n    lineHeight: 18,\n    width: \"100%\",\n  },\n});\n","path":null,"size_bytes":7103,"size_tokens":null},"lib/fingerprint-runtime.ts":{"content":"import { Platform } from 'react-native';\n\nlet originalRTCPeerConnection: typeof RTCPeerConnection | null = null;\nlet originalDateTimeFormat: typeof Intl.DateTimeFormat | null = null;\nlet originalGetTimezoneOffset: (() => number) | null = null;\nlet originalToDataURL: ((type?: string, quality?: any) => string) | null = null;\nlet originalGetImageData: ((sx: number, sy: number, sw: number, sh: number) => ImageData) | null = null;\n\nlet webrtcActive = false;\nlet timezoneActive = false;\nlet canvasActive = false;\n\nexport function applyWebRTCMask(enabled: boolean): void {\n  if (Platform.OS !== 'web') return;\n  if (typeof window === 'undefined') return;\n\n  if (enabled && !webrtcActive) {\n    const g = window as any;\n    originalRTCPeerConnection = g.RTCPeerConnection || g.webkitRTCPeerConnection;\n\n    if (originalRTCPeerConnection) {\n      g.RTCPeerConnection = function () {\n        return {\n          createOffer: () => Promise.resolve({ type: 'offer', sdp: '' }),\n          createAnswer: () => Promise.resolve({ type: 'answer', sdp: '' }),\n          setLocalDescription: () => Promise.resolve(),\n          setRemoteDescription: () => Promise.resolve(),\n          addIceCandidate: () => Promise.resolve(),\n          close: () => {},\n          addEventListener: () => {},\n          removeEventListener: () => {},\n          getStats: () => Promise.resolve(new Map()),\n          getSenders: () => [],\n          getReceivers: () => [],\n          onicecandidate: null,\n          ontrack: null,\n          ondatachannel: null,\n          onconnectionstatechange: null,\n          localDescription: null,\n          remoteDescription: null,\n          connectionState: 'closed',\n          iceConnectionState: 'closed',\n          iceGatheringState: 'complete',\n          signalingState: 'closed',\n        };\n      } as any;\n    }\n\n    if (g.webkitRTCPeerConnection) {\n      g.webkitRTCPeerConnection = g.RTCPeerConnection;\n    }\n\n    webrtcActive = true;\n  } else if (!enabled && webrtcActive) {\n    if (originalRTCPeerConnection) {\n      const g = window as any;\n      g.RTCPeerConnection = originalRTCPeerConnection;\n      if (g.webkitRTCPeerConnection) {\n        g.webkitRTCPeerConnection = originalRTCPeerConnection;\n      }\n      originalRTCPeerConnection = null;\n    }\n    webrtcActive = false;\n  }\n}\n\nexport function applyTimezoneSpoofing(enabled: boolean, timezone: string | null, offsetHours: number): void {\n  if (Platform.OS !== 'web') return;\n  if (typeof window === 'undefined') return;\n\n  if (enabled && timezone) {\n    if (!originalDateTimeFormat) {\n      originalDateTimeFormat = Intl.DateTimeFormat;\n    }\n    if (!originalGetTimezoneOffset) {\n      originalGetTimezoneOffset = Date.prototype.getTimezoneOffset;\n    }\n\n    const spoofedTimezone = timezone;\n    const spoofedOffset = -(offsetHours * 60);\n\n    const OrigDTF = originalDateTimeFormat;\n    (Intl as any).DateTimeFormat = function (...args: any[]) {\n      if (args.length >= 2 && args[1]) {\n        args[1] = { ...args[1], timeZone: args[1].timeZone || spoofedTimezone };\n      } else if (args.length < 2) {\n        args[1] = { timeZone: spoofedTimezone };\n      }\n      return new OrigDTF(...args);\n    };\n    (Intl as any).DateTimeFormat.prototype = OrigDTF.prototype;\n    (Intl as any).DateTimeFormat.supportedLocalesOf = OrigDTF.supportedLocalesOf;\n\n    Date.prototype.getTimezoneOffset = function () {\n      return spoofedOffset;\n    };\n\n    timezoneActive = true;\n  } else if (!enabled && timezoneActive) {\n    if (originalDateTimeFormat) {\n      (Intl as any).DateTimeFormat = originalDateTimeFormat;\n      originalDateTimeFormat = null;\n    }\n    if (originalGetTimezoneOffset) {\n      Date.prototype.getTimezoneOffset = originalGetTimezoneOffset;\n      originalGetTimezoneOffset = null;\n    }\n    timezoneActive = false;\n  }\n}\n\nexport function applyCanvasNoise(enabled: boolean, noiseLevel: number = 0.02): void {\n  if (Platform.OS !== 'web') return;\n  if (typeof window === 'undefined') return;\n  if (typeof HTMLCanvasElement === 'undefined') return;\n\n  if (enabled && !canvasActive) {\n    const canvasProto = HTMLCanvasElement.prototype;\n    originalToDataURL = canvasProto.toDataURL;\n\n    canvasProto.toDataURL = function (type?: string, quality?: any): string {\n      try {\n        const ctx = this.getContext('2d');\n        if (ctx) {\n          const w = Math.min(this.width, 4);\n          const h = Math.min(this.height, 4);\n          const imageData = CanvasRenderingContext2D.prototype.getImageData.call(ctx, 0, 0, w, h);\n          for (let i = 0; i < imageData.data.length; i += 4) {\n            imageData.data[i] = Math.max(0, Math.min(255, imageData.data[i] + (Math.random() - 0.5) * noiseLevel * 255));\n            imageData.data[i + 1] = Math.max(0, Math.min(255, imageData.data[i + 1] + (Math.random() - 0.5) * noiseLevel * 255));\n            imageData.data[i + 2] = Math.max(0, Math.min(255, imageData.data[i + 2] + (Math.random() - 0.5) * noiseLevel * 255));\n          }\n          ctx.putImageData(imageData, 0, 0);\n        }\n      } catch (_) {}\n      return originalToDataURL!.call(this, type, quality);\n    };\n\n    const ctx2dProto = CanvasRenderingContext2D.prototype;\n    originalGetImageData = ctx2dProto.getImageData;\n\n    ctx2dProto.getImageData = function (sx: number, sy: number, sw: number, sh: number): ImageData {\n      const data = originalGetImageData!.call(this, sx, sy, sw, sh);\n      for (let i = 0; i < data.data.length; i += 4) {\n        data.data[i] = Math.max(0, Math.min(255, data.data[i] + (Math.random() - 0.5) * noiseLevel * 255));\n        data.data[i + 1] = Math.max(0, Math.min(255, data.data[i + 1] + (Math.random() - 0.5) * noiseLevel * 255));\n        data.data[i + 2] = Math.max(0, Math.min(255, data.data[i + 2] + (Math.random() - 0.5) * noiseLevel * 255));\n      }\n      return data;\n    };\n\n    canvasActive = true;\n  } else if (!enabled && canvasActive) {\n    if (originalToDataURL) {\n      HTMLCanvasElement.prototype.toDataURL = originalToDataURL;\n      originalToDataURL = null;\n    }\n    if (originalGetImageData) {\n      CanvasRenderingContext2D.prototype.getImageData = originalGetImageData;\n      originalGetImageData = null;\n    }\n    canvasActive = false;\n  }\n}\n\nexport function getAppliedProtections(): { webrtc: boolean; timezone: boolean; canvas: boolean } {\n  return {\n    webrtc: webrtcActive,\n    timezone: timezoneActive,\n    canvas: canvasActive,\n  };\n}\n","path":null,"size_bytes":6401,"size_tokens":null},"main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","path":null,"size_bytes":96,"size_tokens":null},"backend/no_logs.py":{"content":"import time\nimport asyncio\nfrom datetime import datetime, timezone, timedelta\nfrom sqlalchemy.orm import Session\nfrom backend.database import SessionLocal\nfrom backend.models import ServerLog\n\nNO_LOGS_RETENTION_MINUTES = 5\nPURGE_INTERVAL_SECONDS = 60\n\n\ndef create_minimal_log(\n    db: Session,\n    event_type: str,\n    server_id: str | None = None,\n    duration_seconds: int | None = None,\n    bytes_transferred: int | None = None,\n    protocol: str | None = None,\n    region: str | None = None,\n) -> ServerLog:\n    anonymized_region = None\n    if region and len(region) >= 2:\n        anonymized_region = region[:2].upper()\n\n    purge_at = datetime.now(timezone.utc) + timedelta(minutes=NO_LOGS_RETENTION_MINUTES)\n\n    now = datetime.now(timezone.utc)\n    rounded_timestamp = now.replace(minute=0, second=0, microsecond=0)\n\n    log = ServerLog(\n        event_type=event_type,\n        server_id=None,\n        timestamp=rounded_timestamp,\n        duration_seconds=duration_seconds,\n        bytes_transferred=bytes_transferred,\n        protocol=protocol,\n        anonymized_region=anonymized_region,\n        purge_after=purge_at,\n        is_purged=False,\n        no_logs_compliant=True,\n    )\n    db.add(log)\n    db.commit()\n    db.refresh(log)\n    return log\n\n\ndef purge_expired_logs(db: Session) -> int:\n    now = datetime.now(timezone.utc)\n    expired = db.query(ServerLog).filter(\n        ServerLog.purge_after <= now,\n        ServerLog.is_purged == False,\n    ).all()\n\n    count = 0\n    for log in expired:\n        db.delete(log)\n        count += 1\n\n    if count > 0:\n        db.commit()\n\n    return count\n\n\nasync def auto_purge_loop():\n    while True:\n        try:\n            await asyncio.sleep(PURGE_INTERVAL_SECONDS)\n            db = SessionLocal()\n            try:\n                purged = purge_expired_logs(db)\n            finally:\n                db.close()\n        except asyncio.CancelledError:\n            break\n        except Exception:\n            pass\n\n\ndef get_no_logs_policy() -> dict:\n    return {\n        \"policy\": \"Strict No-Logs\",\n        \"version\": \"1.0\",\n        \"details\": {\n            \"connection_logs\": \"Never stored\",\n            \"activity_logs\": \"Never stored\",\n            \"ip_addresses\": \"Never recorded\",\n            \"dns_queries\": \"Never logged\",\n            \"browsing_history\": \"Never tracked\",\n            \"session_data\": \"Auto-purged after {} minutes\".format(NO_LOGS_RETENTION_MINUTES),\n            \"server_ids\": \"Stripped from all records\",\n            \"timestamps\": \"Rounded to nearest hour in aggregates\",\n            \"data_retention\": \"{} minutes maximum\".format(NO_LOGS_RETENTION_MINUTES),\n        },\n        \"what_we_store\": [\n            \"Anonymized aggregate bandwidth (region-level only)\",\n            \"Session duration (for billing, auto-purged)\",\n            \"Account credentials (hashed, never plaintext)\",\n        ],\n        \"what_we_never_store\": [\n            \"Your real IP address\",\n            \"Websites you visit\",\n            \"DNS queries\",\n            \"Connection timestamps with user identity\",\n            \"Traffic content or metadata\",\n            \"Device identifiers\",\n            \"Server-specific connection logs\",\n        ],\n        \"audited\": True,\n        \"jurisdiction\": \"Privacy-friendly jurisdiction\",\n    }\n","path":null,"size_bytes":3277,"size_tokens":null},"backend/models.py":{"content":"import uuid\nfrom datetime import datetime, timezone\nfrom sqlalchemy import Column, String, DateTime, Boolean, Integer, Text, Float\nfrom sqlalchemy.sql import func\nfrom backend.database import Base\n\n\nclass User(Base):\n    __tablename__ = \"users\"\n\n    id = Column(String, primary_key=True, default=lambda: str(uuid.uuid4()))\n    username = Column(String(50), unique=True, nullable=False, index=True)\n    email = Column(String(255), unique=True, nullable=False, index=True)\n    password_hash = Column(String(255), nullable=False)\n    display_name = Column(String(100), nullable=True)\n    subscription_tier = Column(String(20), default=\"free\")\n    preferred_protocol = Column(String(30), default=\"WireGuard\")\n    kill_switch_default = Column(Boolean, default=True)\n    auto_connect = Column(Boolean, default=False)\n    fingerprint_shield_default = Column(Boolean, default=False)\n    favorite_servers = Column(Text, default=\"[]\")\n    created_at = Column(DateTime, default=lambda: datetime.now(timezone.utc))\n    updated_at = Column(DateTime, default=lambda: datetime.now(timezone.utc), onupdate=lambda: datetime.now(timezone.utc))\n    last_login = Column(DateTime, nullable=True)\n    is_active = Column(Boolean, default=True)\n    total_data_transferred_bytes = Column(Integer, default=0)\n    total_sessions = Column(Integer, default=0)\n\n\nclass ServerLog(Base):\n    __tablename__ = \"server_logs\"\n\n    id = Column(String, primary_key=True, default=lambda: str(uuid.uuid4()))\n    event_type = Column(String(50), nullable=False, index=True)\n    server_id = Column(String(50), nullable=True)\n    timestamp = Column(DateTime, default=lambda: datetime.now(timezone.utc), index=True)\n    duration_seconds = Column(Integer, nullable=True)\n    bytes_transferred = Column(Integer, nullable=True)\n    protocol = Column(String(30), nullable=True)\n    anonymized_region = Column(String(10), nullable=True)\n    purge_after = Column(DateTime, nullable=False)\n    is_purged = Column(Boolean, default=False)\n    no_logs_compliant = Column(Boolean, default=True)\n","path":null,"size_bytes":2039,"size_tokens":null},"components/ServerCard.tsx":{"content":"import React from 'react';\nimport { View, Text, Pressable, StyleSheet } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport { GlassCard } from '@/components/GlassCard';\nimport Colors from '@/constants/colors';\nimport type { VpnServer } from '@/lib/vpn-context';\n\nconst REGION_COLORS: Record<string, string> = {\n  US: Colors.dark.accent,\n  GB: Colors.dark.accentPurple,\n  DE: Colors.dark.accentPurple,\n  JP: '#FF6B6B',\n  SG: '#FF6B6B',\n  AU: Colors.dark.warning,\n  CA: Colors.dark.accent,\n  NL: Colors.dark.accentPurple,\n  CH: Colors.dark.accentPurple,\n  FR: Colors.dark.accentPurple,\n  KR: '#FF6B6B',\n  BR: Colors.dark.success,\n  IN: '#FF6B6B',\n  SE: Colors.dark.accentPurple,\n};\n\ninterface ServerCardProps {\n  server: VpnServer;\n  isSelected: boolean;\n  isFavorite: boolean;\n  onSelect: () => void;\n  onToggleFavorite: () => void;\n  locked?: boolean;\n}\n\nexport function ServerCard({ server, isSelected, isFavorite, onSelect, onToggleFavorite, locked }: ServerCardProps) {\n  const pingColor = server.ping < 50 ? Colors.dark.success : server.ping < 100 ? Colors.dark.warning : Colors.dark.danger;\n  const loadColor = server.load < 40 ? Colors.dark.success : server.load < 70 ? Colors.dark.warning : Colors.dark.danger;\n\n  return (\n    <Pressable\n      onPress={() => {\n        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n        onSelect();\n      }}\n    >\n      <GlassCard\n        style={[styles.card, isSelected && styles.selectedCard]}\n        intensity={isSelected ? 'high' : 'low'}\n        glowColor={isSelected ? Colors.dark.accent : undefined}\n      >\n        <View style={styles.row}>\n          <View style={styles.leftSection}>\n            <View style={[styles.iconContainer, isSelected && styles.iconContainerSelected]}>\n              <Ionicons\n                name=\"globe-outline\"\n                size={22}\n                color={isSelected ? Colors.dark.accent : (REGION_COLORS[server.flag] || Colors.dark.textSecondary)}\n              />\n            </View>\n            <View style={styles.textGroup}>\n              <View style={styles.nameRow}>\n                <Text style={[styles.name, isSelected && styles.nameSelected]}>{server.name}</Text>\n                {server.premium && (\n                  <View style={styles.premiumBadge}>\n                    <Ionicons name={locked ? 'lock-closed' : 'diamond'} size={10} color={Colors.dark.accentPurple} />\n                  </View>\n                )}\n              </View>\n              <Text style={styles.city}>{server.city}, {server.country}</Text>\n            </View>\n          </View>\n          <View style={styles.rightSection}>\n            <View style={styles.statsRow}>\n              <View style={styles.stat}>\n                <View style={[styles.statDot, { backgroundColor: pingColor }]} />\n                <Text style={styles.statText}>{server.ping}ms</Text>\n              </View>\n              <View style={styles.stat}>\n                <Ionicons name=\"speedometer-outline\" size={12} color={loadColor} />\n                <Text style={styles.statText}>{server.load}%</Text>\n              </View>\n            </View>\n            <Pressable\n              onPress={(e) => {\n                e.stopPropagation?.();\n                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                onToggleFavorite();\n              }}\n              hitSlop={12}\n            >\n              <Ionicons\n                name={isFavorite ? 'star' : 'star-outline'}\n                size={18}\n                color={isFavorite ? Colors.dark.warning : Colors.dark.textMuted}\n              />\n            </Pressable>\n          </View>\n        </View>\n      </GlassCard>\n    </Pressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    marginHorizontal: 20,\n    marginBottom: 10,\n    padding: 16,\n  },\n  selectedCard: {\n    borderColor: 'rgba(0, 240, 255, 0.2)',\n  },\n  row: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  leftSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  iconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: 12,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: 12,\n  },\n  iconContainerSelected: {\n    backgroundColor: 'rgba(0, 240, 255, 0.08)',\n  },\n  textGroup: {\n    flex: 1,\n  },\n  nameRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n  },\n  name: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 15,\n    color: Colors.dark.text,\n  },\n  nameSelected: {\n    color: Colors.dark.accent,\n  },\n  premiumBadge: {\n    width: 18,\n    height: 18,\n    borderRadius: 9,\n    backgroundColor: 'rgba(195, 0, 255, 0.15)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  city: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 12,\n    color: Colors.dark.accent,\n    marginTop: 2,\n    letterSpacing: 0.3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  rightSection: {\n    alignItems: 'flex-end',\n    gap: 8,\n  },\n  statsRow: {\n    flexDirection: 'row',\n    gap: 10,\n  },\n  stat: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n  },\n  statDot: {\n    width: 5,\n    height: 5,\n    borderRadius: 2.5,\n  },\n  statText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 11,\n    color: '#FFFFFF',\n    letterSpacing: 0.3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n});\n","path":null,"size_bytes":5614,"size_tokens":null},"server/storage.ts":{"content":"import { type User, type InsertUser } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\n// modify the interface with any CRUD methods\n// you might need\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n\n  constructor() {\n    this.users = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n}\n\nexport const storage = new MemStorage();\n","path":null,"size_bytes":993,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"components/components/ErrorBoundary.tsx":{"content":"import React, { Component, ComponentType, PropsWithChildren } from \"react\";\nimport { ErrorFallback, ErrorFallbackProps } from \"@/components/ErrorFallback\";\n\nexport type ErrorBoundaryProps = PropsWithChildren<{\n  FallbackComponent?: ComponentType<ErrorFallbackProps>;\n  onError?: (error: Error, stackTrace: string) => void;\n}>;\n\ntype ErrorBoundaryState = { error: Error | null };\n\n/**\n * This is a special case for for using the class components. Error boundaries must be class components because React only provides error boundary functionality through lifecycle methods (componentDidCatch and getDerivedStateFromError) which are not available in functional components.\n * https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\n */\n\nexport class ErrorBoundary extends Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  state: ErrorBoundaryState = { error: null };\n\n  static defaultProps: {\n    FallbackComponent: ComponentType<ErrorFallbackProps>;\n  } = {\n    FallbackComponent: ErrorFallback,\n  };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { error };\n  }\n\n  componentDidCatch(error: Error, info: { componentStack: string }): void {\n    if (typeof this.props.onError === \"function\") {\n      this.props.onError(error, info.componentStack);\n    }\n  }\n\n  resetError = (): void => {\n    this.setState({ error: null });\n  };\n\n  render() {\n    const { FallbackComponent } = this.props;\n\n    return this.state.error && FallbackComponent ? (\n      <FallbackComponent\n        error={this.state.error}\n        resetError={this.resetError}\n      />\n    ) : (\n      this.props.children\n    );\n  }\n}\n","path":null,"size_bytes":1674,"size_tokens":null},"components/NoiseBackground.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, StyleSheet, Dimensions, Platform } from 'react-native';\nimport Animated, { useSharedValue, useAnimatedStyle, withRepeat, withTiming, Easing } from 'react-native-reanimated';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport Colors from '@/constants/colors';\n\nconst { width, height } = Dimensions.get('window');\n\nexport function NoiseBackground({ children }: { children: React.ReactNode }) {\n  const orbY1 = useSharedValue(0);\n  const orbY2 = useSharedValue(0);\n  const orbX1 = useSharedValue(0);\n\n  useEffect(() => {\n    orbY1.value = withRepeat(withTiming(-30, { duration: 8000, easing: Easing.inOut(Easing.ease) }), -1, true);\n    orbY2.value = withRepeat(withTiming(25, { duration: 6000, easing: Easing.inOut(Easing.ease) }), -1, true);\n    orbX1.value = withRepeat(withTiming(20, { duration: 10000, easing: Easing.inOut(Easing.ease) }), -1, true);\n  }, []);\n\n  const orb1Style = useAnimatedStyle(() => ({\n    transform: [{ translateY: orbY1.value }, { translateX: orbX1.value }],\n  }));\n\n  const orb2Style = useAnimatedStyle(() => ({\n    transform: [{ translateY: orbY2.value }],\n  }));\n\n  return (\n    <View style={styles.container}>\n      <LinearGradient\n        colors={['#0F0F0F', '#0D0D1A', '#0F0F0F']}\n        start={{ x: 0, y: 0 }}\n        end={{ x: 1, y: 1 }}\n        style={StyleSheet.absoluteFill}\n      />\n      <Animated.View style={[styles.orb1, orb1Style]} />\n      <Animated.View style={[styles.orb2, orb2Style]} />\n      <View style={styles.noiseOverlay} />\n      {children}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#0F0F0F',\n  },\n  orb1: {\n    position: 'absolute',\n    top: '15%',\n    left: '-20%',\n    width: width * 0.8,\n    height: width * 0.8,\n    borderRadius: width * 0.4,\n    backgroundColor: 'rgba(0, 240, 255, 0.04)',\n  },\n  orb2: {\n    position: 'absolute',\n    bottom: '20%',\n    right: '-25%',\n    width: width * 0.7,\n    height: width * 0.7,\n    borderRadius: width * 0.35,\n    backgroundColor: 'rgba(195, 0, 255, 0.04)',\n  },\n  noiseOverlay: {\n    ...StyleSheet.absoluteFillObject,\n    backgroundColor: 'rgba(255,255,255,0.008)',\n  },\n});\n","path":null,"size_bytes":2208,"size_tokens":null},"components/IPInfoCard.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withRepeat,\n  withTiming,\n  Easing,\n} from 'react-native-reanimated';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { GlassCard } from '@/components/GlassCard';\nimport Colors from '@/constants/colors';\n\ninterface IPInfoCardProps {\n  isConnected: boolean;\n  virtualIp: string;\n  serverCity: string;\n  serverCountry: string;\n}\n\nfunction PulsingDot({ color, active }: { color: string; active: boolean }) {\n  const scale = useSharedValue(1);\n\n  useEffect(() => {\n    if (active) {\n      scale.value = withRepeat(withTiming(1.6, { duration: 1200, easing: Easing.inOut(Easing.ease) }), -1, true);\n    } else {\n      scale.value = withTiming(1);\n    }\n  }, [active]);\n\n  const dotStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n    opacity: active ? 0.6 : 0.2,\n  }));\n\n  return (\n    <View style={dotStyles.container}>\n      <Animated.View style={[dotStyles.outerRing, { borderColor: color }, dotStyle]} />\n      <View style={[dotStyles.innerDot, { backgroundColor: color }]} />\n    </View>\n  );\n}\n\nconst dotStyles = StyleSheet.create({\n  container: {\n    width: 20,\n    height: 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  outerRing: {\n    position: 'absolute',\n    width: 16,\n    height: 16,\n    borderRadius: 8,\n    borderWidth: 1,\n  },\n  innerDot: {\n    width: 6,\n    height: 6,\n    borderRadius: 3,\n  },\n});\n\nexport function IPInfoCard({ isConnected, virtualIp, serverCity, serverCountry }: IPInfoCardProps) {\n  const glowColor = isConnected ? Colors.dark.accent : undefined;\n\n  return (\n    <GlassCard style={styles.card} intensity=\"medium\" glowColor={glowColor}>\n      <View style={styles.headerRow}>\n        <View style={styles.headerLeft}>\n          <MaterialCommunityIcons name=\"ip-network-outline\" size={18} color={Colors.dark.accent} />\n          <Text style={styles.headerTitle}>IP Information</Text>\n        </View>\n        <PulsingDot color={isConnected ? Colors.dark.success : Colors.dark.textMuted} active={isConnected} />\n      </View>\n\n      <View style={styles.divider} />\n\n      <View style={styles.infoRow}>\n        <View style={styles.infoLeft}>\n          <View style={[styles.infoIcon, { backgroundColor: 'rgba(0,240,255,0.08)' }]}>\n            <MaterialCommunityIcons name=\"ip\" size={14} color={Colors.dark.accent} />\n          </View>\n          <Text style={styles.infoLabel}>Virtual IP</Text>\n        </View>\n        <Text style={[styles.infoValue, { color: isConnected ? Colors.dark.accent : Colors.dark.textMuted }]}>\n          {isConnected ? virtualIp : '---'}\n        </Text>\n      </View>\n\n      <View style={styles.infoRow}>\n        <View style={styles.infoLeft}>\n          <View style={[styles.infoIcon, { backgroundColor: 'rgba(195,0,255,0.08)' }]}>\n            <Ionicons name=\"business-outline\" size={13} color={Colors.dark.accentPurple} />\n          </View>\n          <Text style={styles.infoLabel}>ISP</Text>\n        </View>\n        <Text style={[styles.infoValue, { color: isConnected ? Colors.dark.accentPurple : Colors.dark.textMuted }]}>\n          {isConnected ? 'xVPN Secure Network' : '---'}\n        </Text>\n      </View>\n\n      <View style={styles.infoRow}>\n        <View style={styles.infoLeft}>\n          <View style={[styles.infoIcon, { backgroundColor: 'rgba(0,230,118,0.08)' }]}>\n            <Ionicons name=\"location-outline\" size={13} color={Colors.dark.success} />\n          </View>\n          <Text style={styles.infoLabel}>Location</Text>\n        </View>\n        <Text style={[styles.infoValue, { color: isConnected ? Colors.dark.success : Colors.dark.textMuted }]}>\n          {isConnected ? `${serverCity}, ${serverCountry}` : '---'}\n        </Text>\n      </View>\n\n      {isConnected && (\n        <View style={styles.secureBanner}>\n          <Ionicons name=\"shield-checkmark\" size={12} color={Colors.dark.success} />\n          <Text style={styles.secureText}>Your real IP is hidden</Text>\n        </View>\n      )}\n    </GlassCard>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    marginHorizontal: 20,\n    padding: 16,\n  },\n  headerRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  headerLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  headerTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 11,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  divider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    marginVertical: 12,\n  },\n  infoRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingVertical: 8,\n  },\n  infoLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  infoIcon: {\n    width: 28,\n    height: 28,\n    borderRadius: 8,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  infoLabel: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 12,\n    color: '#FFFFFF',\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  infoValue: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 12,\n  },\n  secureBanner: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n    backgroundColor: 'rgba(0,230,118,0.06)',\n    borderWidth: 1,\n    borderColor: 'rgba(0,230,118,0.12)',\n    borderRadius: 10,\n    padding: 10,\n    marginTop: 8,\n  },\n  secureText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 10,\n    color: Colors.dark.success,\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n});\n","path":null,"size_bytes":5819,"size_tokens":null},"babel.config.js":{"content":"module.exports = function (api) {\n  api.cache(true);\n  return {\n    presets: [[\"babel-preset-expo\", { unstable_transformImportMeta: true }]],\n  };\n};\n","path":null,"size_bytes":150,"size_tokens":null},"components/GlassCard.tsx":{"content":"import React from 'react';\nimport { View, StyleSheet, ViewStyle, Platform } from 'react-native';\nimport Colors from '@/constants/colors';\n\ninterface GlassCardProps {\n  children: React.ReactNode;\n  style?: ViewStyle;\n  intensity?: 'low' | 'medium' | 'high';\n  glowColor?: string;\n}\n\nexport function GlassCard({ children, style, intensity = 'medium', glowColor }: GlassCardProps) {\n  const bgOpacity = intensity === 'low' ? 0.03 : intensity === 'medium' ? 0.06 : 0.1;\n\n  return (\n    <View\n      style={[\n        styles.card,\n        {\n          backgroundColor: `rgba(255,255,255,${bgOpacity})`,\n          ...(glowColor ? { shadowColor: glowColor, shadowOpacity: 0.25, shadowRadius: 20, shadowOffset: { width: 0, height: 0 } } : {}),\n        },\n        style,\n      ]}\n    >\n      {children}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    borderRadius: 20,\n    borderWidth: 2,\n    borderColor: 'rgba(255,255,255,0.2)',\n    overflow: 'hidden',\n    ...(Platform.OS === 'web' ? {\n      // @ts-ignore\n      backdropFilter: 'blur(40px)',\n      WebkitBackdropFilter: 'blur(40px)',\n    } : {}),\n  },\n});\n","path":null,"size_bytes":1118,"size_tokens":null},"components/components/WorldMap.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, StyleSheet, Dimensions, Platform } from 'react-native';\nimport Svg, { Circle, Line, Path, G, Rect } from 'react-native-svg';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withRepeat,\n  withTiming,\n  Easing,\n} from 'react-native-reanimated';\nimport Colors from '@/constants/colors';\nimport type { VpnServer } from '@/lib/vpn-context';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\nconst MAP_WIDTH = SCREEN_WIDTH - 40;\nconst MAP_HEIGHT = MAP_WIDTH * 0.48;\n\ninterface CityNode {\n  serverId: string;\n  x: number;\n  y: number;\n  name: string;\n}\n\nconst CITY_NODES: CityNode[] = [\n  { serverId: '1', x: 0.22, y: 0.32, name: 'New York' },\n  { serverId: '2', x: 0.12, y: 0.35, name: 'Los Angeles' },\n  { serverId: '3', x: 0.47, y: 0.28, name: 'London' },\n  { serverId: '4', x: 0.52, y: 0.30, name: 'Frankfurt' },\n  { serverId: '5', x: 0.85, y: 0.38, name: 'Tokyo' },\n  { serverId: '6', x: 0.78, y: 0.58, name: 'Singapore' },\n  { serverId: '7', x: 0.88, y: 0.78, name: 'Sydney' },\n  { serverId: '8', x: 0.18, y: 0.28, name: 'Toronto' },\n  { serverId: '9', x: 0.50, y: 0.29, name: 'Amsterdam' },\n  { serverId: '10', x: 0.51, y: 0.32, name: 'Zurich' },\n  { serverId: '11', x: 0.49, y: 0.31, name: 'Paris' },\n  { serverId: '12', x: 0.82, y: 0.36, name: 'Seoul' },\n  { serverId: '13', x: 0.28, y: 0.68, name: 'Sao Paulo' },\n  { serverId: '14', x: 0.70, y: 0.48, name: 'Mumbai' },\n  { serverId: '15', x: 0.53, y: 0.24, name: 'Stockholm' },\n];\n\nfunction PingNode({ cx, cy, isSelected, isConnected }: { cx: number; cy: number; isSelected: boolean; isConnected: boolean }) {\n  const pingScale = useSharedValue(1);\n  const pingOpacity = useSharedValue(0.6);\n\n  useEffect(() => {\n    if (isSelected && isConnected) {\n      pingScale.value = withRepeat(withTiming(3, { duration: 1500, easing: Easing.out(Easing.ease) }), -1, false);\n      pingOpacity.value = withRepeat(withTiming(0, { duration: 1500, easing: Easing.out(Easing.ease) }), -1, false);\n    } else if (isSelected) {\n      pingScale.value = withRepeat(withTiming(2.5, { duration: 2000, easing: Easing.out(Easing.ease) }), -1, false);\n      pingOpacity.value = withRepeat(withTiming(0, { duration: 2000, easing: Easing.out(Easing.ease) }), -1, false);\n    } else {\n      pingScale.value = withTiming(1);\n      pingOpacity.value = withTiming(0.4);\n    }\n  }, [isSelected, isConnected]);\n\n  const pingStyle = useAnimatedStyle(() => ({\n    position: 'absolute' as const,\n    left: cx - 12,\n    top: cy - 12,\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: isConnected && isSelected ? '#00E676' : Colors.dark.accent,\n    opacity: pingOpacity.value,\n    transform: [{ scale: pingScale.value }],\n  }));\n\n  return isSelected ? <Animated.View style={pingStyle} /> : null;\n}\n\ninterface WorldMapProps {\n  selectedServer: VpnServer | null;\n  isConnected: boolean;\n}\n\nexport function WorldMap({ selectedServer, isConnected }: WorldMapProps) {\n  const selectedNode = CITY_NODES.find(n => n.serverId === selectedServer?.id);\n\n  const continentPaths = [\n    'M 60 75 Q 80 60 100 65 Q 110 55 95 50 Q 80 45 70 50 Q 55 55 45 65 Q 50 75 60 75 Z',\n    'M 155 60 Q 180 45 210 55 Q 230 65 220 80 Q 200 95 175 85 Q 160 75 155 60 Z',\n    'M 260 80 Q 290 70 320 75 Q 340 85 330 100 Q 310 115 280 105 Q 260 95 260 80 Z',\n    'M 320 100 Q 350 90 370 100 Q 380 115 365 130 Q 340 140 325 125 Q 315 110 320 100 Z',\n    'M 80 110 Q 100 100 120 115 Q 115 140 95 145 Q 80 135 75 120 Q 78 112 80 110 Z',\n  ];\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.mapContainer, { width: MAP_WIDTH, height: MAP_HEIGHT }]}>\n        <Svg width={MAP_WIDTH} height={MAP_HEIGHT} viewBox={`0 0 ${MAP_WIDTH} ${MAP_HEIGHT}`}>\n          <Rect x={0} y={0} width={MAP_WIDTH} height={MAP_HEIGHT} fill=\"transparent\" />\n\n          {Array.from({ length: 8 }).map((_, i) => (\n            <Line\n              key={`grid-h-${i}`}\n              x1={0}\n              y1={(MAP_HEIGHT / 8) * (i + 1)}\n              x2={MAP_WIDTH}\n              y2={(MAP_HEIGHT / 8) * (i + 1)}\n              stroke=\"rgba(255,255,255,0.02)\"\n              strokeWidth={0.5}\n            />\n          ))}\n          {Array.from({ length: 12 }).map((_, i) => (\n            <Line\n              key={`grid-v-${i}`}\n              x1={(MAP_WIDTH / 12) * (i + 1)}\n              y1={0}\n              x2={(MAP_WIDTH / 12) * (i + 1)}\n              y2={MAP_HEIGHT}\n              stroke=\"rgba(255,255,255,0.02)\"\n              strokeWidth={0.5}\n            />\n          ))}\n\n          {CITY_NODES.map(node => {\n            const nx = node.x * MAP_WIDTH;\n            const ny = node.y * MAP_HEIGHT;\n            const isSelected = node.serverId === selectedServer?.id;\n\n            if (isSelected && selectedNode) {\n              return (\n                <G key={node.serverId}>\n                  <Circle cx={nx} cy={ny} r={isConnected ? 5 : 4} fill={isConnected ? '#00E676' : Colors.dark.accent} opacity={0.9} />\n                  <Circle cx={nx} cy={ny} r={2} fill=\"#fff\" opacity={0.8} />\n                </G>\n              );\n            }\n\n            return (\n              <G key={node.serverId}>\n                <Circle cx={nx} cy={ny} r={2.5} fill={Colors.dark.accent} opacity={0.35} />\n                <Circle cx={nx} cy={ny} r={1} fill={Colors.dark.accent} opacity={0.6} />\n              </G>\n            );\n          })}\n\n          {isConnected && selectedNode && (\n            <>\n              <Line\n                x1={MAP_WIDTH * 0.5}\n                y1={MAP_HEIGHT * 0.5}\n                x2={selectedNode.x * MAP_WIDTH}\n                y2={selectedNode.y * MAP_HEIGHT}\n                stroke={Colors.dark.accent}\n                strokeWidth={0.5}\n                strokeDasharray=\"4 4\"\n                opacity={0.3}\n              />\n              <Circle\n                cx={MAP_WIDTH * 0.5}\n                cy={MAP_HEIGHT * 0.5}\n                r={3}\n                fill={Colors.dark.accentPurple}\n                opacity={0.5}\n              />\n            </>\n          )}\n        </Svg>\n\n        {CITY_NODES.map(node => {\n          const nx = node.x * MAP_WIDTH;\n          const ny = node.y * MAP_HEIGHT;\n          const isSelected = node.serverId === selectedServer?.id;\n          return (\n            <PingNode\n              key={`ping-${node.serverId}`}\n              cx={nx}\n              cy={ny}\n              isSelected={isSelected}\n              isConnected={isConnected}\n            />\n          );\n        })}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    paddingHorizontal: 20,\n  },\n  mapContainer: {\n    backgroundColor: 'rgba(255,255,255,0.02)',\n    borderRadius: 16,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.04)',\n    overflow: 'hidden',\n    ...(Platform.OS === 'web' ? {\n      // @ts-ignore\n      backdropFilter: 'blur(10px)',\n    } : {}),\n  },\n});\n","path":null,"size_bytes":6956,"size_tokens":null},"lib/fingerprint-context.tsx":{"content":"import React, { createContext, useContext, useState, useCallback, useMemo, useEffect, ReactNode } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport {\n  FingerprintShieldState,\n  DEFAULT_SHIELD_STATE,\n  UserAgentProfile,\n  getTimezoneForServer,\n  getTimezoneOffsetForServer,\n  getRandomUserAgent,\n  rotateUserAgent,\n  getShieldSummary,\n  ShieldSummary,\n} from './fingerprint-shield';\nimport { applyWebRTCMask, applyTimezoneSpoofing, applyCanvasNoise } from './fingerprint-runtime';\n\ninterface FingerprintShieldContextValue {\n  state: FingerprintShieldState;\n  summary: ShieldSummary;\n  setWebRTCMask: (enabled: boolean) => void;\n  setTimezoneSpoofing: (enabled: boolean) => void;\n  setCanvasNoise: (enabled: boolean) => void;\n  setUserAgentRotation: (enabled: boolean) => void;\n  setActiveUserAgent: (profile: UserAgentProfile) => void;\n  cycleUserAgent: () => void;\n  updateForServer: (serverFlag: string | null, city?: string) => void;\n  serverFlag: string | null;\n}\n\nconst FingerprintShieldContext = createContext<FingerprintShieldContextValue | null>(null);\n\nconst STORAGE_KEY = 'xvpn_fingerprint_shield';\n\nexport function FingerprintShieldProvider({ children }: { children: ReactNode }) {\n  const [state, setState] = useState<FingerprintShieldState>(DEFAULT_SHIELD_STATE);\n  const [serverFlag, setServerFlag] = useState<string | null>(null);\n  const [serverCity, setServerCity] = useState<string | undefined>(undefined);\n\n  useEffect(() => {\n    AsyncStorage.getItem(STORAGE_KEY).then(data => {\n      if (data) {\n        const saved = JSON.parse(data);\n        setState(prev => ({ ...prev, ...saved }));\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    applyWebRTCMask(state.webrtcMask);\n  }, [state.webrtcMask]);\n\n  useEffect(() => {\n    if (state.timezoneSpoofing && serverFlag) {\n      const tz = getTimezoneForServer(serverFlag, serverCity);\n      const offset = getTimezoneOffsetForServer(serverFlag, serverCity);\n      applyTimezoneSpoofing(true, tz, offset);\n    } else {\n      applyTimezoneSpoofing(false, null, 0);\n    }\n  }, [state.timezoneSpoofing, serverFlag, serverCity]);\n\n  useEffect(() => {\n    applyCanvasNoise(state.canvasNoise, state.canvasNoiseLevel);\n  }, [state.canvasNoise, state.canvasNoiseLevel]);\n\n  const persistState = useCallback((newState: Partial<FingerprintShieldState>) => {\n    setState(prev => {\n      const updated = { ...prev, ...newState };\n      AsyncStorage.setItem(STORAGE_KEY, JSON.stringify({\n        webrtcMask: updated.webrtcMask,\n        timezoneSpoofing: updated.timezoneSpoofing,\n        canvasNoise: updated.canvasNoise,\n        userAgentRotation: updated.userAgentRotation,\n        activeUserAgent: updated.activeUserAgent,\n        canvasNoiseLevel: updated.canvasNoiseLevel,\n      }));\n      return updated;\n    });\n  }, []);\n\n  const setWebRTCMask = useCallback((enabled: boolean) => {\n    persistState({ webrtcMask: enabled });\n  }, [persistState]);\n\n  const setTimezoneSpoofing = useCallback((enabled: boolean) => {\n    persistState({ timezoneSpoofing: enabled });\n  }, [persistState]);\n\n  const setCanvasNoise = useCallback((enabled: boolean) => {\n    persistState({ canvasNoise: enabled });\n  }, [persistState]);\n\n  const setUserAgentRotation = useCallback((enabled: boolean) => {\n    if (enabled) {\n      const ua = getRandomUserAgent(state.activeUserAgent);\n      persistState({ userAgentRotation: true, currentUserAgentString: ua });\n    } else {\n      persistState({ userAgentRotation: false, currentUserAgentString: null });\n    }\n  }, [persistState, state.activeUserAgent]);\n\n  const setActiveUserAgent = useCallback((profile: UserAgentProfile) => {\n    const ua = getRandomUserAgent(profile);\n    persistState({ activeUserAgent: profile, currentUserAgentString: state.userAgentRotation ? ua : null });\n  }, [persistState, state.userAgentRotation]);\n\n  const cycleUserAgent = useCallback(() => {\n    const nextProfile = rotateUserAgent(state.activeUserAgent);\n    const ua = getRandomUserAgent(nextProfile);\n    persistState({ activeUserAgent: nextProfile, currentUserAgentString: ua });\n  }, [persistState, state.activeUserAgent]);\n\n  const updateForServer = useCallback((flag: string | null, city?: string) => {\n    setServerFlag(flag);\n    setServerCity(city);\n    if (flag && state.timezoneSpoofing) {\n      const tz = getTimezoneForServer(flag, city);\n      setState(prev => ({ ...prev, spoofedTimezone: tz }));\n    } else {\n      setState(prev => ({ ...prev, spoofedTimezone: null }));\n    }\n  }, [state.timezoneSpoofing]);\n\n  const summary = useMemo(() => getShieldSummary(state, serverFlag), [state, serverFlag]);\n\n  const value = useMemo(() => ({\n    state,\n    summary,\n    setWebRTCMask,\n    setTimezoneSpoofing,\n    setCanvasNoise,\n    setUserAgentRotation,\n    setActiveUserAgent,\n    cycleUserAgent,\n    updateForServer,\n    serverFlag,\n  }), [state, summary, setWebRTCMask, setTimezoneSpoofing, setCanvasNoise, setUserAgentRotation, setActiveUserAgent, cycleUserAgent, updateForServer, serverFlag]);\n\n  return (\n    <FingerprintShieldContext.Provider value={value}>\n      {children}\n    </FingerprintShieldContext.Provider>\n  );\n}\n\nexport function useFingerprintShield() {\n  const ctx = useContext(FingerprintShieldContext);\n  if (!ctx) throw new Error('useFingerprintShield must be used within FingerprintShieldProvider');\n  return ctx;\n}\n","path":null,"size_bytes":5364,"size_tokens":null},"components/components/IPInfoCard.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, Text, StyleSheet, Platform } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withRepeat,\n  withTiming,\n  Easing,\n} from 'react-native-reanimated';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport { GlassCard } from '@/components/GlassCard';\nimport Colors from '@/constants/colors';\n\ninterface IPInfoCardProps {\n  isConnected: boolean;\n  virtualIp: string;\n  serverCity: string;\n  serverCountry: string;\n}\n\nfunction PulsingDot({ color, active }: { color: string; active: boolean }) {\n  const scale = useSharedValue(1);\n\n  useEffect(() => {\n    if (active) {\n      scale.value = withRepeat(withTiming(1.6, { duration: 1200, easing: Easing.inOut(Easing.ease) }), -1, true);\n    } else {\n      scale.value = withTiming(1);\n    }\n  }, [active]);\n\n  const dotStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n    opacity: active ? 0.6 : 0.2,\n  }));\n\n  return (\n    <View style={dotStyles.container}>\n      <Animated.View style={[dotStyles.outerRing, { borderColor: color }, dotStyle]} />\n      <View style={[dotStyles.innerDot, { backgroundColor: color }]} />\n    </View>\n  );\n}\n\nconst dotStyles = StyleSheet.create({\n  container: {\n    width: 20,\n    height: 20,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  outerRing: {\n    position: 'absolute',\n    width: 16,\n    height: 16,\n    borderRadius: 8,\n    borderWidth: 1,\n  },\n  innerDot: {\n    width: 6,\n    height: 6,\n    borderRadius: 3,\n  },\n});\n\nexport function IPInfoCard({ isConnected, virtualIp, serverCity, serverCountry }: IPInfoCardProps) {\n  const glowColor = isConnected ? Colors.dark.accent : undefined;\n\n  return (\n    <GlassCard style={styles.card} intensity=\"medium\" glowColor={glowColor}>\n      <View style={styles.headerRow}>\n        <View style={styles.headerLeft}>\n          <MaterialCommunityIcons name=\"ip-network-outline\" size={18} color={Colors.dark.accent} />\n          <Text style={styles.headerTitle}>IP Information</Text>\n        </View>\n        <PulsingDot color={isConnected ? Colors.dark.success : Colors.dark.textMuted} active={isConnected} />\n      </View>\n\n      <View style={styles.divider} />\n\n      <View style={styles.infoRow}>\n        <View style={styles.infoLeft}>\n          <View style={[styles.infoIcon, { backgroundColor: 'rgba(0,240,255,0.08)' }]}>\n            <MaterialCommunityIcons name=\"ip\" size={14} color={Colors.dark.accent} />\n          </View>\n          <Text style={styles.infoLabel}>Virtual IP</Text>\n        </View>\n        <Text style={[styles.infoValue, { color: isConnected ? Colors.dark.accent : Colors.dark.textMuted }]}>\n          {isConnected ? virtualIp : '---'}\n        </Text>\n      </View>\n\n      <View style={styles.infoRow}>\n        <View style={styles.infoLeft}>\n          <View style={[styles.infoIcon, { backgroundColor: 'rgba(195,0,255,0.08)' }]}>\n            <Ionicons name=\"business-outline\" size={13} color={Colors.dark.accentPurple} />\n          </View>\n          <Text style={styles.infoLabel}>ISP</Text>\n        </View>\n        <Text style={[styles.infoValue, { color: isConnected ? Colors.dark.accentPurple : Colors.dark.textMuted }]}>\n          {isConnected ? 'xVPN Secure Network' : '---'}\n        </Text>\n      </View>\n\n      <View style={styles.infoRow}>\n        <View style={styles.infoLeft}>\n          <View style={[styles.infoIcon, { backgroundColor: 'rgba(0,230,118,0.08)' }]}>\n            <Ionicons name=\"location-outline\" size={13} color={Colors.dark.success} />\n          </View>\n          <Text style={styles.infoLabel}>Location</Text>\n        </View>\n        <Text style={[styles.infoValue, { color: isConnected ? Colors.dark.success : Colors.dark.textMuted }]}>\n          {isConnected ? `${serverCity}, ${serverCountry}` : '---'}\n        </Text>\n      </View>\n\n      {isConnected && (\n        <View style={styles.secureBanner}>\n          <Ionicons name=\"shield-checkmark\" size={12} color={Colors.dark.success} />\n          <Text style={styles.secureText}>Your real IP is hidden</Text>\n        </View>\n      )}\n    </GlassCard>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    marginHorizontal: 20,\n    padding: 16,\n  },\n  headerRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  headerLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  headerTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 11,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  divider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    marginVertical: 12,\n  },\n  infoRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingVertical: 8,\n  },\n  infoLeft: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  infoIcon: {\n    width: 28,\n    height: 28,\n    borderRadius: 8,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  infoLabel: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 12,\n    color: '#FFFFFF',\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  infoValue: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 12,\n  },\n  secureBanner: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n    backgroundColor: 'rgba(0,230,118,0.06)',\n    borderWidth: 1,\n    borderColor: 'rgba(0,230,118,0.12)',\n    borderRadius: 10,\n    padding: 10,\n    marginTop: 8,\n  },\n  secureText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 10,\n    color: Colors.dark.success,\n    letterSpacing: 0.5,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n});\n","path":null,"size_bytes":5819,"size_tokens":null},"components/components/KeyboardAwareScrollViewCompat.tsx":{"content":"// template\nimport { Platform, ScrollView, ScrollViewProps } from \"react-native\";\nimport {\n  KeyboardAwareScrollView,\n  KeyboardAwareScrollViewProps,\n} from \"react-native-keyboard-controller\";\n\ntype Props = KeyboardAwareScrollViewProps & ScrollViewProps;\n\nexport function KeyboardAwareScrollViewCompat({\n  children,\n  keyboardShouldPersistTaps = \"handled\",\n  ...props\n}: Props) {\n  if (Platform.OS === \"web\") {\n    return (\n      <ScrollView keyboardShouldPersistTaps={keyboardShouldPersistTaps} {...props}>\n        {children}\n      </ScrollView>\n    );\n  }\n  return (\n    <KeyboardAwareScrollView\n      keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n      {...props}\n    >\n      {children}\n    </KeyboardAwareScrollView>\n  );\n}\n","path":null,"size_bytes":736,"size_tokens":null},"components/SubscriptionModal.tsx":{"content":"import React, { useState } from 'react';\nimport { View, Text, StyleSheet, Pressable, Modal, Platform, ActivityIndicator } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport { GlassCard } from '@/components/GlassCard';\nimport { useVpn } from '@/lib/vpn-context';\nimport Colors from '@/constants/colors';\n\ninterface Plan {\n  id: string;\n  name: string;\n  price: string;\n  period: string;\n  savings?: string;\n  recommended?: boolean;\n}\n\nconst PLANS: Plan[] = [\n  { id: 'monthly', name: 'Monthly', price: '$9.99', period: '/month' },\n  { id: 'yearly', name: 'Yearly', price: '$4.99', period: '/month', savings: 'Save 50%', recommended: true },\n  { id: 'lifetime', name: 'Lifetime', price: '$149.99', period: 'one-time', savings: 'Best Value' },\n];\n\ninterface SubscriptionModalProps {\n  visible: boolean;\n  onClose: () => void;\n  serverName?: string;\n}\n\nexport function SubscriptionModal({ visible, onClose, serverName }: SubscriptionModalProps) {\n  const { setSubscription, setPremium } = useVpn();\n  const [selectedPlan, setSelectedPlan] = useState<string>('yearly');\n  const [loading, setLoading] = useState(false);\n\n  const handleSubscribe = async () => {\n    if (Platform.OS !== 'web') {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy);\n    }\n    setLoading(true);\n\n    setTimeout(() => {\n      const plan = PLANS.find(p => p.id === selectedPlan)!;\n      let expiresAt: string;\n      const now = new Date();\n      if (plan.id === 'monthly') {\n        expiresAt = new Date(now.setMonth(now.getMonth() + 1)).toISOString();\n      } else if (plan.id === 'yearly') {\n        expiresAt = new Date(now.setFullYear(now.getFullYear() + 1)).toISOString();\n      } else {\n        expiresAt = new Date(now.setFullYear(now.getFullYear() + 99)).toISOString();\n      }\n      setSubscription(plan.id, expiresAt);\n      setPremium(true);\n      setLoading(false);\n      onClose();\n    }, 2000);\n  };\n\n  return (\n    <Modal visible={visible} transparent animationType=\"slide\" onRequestClose={onClose}>\n      <View style={styles.overlay}>\n        <View style={styles.container}>\n          <View style={styles.handle} />\n\n          <View style={styles.header}>\n            <View style={styles.premiumIcon}>\n              <Ionicons name=\"diamond\" size={28} color={Colors.dark.accentPurple} />\n            </View>\n            <Text style={styles.title}>Premium Access</Text>\n            <Text style={styles.subtitle}>\n              {serverName ? `Unlock ${serverName} and all premium servers` : 'Unlock all premium servers worldwide'}\n            </Text>\n          </View>\n\n          <View style={styles.features}>\n            {['50+ Premium Server Locations', 'Residential IP Masking', 'Multi-Hop Double VPN', 'Priority Bandwidth'].map((feature, i) => (\n              <View key={i} style={styles.featureRow}>\n                <Ionicons name=\"checkmark-circle\" size={18} color={Colors.dark.success} />\n                <Text style={styles.featureText}>{feature}</Text>\n              </View>\n            ))}\n          </View>\n\n          <View style={styles.plans}>\n            {PLANS.map((plan) => (\n              <Pressable\n                key={plan.id}\n                onPress={() => {\n                  if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                  setSelectedPlan(plan.id);\n                }}\n              >\n                <View style={[\n                  styles.planCard,\n                  selectedPlan === plan.id && styles.planCardSelected,\n                  plan.recommended && selectedPlan === plan.id && styles.planCardRecommended,\n                ]}>\n                  {plan.recommended && (\n                    <View style={styles.recommendedBadge}>\n                      <Text style={styles.recommendedText}>RECOMMENDED</Text>\n                    </View>\n                  )}\n                  <View style={styles.planRow}>\n                    <View style={[styles.radio, selectedPlan === plan.id && styles.radioSelected]}>\n                      {selectedPlan === plan.id && <View style={styles.radioDot} />}\n                    </View>\n                    <View style={styles.planInfo}>\n                      <Text style={[styles.planName, selectedPlan === plan.id && styles.planNameSelected]}>{plan.name}</Text>\n                      <View style={styles.priceRow}>\n                        <Text style={[styles.planPrice, selectedPlan === plan.id && styles.planPriceSelected]}>{plan.price}</Text>\n                        <Text style={styles.planPeriod}>{plan.period}</Text>\n                      </View>\n                    </View>\n                    {plan.savings && (\n                      <View style={styles.savingsBadge}>\n                        <Text style={styles.savingsText}>{plan.savings}</Text>\n                      </View>\n                    )}\n                  </View>\n                </View>\n              </Pressable>\n            ))}\n          </View>\n\n          <Pressable\n            style={[styles.subscribeButton, loading && styles.subscribeButtonLoading]}\n            onPress={handleSubscribe}\n            disabled={loading}\n          >\n            {loading ? (\n              <ActivityIndicator color=\"#000\" />\n            ) : (\n              <>\n                <Ionicons name=\"lock-closed\" size={18} color=\"#000\" />\n                <Text style={styles.subscribeButtonText}>Subscribe & Unlock</Text>\n              </>\n            )}\n          </Pressable>\n\n          <Pressable onPress={onClose} style={styles.cancelButton}>\n            <Text style={styles.cancelText}>Maybe Later</Text>\n          </Pressable>\n\n          <Text style={styles.disclaimer}>Cancel anytime. Secure payment via Stripe.</Text>\n        </View>\n      </View>\n    </Modal>\n  );\n}\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.7)',\n    justifyContent: 'flex-end',\n  },\n  container: {\n    backgroundColor: '#1A1A2E',\n    borderTopLeftRadius: 28,\n    borderTopRightRadius: 28,\n    paddingHorizontal: 24,\n    paddingBottom: Platform.OS === 'ios' ? 40 : 24,\n    paddingTop: 12,\n    maxHeight: '90%',\n  },\n  handle: {\n    width: 36,\n    height: 4,\n    backgroundColor: 'rgba(255,255,255,0.2)',\n    borderRadius: 2,\n    alignSelf: 'center',\n    marginBottom: 20,\n  },\n  header: {\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n  premiumIcon: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: 'rgba(195,0,255,0.15)',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: 12,\n  },\n  title: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 20,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  subtitle: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 13,\n    color: Colors.dark.textSecondary,\n    textAlign: 'center',\n    marginTop: 8,\n    lineHeight: 18,\n  },\n  features: {\n    gap: 10,\n    marginBottom: 20,\n  },\n  featureRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 10,\n  },\n  featureText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    color: Colors.dark.text,\n  },\n  plans: {\n    gap: 10,\n    marginBottom: 20,\n  },\n  planCard: {\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.08)',\n    borderRadius: 16,\n    padding: 16,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n  },\n  planCardSelected: {\n    borderColor: Colors.dark.accent,\n    backgroundColor: 'rgba(0,240,255,0.05)',\n  },\n  planCardRecommended: {\n    borderColor: Colors.dark.accentPurple,\n    backgroundColor: 'rgba(195,0,255,0.05)',\n  },\n  recommendedBadge: {\n    position: 'absolute',\n    top: -9,\n    right: 12,\n    backgroundColor: Colors.dark.accentPurple,\n    paddingHorizontal: 8,\n    paddingVertical: 2,\n    borderRadius: 6,\n  },\n  recommendedText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 7,\n    color: '#FFF',\n    letterSpacing: 1,\n  },\n  planRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 12,\n  },\n  radio: {\n    width: 22,\n    height: 22,\n    borderRadius: 11,\n    borderWidth: 2,\n    borderColor: 'rgba(255,255,255,0.2)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  radioSelected: {\n    borderColor: Colors.dark.accent,\n  },\n  radioDot: {\n    width: 10,\n    height: 10,\n    borderRadius: 5,\n    backgroundColor: Colors.dark.accent,\n  },\n  planInfo: {\n    flex: 1,\n  },\n  planName: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 16,\n    color: Colors.dark.textSecondary,\n  },\n  planNameSelected: {\n    color: Colors.dark.text,\n  },\n  priceRow: {\n    flexDirection: 'row',\n    alignItems: 'baseline',\n    gap: 4,\n    marginTop: 2,\n  },\n  planPrice: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 18,\n    color: Colors.dark.textSecondary,\n  },\n  planPriceSelected: {\n    color: Colors.dark.accent,\n  },\n  planPeriod: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textMuted,\n  },\n  savingsBadge: {\n    backgroundColor: 'rgba(0,230,118,0.15)',\n    paddingHorizontal: 8,\n    paddingVertical: 4,\n    borderRadius: 8,\n  },\n  savingsText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 10,\n    color: Colors.dark.success,\n    letterSpacing: 0.5,\n  },\n  subscribeButton: {\n    backgroundColor: Colors.dark.accent,\n    borderRadius: 16,\n    paddingVertical: 16,\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 8,\n  },\n  subscribeButtonLoading: {\n    opacity: 0.7,\n  },\n  subscribeButtonText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 14,\n    color: '#000',\n    letterSpacing: 1,\n  },\n  cancelButton: {\n    alignItems: 'center',\n    paddingVertical: 14,\n  },\n  cancelText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 14,\n    color: Colors.dark.textMuted,\n  },\n  disclaimer: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n    textAlign: 'center',\n    opacity: 0.6,\n  },\n});\n","path":null,"size_bytes":9972,"size_tokens":null},"components/AuthScreen.tsx":{"content":"import React, { useState } from 'react';\nimport { View, Text, TextInput, StyleSheet, Pressable, Platform, ActivityIndicator, KeyboardAvoidingView, ScrollView } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport { useAuth } from '@/lib/auth-context';\nimport Colors from '@/constants/colors';\n\nexport function AuthScreen() {\n  const { login, signup } = useAuth();\n  const [mode, setMode] = useState<'login' | 'signup'>('login');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [displayName, setDisplayName] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [showPassword, setShowPassword] = useState(false);\n\n  const handleSubmit = async () => {\n    setError(null);\n\n    if (!email.trim() || !password.trim()) {\n      setError('Please fill in all fields');\n      return;\n    }\n\n    if (mode === 'signup' && !displayName.trim()) {\n      setError('Please enter a display name');\n      return;\n    }\n\n    if (password.length < 6) {\n      setError('Password must be at least 6 characters');\n      return;\n    }\n\n    if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    setLoading(true);\n\n    try {\n      let success: boolean;\n      if (mode === 'login') {\n        success = await login(email, password);\n        if (!success) setError('Invalid email or password');\n      } else {\n        success = await signup(email, password, displayName);\n        if (!success) setError('Account already exists with this email');\n      }\n    } catch {\n      setError('Something went wrong. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <KeyboardAvoidingView\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n        style={styles.keyboardView}\n      >\n        <ScrollView\n          contentContainerStyle={styles.scrollContent}\n          showsVerticalScrollIndicator={false}\n          keyboardShouldPersistTaps=\"handled\"\n        >\n          <View style={styles.header}>\n            <View style={styles.logoContainer}>\n              <View style={styles.logoRing}>\n                <Ionicons name=\"shield-checkmark\" size={36} color={Colors.dark.accent} />\n              </View>\n            </View>\n            <Text style={styles.brand}>xVPN</Text>\n            <Text style={styles.tagline}>Deep Space Security</Text>\n          </View>\n\n          <View style={styles.formCard}>\n            <View style={styles.tabRow}>\n              <Pressable\n                style={[styles.tab, mode === 'login' && styles.tabActive]}\n                onPress={() => { setMode('login'); setError(null); }}\n              >\n                <Text style={[styles.tabText, mode === 'login' && styles.tabTextActive]}>Sign In</Text>\n              </Pressable>\n              <Pressable\n                style={[styles.tab, mode === 'signup' && styles.tabActive]}\n                onPress={() => { setMode('signup'); setError(null); }}\n              >\n                <Text style={[styles.tabText, mode === 'signup' && styles.tabTextActive]}>Sign Up</Text>\n              </Pressable>\n            </View>\n\n            {mode === 'signup' && (\n              <View style={styles.inputGroup}>\n                <Text style={styles.inputLabel}>DISPLAY NAME</Text>\n                <View style={styles.inputContainer}>\n                  <Ionicons name=\"person-outline\" size={16} color={Colors.dark.textMuted} style={styles.inputIcon} />\n                  <TextInput\n                    style={styles.input}\n                    value={displayName}\n                    onChangeText={setDisplayName}\n                    placeholder=\"Your name\"\n                    placeholderTextColor={Colors.dark.textMuted}\n                    autoCapitalize=\"words\"\n                  />\n                </View>\n              </View>\n            )}\n\n            <View style={styles.inputGroup}>\n              <Text style={styles.inputLabel}>EMAIL</Text>\n              <View style={styles.inputContainer}>\n                <Ionicons name=\"mail-outline\" size={16} color={Colors.dark.textMuted} style={styles.inputIcon} />\n                <TextInput\n                  style={styles.input}\n                  value={email}\n                  onChangeText={setEmail}\n                  placeholder=\"you@email.com\"\n                  placeholderTextColor={Colors.dark.textMuted}\n                  keyboardType=\"email-address\"\n                  autoCapitalize=\"none\"\n                  autoCorrect={false}\n                />\n              </View>\n            </View>\n\n            <View style={styles.inputGroup}>\n              <Text style={styles.inputLabel}>PASSWORD</Text>\n              <View style={styles.inputContainer}>\n                <Ionicons name=\"lock-closed-outline\" size={16} color={Colors.dark.textMuted} style={styles.inputIcon} />\n                <TextInput\n                  style={styles.input}\n                  value={password}\n                  onChangeText={setPassword}\n                  placeholder=\"Min 6 characters\"\n                  placeholderTextColor={Colors.dark.textMuted}\n                  secureTextEntry={!showPassword}\n                  autoCapitalize=\"none\"\n                />\n                <Pressable onPress={() => setShowPassword(!showPassword)} hitSlop={8}>\n                  <Ionicons name={showPassword ? 'eye-off-outline' : 'eye-outline'} size={18} color={Colors.dark.textMuted} />\n                </Pressable>\n              </View>\n            </View>\n\n            {error && (\n              <View style={styles.errorContainer}>\n                <Ionicons name=\"alert-circle\" size={14} color={Colors.dark.accentCoral} />\n                <Text style={styles.errorText}>{error}</Text>\n              </View>\n            )}\n\n            <Pressable\n              style={[styles.submitButton, loading && styles.submitButtonLoading]}\n              onPress={handleSubmit}\n              disabled={loading}\n            >\n              {loading ? (\n                <ActivityIndicator color=\"#000\" />\n              ) : (\n                <>\n                  <Ionicons name={mode === 'login' ? 'log-in-outline' : 'person-add-outline'} size={18} color=\"#000\" />\n                  <Text style={styles.submitText}>{mode === 'login' ? 'Sign In' : 'Create Account'}</Text>\n                </>\n              )}\n            </Pressable>\n          </View>\n\n          <View style={styles.features}>\n            {['Military-grade encryption', 'Zero-log policy', '50+ server locations'].map((f, i) => (\n              <View key={i} style={styles.featureRow}>\n                <Ionicons name=\"checkmark-circle\" size={14} color={Colors.dark.success} />\n                <Text style={styles.featureText}>{f}</Text>\n              </View>\n            ))}\n          </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#0A0A1A',\n  },\n  keyboardView: {\n    flex: 1,\n  },\n  scrollContent: {\n    flexGrow: 1,\n    justifyContent: 'center',\n    paddingHorizontal: 28,\n    paddingVertical: 40,\n  },\n  header: {\n    alignItems: 'center',\n    marginBottom: 36,\n  },\n  logoContainer: {\n    marginBottom: 16,\n  },\n  logoRing: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    backgroundColor: 'rgba(0, 240, 255, 0.06)',\n    borderWidth: 2,\n    borderColor: 'rgba(0, 240, 255, 0.2)',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  brand: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 32,\n    color: Colors.dark.accent,\n    letterSpacing: 6,\n  },\n  tagline: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 13,\n    color: Colors.dark.textMuted,\n    marginTop: 6,\n    letterSpacing: 2,\n  },\n  formCard: {\n    backgroundColor: 'rgba(255, 255, 255, 0.03)',\n    borderWidth: 1,\n    borderColor: 'rgba(255, 255, 255, 0.06)',\n    borderRadius: 20,\n    padding: 24,\n    gap: 16,\n  },\n  tabRow: {\n    flexDirection: 'row',\n    backgroundColor: 'rgba(255, 255, 255, 0.03)',\n    borderRadius: 12,\n    padding: 3,\n    marginBottom: 4,\n  },\n  tab: {\n    flex: 1,\n    paddingVertical: 10,\n    alignItems: 'center',\n    borderRadius: 10,\n  },\n  tabActive: {\n    backgroundColor: 'rgba(0, 240, 255, 0.1)',\n    borderWidth: 1,\n    borderColor: 'rgba(0, 240, 255, 0.2)',\n  },\n  tabText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 13,\n    color: Colors.dark.textMuted,\n  },\n  tabTextActive: {\n    color: Colors.dark.accent,\n  },\n  inputGroup: {\n    gap: 6,\n  },\n  inputLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    letterSpacing: 3,\n    marginLeft: 4,\n  },\n  inputContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: 'rgba(255, 255, 255, 0.04)',\n    borderWidth: 1,\n    borderColor: 'rgba(255, 255, 255, 0.08)',\n    borderRadius: 14,\n    paddingHorizontal: 14,\n  },\n  inputIcon: {\n    marginRight: 10,\n  },\n  input: {\n    flex: 1,\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 14,\n    color: Colors.dark.text,\n    paddingVertical: 14,\n  },\n  errorContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n    backgroundColor: 'rgba(255, 46, 99, 0.08)',\n    borderWidth: 1,\n    borderColor: 'rgba(255, 46, 99, 0.15)',\n    borderRadius: 10,\n    paddingHorizontal: 12,\n    paddingVertical: 10,\n  },\n  errorText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.accentCoral,\n    flex: 1,\n  },\n  submitButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 8,\n    backgroundColor: Colors.dark.accent,\n    borderRadius: 14,\n    paddingVertical: 16,\n    marginTop: 4,\n  },\n  submitButtonLoading: {\n    opacity: 0.7,\n  },\n  submitText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 13,\n    color: '#000',\n    letterSpacing: 1,\n  },\n  features: {\n    marginTop: 28,\n    gap: 10,\n    alignItems: 'center',\n  },\n  featureRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  featureText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n});\n","path":null,"size_bytes":10302,"size_tokens":null},"components/components/ServerCard.tsx":{"content":"import React from 'react';\nimport { View, Text, Pressable, StyleSheet, ViewStyle } from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport { GlassCard } from '@/components/GlassCard';\nimport Colors from '@/constants/colors';\nimport type { VpnServer } from '@/lib/vpn-context';\n\nconst REGION_COLORS: Record<string, string> = {\n  US: Colors.dark.accent,\n  GB: Colors.dark.accentPurple,\n  DE: Colors.dark.accentPurple,\n  JP: '#FF6B6B',\n  SG: '#FF6B6B',\n  AU: Colors.dark.warning,\n  CA: Colors.dark.accent,\n  NL: Colors.dark.accentPurple,\n  CH: Colors.dark.accentPurple,\n  FR: Colors.dark.accentPurple,\n  KR: '#FF6B6B',\n  BR: Colors.dark.success,\n  IN: '#FF6B6B',\n  SE: Colors.dark.accentPurple,\n};\n\ninterface ServerCardProps {\n  server: VpnServer;\n  isSelected: boolean;\n  isFavorite: boolean;\n  onSelect: () => void;\n  onToggleFavorite: () => void;\n}\n\nexport function ServerCard({ server, isSelected, isFavorite, onSelect, onToggleFavorite }: ServerCardProps) {\n  const pingColor = server.ping < 50 ? Colors.dark.success : server.ping < 100 ? Colors.dark.warning : Colors.dark.danger;\n  const loadColor = server.load < 40 ? Colors.dark.success : server.load < 70 ? Colors.dark.warning : Colors.dark.danger;\n\n  const handlePress = () => {\n    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    onSelect();\n  };\n\n  return (\n    <Pressable onPress={handlePress}>\n      <GlassCard\n        style={[styles.card, isSelected && styles.selectedCard] as ViewStyle}\n        intensity={isSelected ? 'high' : 'low'}\n        glowColor={isSelected ? Colors.dark.accent : undefined}\n      >\n        <View style={styles.row}>\n          <View style={styles.leftSection}>\n            <View style={[styles.iconContainer, isSelected && styles.iconContainerSelected]}>\n              <Ionicons\n                name=\"globe-outline\"\n                size={22}\n                color={isSelected ? Colors.dark.accent : (REGION_COLORS[server.flag] || Colors.dark.textSecondary)}\n              />\n            </View>\n            <View style={styles.textGroup}>\n              <View style={styles.nameRow}>\n                <Text style={[styles.name, isSelected && styles.nameSelected]}>{server.name}</Text>\n                {server.premium && (\n                  <View style={styles.premiumBadge}>\n                    <Ionicons name=\"diamond\" size={10} color={Colors.dark.accentPurple} />\n                  </View>\n                )}\n              </View>\n              <Text style={styles.city}>{server.city}, {server.country}</Text>\n            </View>\n          </View>\n          <View style={styles.rightSection}>\n            <View style={styles.statsRow}>\n              <View style={styles.stat}>\n                <View style={[styles.statDot, { backgroundColor: pingColor }]} />\n                <Text style={styles.statText}>{server.ping}ms</Text>\n              </View>\n              <View style={styles.stat}>\n                <Ionicons name=\"speedometer-outline\" size={12} color={loadColor} />\n                <Text style={styles.statText}>{server.load}%</Text>\n              </View>\n            </View>\n            <Pressable\n              onPress={(e) => {\n                e.stopPropagation?.();\n                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                onToggleFavorite();\n              }}\n              hitSlop={12}\n            >\n              <Ionicons\n                name={isFavorite ? 'star' : 'star-outline'}\n                size={18}\n                color={isFavorite ? '#00f2ff' : Colors.dark.textMuted}\n              />\n            </Pressable>\n          </View>\n        </View>\n      </GlassCard>\n    </Pressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    marginHorizontal: 20,\n    marginBottom: 10,\n    padding: 16,\n  },\n  selectedCard: {\n    borderColor: 'rgba(0, 240, 255, 0.2)',\n  },\n  row: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  leftSection: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  iconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: 12,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: 12,\n  },\n  iconContainerSelected: {\n    backgroundColor: 'rgba(0, 240, 255, 0.08)',\n  },\n  textGroup: {\n    flex: 1,\n  },\n  nameRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n  },\n  name: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 15,\n    color: Colors.dark.text,\n  },\n  nameSelected: {\n    color: Colors.dark.accent,\n  },\n  premiumBadge: {\n    width: 18,\n    height: 18,\n    borderRadius: 9,\n    backgroundColor: 'rgba(195, 0, 255, 0.15)',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  city: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 12,\n    color: Colors.dark.accent,\n    marginTop: 2,\n    letterSpacing: 0.3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n  rightSection: {\n    alignItems: 'flex-end',\n    gap: 8,\n  },\n  statsRow: {\n    flexDirection: 'row',\n    gap: 10,\n  },\n  stat: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n  },\n  statDot: {\n    width: 5,\n    height: 5,\n    borderRadius: 2.5,\n  },\n  statText: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 11,\n    color: '#FFFFFF',\n    letterSpacing: 0.3,\n    textShadowColor: 'rgba(0,0,0,0.8)',\n    textShadowOffset: { width: 0, height: 2 },\n    textShadowRadius: 2,\n  },\n});\n","path":null,"size_bytes":5586,"size_tokens":null},"backend/__init__.py":{"content":"","path":null,"size_bytes":0,"size_tokens":null},"components/FingerprintShieldPanel.tsx":{"content":"import React, { useEffect, useState } from 'react';\nimport { View, Text, StyleSheet, Modal, Pressable, ScrollView, Switch, Platform, Dimensions } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withSpring,\n  withTiming,\n} from 'react-native-reanimated';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport { GlassCard } from '@/components/GlassCard';\nimport { useFingerprintShield } from '@/lib/fingerprint-context';\nimport { USER_AGENT_LABELS, UserAgentProfile } from '@/lib/fingerprint-shield';\nimport Colors from '@/constants/colors';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\nconst PANEL_WIDTH = Math.min(SCREEN_WIDTH * 0.92, 400);\n\nconst UA_PROFILES: UserAgentProfile[] = ['windows_chrome', 'windows_firefox', 'mac_safari', 'mac_chrome', 'iphone_safari'];\n\ninterface FingerprintShieldPanelProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\nfunction ProtectionMeter({ active, total }: { active: number; total: number }) {\n  const segments = Array.from({ length: total }, (_, i) => i < active);\n  const levelColor = active === 4 ? Colors.dark.success : active >= 2 ? Colors.dark.warning : active >= 1 ? Colors.dark.accentCoral : Colors.dark.textMuted;\n  const levelLabel = active === 4 ? 'MAXIMUM' : active >= 2 ? 'MODERATE' : active >= 1 ? 'BASIC' : 'NONE';\n\n  return (\n    <View style={meterStyles.container}>\n      <View style={meterStyles.barRow}>\n        {segments.map((filled, i) => (\n          <View\n            key={i}\n            style={[\n              meterStyles.segment,\n              { backgroundColor: filled ? levelColor : 'rgba(255,255,255,0.06)' },\n            ]}\n          />\n        ))}\n      </View>\n      <View style={meterStyles.labelRow}>\n        <Text style={[meterStyles.levelText, { color: levelColor }]}>{levelLabel}</Text>\n        <Text style={meterStyles.countText}>{active}/{total} active</Text>\n      </View>\n    </View>\n  );\n}\n\nconst meterStyles = StyleSheet.create({\n  container: {\n    gap: 6,\n  },\n  barRow: {\n    flexDirection: 'row',\n    gap: 3,\n  },\n  segment: {\n    flex: 1,\n    height: 4,\n    borderRadius: 2,\n  },\n  labelRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  levelText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    letterSpacing: 2,\n  },\n  countText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n  },\n});\n\nexport function FingerprintShieldPanel({ visible, onClose }: FingerprintShieldPanelProps) {\n  const insets = useSafeAreaInsets();\n  const {\n    state,\n    summary,\n    setWebRTCMask,\n    setTimezoneSpoofing,\n    setCanvasNoise,\n    setUserAgentRotation,\n    setActiveUserAgent,\n    cycleUserAgent,\n  } = useFingerprintShield();\n\n  const topPadding = Platform.OS === 'web' ? 67 : insets.top;\n  const bottomPadding = Platform.OS === 'web' ? 34 : insets.bottom;\n  const scale = useSharedValue(0.9);\n  const animOpacity = useSharedValue(0);\n  const [uaExpanded, setUaExpanded] = useState(false);\n\n  useEffect(() => {\n    if (visible) {\n      scale.value = withSpring(1, { damping: 20, stiffness: 200 });\n      animOpacity.value = withTiming(1, { duration: 200 });\n    } else {\n      scale.value = withTiming(0.9, { duration: 200 });\n      animOpacity.value = withTiming(0, { duration: 200 });\n    }\n  }, [visible]);\n\n  const panelAnimStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n    opacity: animOpacity.value,\n  }));\n\n  const hapticToggle = (fn: (v: boolean) => void) => (v: boolean) => {\n    if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    fn(v);\n  };\n\n  return (\n    <Modal\n      visible={visible}\n      transparent\n      animationType=\"fade\"\n      onRequestClose={onClose}\n      statusBarTranslucent\n    >\n      <View style={styles.overlay}>\n        <Pressable style={styles.backdropTouch} onPress={onClose} />\n        <Animated.View style={[styles.panel, panelAnimStyle, { paddingTop: 20, paddingBottom: 20 }]}>\n          <View style={styles.panelHeader}>\n            <View style={styles.panelTitleRow}>\n              <MaterialCommunityIcons name=\"fingerprint\" size={20} color={Colors.dark.accent} />\n              <Text style={styles.panelTitle}>Fingerprint Shield</Text>\n            </View>\n            <Pressable onPress={onClose} hitSlop={12}>\n              <Ionicons name=\"close\" size={22} color={Colors.dark.textSecondary} />\n            </Pressable>\n          </View>\n\n          <ScrollView showsVerticalScrollIndicator={false} contentContainerStyle={styles.panelContent}>\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={Colors.dark.accent}>\n              <View style={styles.meterHeader}>\n                <MaterialCommunityIcons name=\"shield-check\" size={16} color={Colors.dark.accent} />\n                <Text style={styles.meterTitle}>Protection Level</Text>\n              </View>\n              <ProtectionMeter active={summary.activeProtections} total={summary.totalProtections} />\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={state.webrtcMask ? Colors.dark.accentCoral : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(255,46,99,0.1)' }]}>\n                    <MaterialCommunityIcons name=\"web-remove\" size={16} color={Colors.dark.accentCoral} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>WebRTC Mask</Text>\n                    <Text style={styles.sectionDesc}>Blocks STUN queries from leaking your real local IP address through WebRTC</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={state.webrtcMask}\n                  onValueChange={hapticToggle(setWebRTCMask)}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(255,46,99,0.3)' }}\n                  thumbColor={state.webrtcMask ? Colors.dark.accentCoral : '#555'}\n                />\n              </View>\n              {state.webrtcMask && (\n                <View style={styles.statusGrid}>\n                  <StatusPill label=\"Local IP\" status=\"Hidden\" color={Colors.dark.success} />\n                  <StatusPill label=\"STUN\" status=\"Blocked\" color={Colors.dark.success} />\n                  <StatusPill label=\"TURN\" status=\"Blocked\" color={Colors.dark.success} />\n                  <StatusPill label=\"mDNS\" status=\"Enabled\" color={Colors.dark.success} />\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={state.timezoneSpoofing ? Colors.dark.accentPurple : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(195,0,255,0.1)' }]}>\n                    <Ionicons name=\"time-outline\" size={16} color={Colors.dark.accentPurple} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>Timezone Spoofing</Text>\n                    <Text style={styles.sectionDesc}>Syncs browser timezone to match your selected VPN server location</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={state.timezoneSpoofing}\n                  onValueChange={hapticToggle(setTimezoneSpoofing)}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(195,0,255,0.3)' }}\n                  thumbColor={state.timezoneSpoofing ? Colors.dark.accentPurple : '#555'}\n                />\n              </View>\n              {state.timezoneSpoofing && summary.timezone.spoofedTimezone && (\n                <View style={styles.infoBox}>\n                  <View style={styles.infoRow}>\n                    <Text style={styles.infoLabel}>Original</Text>\n                    <Text style={styles.infoValue}>{summary.timezone.originalTimezone}</Text>\n                  </View>\n                  <View style={styles.infoDivider} />\n                  <View style={styles.infoRow}>\n                    <Text style={styles.infoLabel}>Spoofed To</Text>\n                    <Text style={[styles.infoValue, { color: Colors.dark.accentPurple }]}>{summary.timezone.spoofedTimezone}</Text>\n                  </View>\n                  <View style={styles.infoDivider} />\n                  <View style={styles.statusGrid}>\n                    <StatusPill label=\"Intl API\" status=\"Patched\" color={Colors.dark.success} />\n                    <StatusPill label=\"Date API\" status=\"Patched\" color={Colors.dark.success} />\n                  </View>\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={state.canvasNoise ? Colors.dark.warning : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(255,179,0,0.1)' }]}>\n                    <MaterialCommunityIcons name=\"image-filter-hdr\" size={16} color={Colors.dark.warning} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>Canvas Defeat</Text>\n                    <Text style={styles.sectionDesc}>Injects subtle noise into Canvas rendering to prevent GPU/hardware fingerprinting</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={state.canvasNoise}\n                  onValueChange={hapticToggle(setCanvasNoise)}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(255,179,0,0.3)' }}\n                  thumbColor={state.canvasNoise ? Colors.dark.warning : '#555'}\n                />\n              </View>\n              {state.canvasNoise && (\n                <View style={styles.statusGrid}>\n                  <StatusPill label=\"Noise\" status={`${(state.canvasNoiseLevel * 100).toFixed(0)}%`} color={Colors.dark.warning} />\n                  <StatusPill label=\"Hash\" status=\"Randomized\" color={Colors.dark.success} />\n                  <StatusPill label=\"GPU Info\" status=\"Masked\" color={Colors.dark.success} />\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={state.userAgentRotation ? Colors.dark.accent : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(0,240,255,0.1)' }]}>\n                    <MaterialCommunityIcons name=\"account-switch\" size={16} color={Colors.dark.accent} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>User-Agent Rotation</Text>\n                    <Text style={styles.sectionDesc}>Cycles between common browser strings to appear as a standard retail user</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={state.userAgentRotation}\n                  onValueChange={hapticToggle(setUserAgentRotation)}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(0,240,255,0.3)' }}\n                  thumbColor={state.userAgentRotation ? Colors.dark.accent : '#555'}\n                />\n              </View>\n\n              <View style={styles.uaDivider} />\n              <Text style={styles.uaSectionLabel}>BROWSER PROFILE</Text>\n\n              <Pressable\n                style={styles.uaTrigger}\n                onPress={() => {\n                  if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                  setUaExpanded(!uaExpanded);\n                }}\n              >\n                <Text style={styles.uaTriggerText}>{USER_AGENT_LABELS[state.activeUserAgent]}</Text>\n                <Ionicons name={uaExpanded ? 'chevron-up' : 'chevron-down'} size={14} color={Colors.dark.textMuted} />\n              </Pressable>\n\n              {uaExpanded && (\n                <View style={styles.uaList}>\n                  {UA_PROFILES.map(profile => {\n                    const isActive = state.activeUserAgent === profile;\n                    return (\n                      <Pressable\n                        key={profile}\n                        style={[styles.uaOption, isActive && styles.uaOptionActive]}\n                        onPress={() => {\n                          if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                          setActiveUserAgent(profile);\n                          setUaExpanded(false);\n                        }}\n                      >\n                        <Text style={[styles.uaOptionText, isActive && styles.uaOptionTextActive]}>\n                          {USER_AGENT_LABELS[profile]}\n                        </Text>\n                        {isActive && <Ionicons name=\"checkmark-circle\" size={14} color={Colors.dark.accent} />}\n                      </Pressable>\n                    );\n                  })}\n                </View>\n              )}\n\n              {state.userAgentRotation && (\n                <Pressable\n                  style={styles.cycleButton}\n                  onPress={() => {\n                    if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n                    cycleUserAgent();\n                  }}\n                >\n                  <MaterialCommunityIcons name=\"refresh\" size={14} color={Colors.dark.accent} />\n                  <Text style={styles.cycleButtonText}>Rotate Now</Text>\n                </Pressable>\n              )}\n\n              {state.userAgentRotation && state.currentUserAgentString && (\n                <View style={styles.uaStringBox}>\n                  <Text style={styles.uaStringLabel}>ACTIVE UA STRING</Text>\n                  <Text style={styles.uaString} numberOfLines={2}>{state.currentUserAgentString}</Text>\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"low\">\n              <View style={styles.disclaimerRow}>\n                <Ionicons name=\"information-circle-outline\" size={16} color={Colors.dark.textMuted} />\n                <Text style={styles.disclaimerText}>\n                  Client-side fingerprint shield works alongside the server-side protection engine for comprehensive anti-tracking defense.\n                </Text>\n              </View>\n            </GlassCard>\n          </ScrollView>\n        </Animated.View>\n      </View>\n    </Modal>\n  );\n}\n\nfunction StatusPill({ label, status, color }: { label: string; status: string; color: string }) {\n  return (\n    <View style={pillStyles.container}>\n      <View style={[pillStyles.dot, { backgroundColor: color }]} />\n      <Text style={pillStyles.label}>{label}</Text>\n      <Text style={[pillStyles.status, { color }]}>{status}</Text>\n    </View>\n  );\n}\n\nconst pillStyles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.05)',\n    borderRadius: 8,\n    paddingHorizontal: 8,\n    paddingVertical: 5,\n  },\n  dot: {\n    width: 4,\n    height: 4,\n    borderRadius: 2,\n  },\n  label: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 9,\n    color: Colors.dark.textMuted,\n  },\n  status: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 7,\n    letterSpacing: 1,\n    marginLeft: 2,\n  },\n});\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  backdropTouch: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  panel: {\n    width: PANEL_WIDTH,\n    maxHeight: '90%',\n    backgroundColor: '#0F0F0F',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.08)',\n    borderRadius: 20,\n    paddingHorizontal: 16,\n    overflow: 'hidden',\n  },\n  panelHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n  panelTitleRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  panelTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 14,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  panelContent: {\n    gap: 14,\n    paddingBottom: 20,\n  },\n  sectionCard: {\n    padding: 16,\n  },\n  sectionRow: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    justifyContent: 'space-between',\n  },\n  sectionLeft: {\n    flexDirection: 'row',\n    flex: 1,\n    gap: 10,\n    marginRight: 10,\n  },\n  sectionIconWrap: {\n    width: 34,\n    height: 34,\n    borderRadius: 10,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  sectionTextGroup: {\n    flex: 1,\n  },\n  sectionTitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    color: Colors.dark.text,\n  },\n  sectionDesc: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.textMuted,\n    marginTop: 3,\n    lineHeight: 16,\n  },\n  meterHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n    marginBottom: 10,\n  },\n  meterTitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 13,\n    color: Colors.dark.text,\n  },\n  statusGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 6,\n    marginTop: 12,\n  },\n  infoBox: {\n    marginTop: 12,\n    backgroundColor: 'rgba(255,255,255,0.02)',\n    borderRadius: 10,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.04)',\n    padding: 10,\n    gap: 6,\n  },\n  infoRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  infoLabel: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n  },\n  infoValue: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 9,\n    color: Colors.dark.textSecondary,\n    letterSpacing: 1,\n  },\n  infoDivider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n  },\n  uaDivider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    marginTop: 14,\n  },\n  uaSectionLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    letterSpacing: 3,\n    marginTop: 12,\n    marginBottom: 6,\n    marginLeft: 4,\n  },\n  uaTrigger: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.06)',\n    borderRadius: 10,\n    paddingHorizontal: 12,\n    paddingVertical: 10,\n  },\n  uaTriggerText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  uaList: {\n    marginTop: 6,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n    borderRadius: 10,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.05)',\n  },\n  uaOption: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingVertical: 10,\n    paddingHorizontal: 12,\n    borderRadius: 8,\n  },\n  uaOptionActive: {\n    backgroundColor: 'rgba(0,240,255,0.06)',\n  },\n  uaOptionText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  uaOptionTextActive: {\n    color: Colors.dark.accent,\n  },\n  cycleButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 6,\n    marginTop: 10,\n    backgroundColor: 'rgba(0,240,255,0.06)',\n    borderWidth: 1,\n    borderColor: 'rgba(0,240,255,0.15)',\n    borderRadius: 10,\n    paddingVertical: 10,\n  },\n  cycleButtonText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 10,\n    color: Colors.dark.accent,\n    letterSpacing: 2,\n  },\n  uaStringBox: {\n    marginTop: 10,\n    backgroundColor: 'rgba(0,0,0,0.3)',\n    borderRadius: 8,\n    padding: 10,\n    gap: 4,\n  },\n  uaStringLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 7,\n    color: Colors.dark.textMuted,\n    letterSpacing: 2,\n  },\n  uaString: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 9,\n    color: Colors.dark.textSecondary,\n    lineHeight: 14,\n  },\n  disclaimerRow: {\n    flexDirection: 'row',\n    gap: 8,\n    alignItems: 'flex-start',\n  },\n  disclaimerText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n    flex: 1,\n    lineHeight: 15,\n  },\n});\n","path":null,"size_bytes":20924,"size_tokens":null},"server/server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"node:http\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // put application routes here\n  // prefix all routes with /api\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n","path":null,"size_bytes":297,"size_tokens":null},"components/SecuritySuitePanel.tsx":{"content":"import React, { useEffect, useState } from 'react';\nimport { View, Text, StyleSheet, Modal, Pressable, ScrollView, Switch, Platform, Dimensions } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withTiming,\n  withSpring,\n  Easing,\n  SlideInRight,\n  SlideOutRight,\n} from 'react-native-reanimated';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport Svg, { Line, Circle, Rect } from 'react-native-svg';\nimport * as Haptics from 'expo-haptics';\nimport { GlassCard } from '@/components/GlassCard';\nimport { useVpn } from '@/lib/vpn-context';\nimport Colors from '@/constants/colors';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\nconst PANEL_WIDTH = Math.min(SCREEN_WIDTH * 0.92, 400);\n\nconst PROTOCOLS = ['WireGuard', 'OpenVPN', 'Stealth'];\n\ninterface SecuritySuitePanelProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\nfunction MultiHopVisual({ entry, exit, enabled }: { entry: string; exit: string; enabled: boolean }) {\n  const opacity = enabled ? 1 : 0.3;\n  const lineColor = enabled ? Colors.dark.accentPurple : 'rgba(255,255,255,0.1)';\n  const nodeActiveColor = enabled ? Colors.dark.accent : 'rgba(255,255,255,0.15)';\n  const hopColor = enabled ? Colors.dark.accentPurple : 'rgba(255,255,255,0.1)';\n\n  return (\n    <View style={[hopStyles.container, { opacity }]}>\n      <View style={hopStyles.row}>\n        <View style={hopStyles.nodeColumn}>\n          <View style={[hopStyles.node, { borderColor: nodeActiveColor }]}>\n            <MaterialCommunityIcons name=\"laptop\" size={16} color={nodeActiveColor} />\n          </View>\n          <Text style={hopStyles.nodeLabel}>You</Text>\n        </View>\n\n        <View style={hopStyles.lineSection}>\n          <Svg height={24} width={60}>\n            <Line x1={0} y1={12} x2={60} y2={12} stroke={lineColor} strokeWidth={1.5} strokeDasharray=\"4 3\" />\n            <Circle cx={20} cy={12} r={2} fill={lineColor} />\n            <Circle cx={40} cy={12} r={2} fill={lineColor} />\n          </Svg>\n          <Text style={[hopStyles.lineLabel, { color: lineColor }]}>AES-256</Text>\n        </View>\n\n        <View style={hopStyles.nodeColumn}>\n          <View style={[hopStyles.node, { borderColor: hopColor, backgroundColor: enabled ? 'rgba(195,0,255,0.08)' : 'transparent' }]}>\n            <Ionicons name=\"server-outline\" size={14} color={hopColor} />\n          </View>\n          <Text style={[hopStyles.nodeLabel, { color: hopColor }]} numberOfLines={1}>{entry}</Text>\n        </View>\n\n        <View style={hopStyles.lineSection}>\n          <Svg height={24} width={60}>\n            <Line x1={0} y1={12} x2={60} y2={12} stroke={hopColor} strokeWidth={1.5} strokeDasharray=\"4 3\" />\n            <Circle cx={20} cy={12} r={2} fill={hopColor} />\n            <Circle cx={40} cy={12} r={2} fill={hopColor} />\n          </Svg>\n          <Text style={[hopStyles.lineLabel, { color: hopColor }]}>ChaCha20</Text>\n        </View>\n\n        <View style={hopStyles.nodeColumn}>\n          <View style={[hopStyles.node, { borderColor: nodeActiveColor, backgroundColor: enabled ? 'rgba(0,240,255,0.08)' : 'transparent' }]}>\n            <Ionicons name=\"globe-outline\" size={14} color={nodeActiveColor} />\n          </View>\n          <Text style={[hopStyles.nodeLabel, { color: nodeActiveColor }]} numberOfLines={1}>{exit}</Text>\n        </View>\n      </View>\n    </View>\n  );\n}\n\nconst hopStyles = StyleSheet.create({\n  container: {\n    paddingVertical: 12,\n    paddingHorizontal: 4,\n  },\n  row: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  nodeColumn: {\n    alignItems: 'center',\n    gap: 4,\n    width: 52,\n  },\n  node: {\n    width: 38,\n    height: 38,\n    borderRadius: 12,\n    borderWidth: 1.5,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  nodeLabel: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    textAlign: 'center',\n  },\n  lineSection: {\n    alignItems: 'center',\n    gap: 2,\n    flex: 1,\n  },\n  lineLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 6,\n    letterSpacing: 1,\n  },\n});\n\nfunction HopServerSelector({ servers, selectedId, onSelect, label }: {\n  servers: { id: string; name: string; city: string }[];\n  selectedId: string | undefined;\n  onSelect: (id: string) => void;\n  label: string;\n}) {\n  const [expanded, setExpanded] = useState(false);\n  const selected = servers.find(s => s.id === selectedId);\n\n  return (\n    <View style={selectorStyles.container}>\n      <Text style={selectorStyles.label}>{label}</Text>\n      <Pressable\n        style={selectorStyles.trigger}\n        onPress={() => {\n          Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n          setExpanded(!expanded);\n        }}\n      >\n        <Text style={selectorStyles.triggerText}>{selected ? `${selected.name} - ${selected.city}` : 'Select'}</Text>\n        <Ionicons name={expanded ? 'chevron-up' : 'chevron-down'} size={14} color={Colors.dark.textMuted} />\n      </Pressable>\n      {expanded && (\n        <View style={selectorStyles.list}>\n          {servers.map(s => (\n            <Pressable\n              key={s.id}\n              style={[selectorStyles.option, s.id === selectedId && selectorStyles.optionActive]}\n              onPress={() => {\n                Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                onSelect(s.id);\n                setExpanded(false);\n              }}\n            >\n              <Text style={[selectorStyles.optionText, s.id === selectedId && selectorStyles.optionTextActive]}>{s.name}</Text>\n              <Text style={selectorStyles.optionCity}>{s.city}</Text>\n            </Pressable>\n          ))}\n        </View>\n      )}\n    </View>\n  );\n}\n\nconst selectorStyles = StyleSheet.create({\n  container: {\n    gap: 6,\n  },\n  label: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    letterSpacing: 2,\n    marginLeft: 4,\n  },\n  trigger: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.06)',\n    borderRadius: 10,\n    paddingHorizontal: 12,\n    paddingVertical: 10,\n  },\n  triggerText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  list: {\n    backgroundColor: 'rgba(255,255,255,0.03)',\n    borderRadius: 10,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.05)',\n    maxHeight: 150,\n  },\n  option: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    paddingVertical: 8,\n    paddingHorizontal: 12,\n    borderRadius: 8,\n  },\n  optionActive: {\n    backgroundColor: 'rgba(195,0,255,0.08)',\n  },\n  optionText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  optionTextActive: {\n    color: Colors.dark.accentPurple,\n  },\n  optionCity: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n  },\n});\n\nexport function SecuritySuitePanel({ visible, onClose }: SecuritySuitePanelProps) {\n  const insets = useSafeAreaInsets();\n  const {\n    killSwitch, setKillSwitch,\n    protocol, setProtocol,\n    doubleVpn, setDoubleVpn,\n    doubleVpnServer, setDoubleVpnServer,\n    selectedServer, servers,\n  } = useVpn();\n  const topPadding = Platform.OS === 'web' ? 67 : insets.top;\n  const bottomPadding = Platform.OS === 'web' ? 34 : insets.bottom;\n  const scale = useSharedValue(0.9);\n  const opacity = useSharedValue(0);\n\n  useEffect(() => {\n    if (visible) {\n      scale.value = withSpring(1, { damping: 20, stiffness: 200 });\n      opacity.value = withTiming(1, { duration: 200 });\n    } else {\n      scale.value = withTiming(0.9, { duration: 200 });\n      opacity.value = withTiming(0, { duration: 200 });\n    }\n  }, [visible]);\n\n  const panelAnimStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n    opacity: opacity.value,\n  }));\n\n  const entryServer = selectedServer?.name || 'Server 1';\n  const exitServer = doubleVpnServer?.name || 'Server 2';\n\n  const otherServers = servers.filter(s => s.id !== selectedServer?.id);\n\n  return (\n    <Modal\n      visible={visible}\n      transparent\n      animationType=\"fade\"\n      onRequestClose={onClose}\n      statusBarTranslucent\n    >\n      <View style={styles.overlay}>\n        <Pressable style={styles.backdropTouch} onPress={onClose} />\n        <Animated.View style={[styles.panel, panelAnimStyle, { paddingTop: 20, paddingBottom: 20 }]}>\n          <View style={styles.panelHeader}>\n            <View style={styles.panelTitleRow}>\n              <MaterialCommunityIcons name=\"shield-lock\" size={20} color={Colors.dark.accent} />\n              <Text style={styles.panelTitle}>Security Suite</Text>\n            </View>\n            <Pressable onPress={onClose} hitSlop={12}>\n              <Ionicons name=\"close\" size={22} color={Colors.dark.textSecondary} />\n            </Pressable>\n          </View>\n\n          <ScrollView showsVerticalScrollIndicator={false} contentContainerStyle={styles.panelContent}>\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={killSwitch ? Colors.dark.accentCoral : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(255,46,99,0.1)' }]}>\n                    <Ionicons name=\"warning\" size={16} color={Colors.dark.accentCoral} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>Kill Switch</Text>\n                    <Text style={styles.sectionDesc}>Instantly blocks all traffic if the VPN connection drops unexpectedly</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={killSwitch}\n                  onValueChange={(v) => {\n                    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n                    setKillSwitch(v);\n                  }}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(255,46,99,0.3)' }}\n                  thumbColor={killSwitch ? Colors.dark.accentCoral : '#555'}\n                />\n              </View>\n              {killSwitch && (\n                <View style={styles.warningBanner}>\n                  <Ionicons name=\"warning\" size={12} color={Colors.dark.accentCoral} />\n                  <Text style={styles.warningText}>All internet traffic will halt if VPN disconnects</Text>\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={doubleVpn ? Colors.dark.accentPurple : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(195,0,255,0.1)' }]}>\n                    <MaterialCommunityIcons name=\"vector-polyline\" size={16} color={Colors.dark.accentPurple} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>Double VPN</Text>\n                    <Text style={styles.sectionDesc}>Route traffic through two servers for extra encryption layers</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={doubleVpn}\n                  onValueChange={(v) => {\n                    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n                    setDoubleVpn(v);\n                  }}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(195,0,255,0.3)' }}\n                  thumbColor={doubleVpn ? Colors.dark.accentPurple : '#555'}\n                />\n              </View>\n\n              <View style={styles.hopDivider} />\n              <Text style={styles.hopSectionLabel}>MULTI-HOP PATH</Text>\n              <MultiHopVisual entry={entryServer} exit={exitServer} enabled={doubleVpn} />\n\n              {doubleVpn && (\n                <View style={styles.hopServerSelect}>\n                  <HopServerSelector\n                    servers={otherServers}\n                    selectedId={doubleVpnServer?.id}\n                    onSelect={(id) => {\n                      const s = servers.find(srv => srv.id === id) || null;\n                      setDoubleVpnServer(s);\n                    }}\n                    label=\"EXIT NODE\"\n                  />\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={Colors.dark.accent}>\n              <View style={styles.protocolHeader}>\n                <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(0,240,255,0.1)' }]}>\n                  <Ionicons name=\"shield-checkmark\" size={16} color={Colors.dark.accent} />\n                </View>\n                <View style={styles.sectionTextGroup}>\n                  <Text style={styles.sectionTitle}>Protocol</Text>\n                  <Text style={styles.sectionDesc}>Select your tunnel encryption protocol</Text>\n                </View>\n              </View>\n\n              <View style={styles.protocolGrid}>\n                {PROTOCOLS.map(p => {\n                  const isActive = protocol === p;\n                  const icon = p === 'WireGuard' ? 'flash' : p === 'OpenVPN' ? 'lock-closed' : 'eye-off';\n                  const desc = p === 'WireGuard' ? 'Fastest & modern' : p === 'OpenVPN' ? 'Battle-tested' : 'Bypass censorship';\n                  return (\n                    <Pressable\n                      key={p}\n                      style={[styles.protocolCard, isActive && styles.protocolCardActive]}\n                      onPress={() => {\n                        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                        setProtocol(p);\n                      }}\n                    >\n                      <Ionicons name={icon as any} size={18} color={isActive ? Colors.dark.accent : Colors.dark.textMuted} />\n                      <Text style={[styles.protocolName, isActive && styles.protocolNameActive]}>{p}</Text>\n                      <Text style={styles.protocolDesc}>{desc}</Text>\n                      {isActive && (\n                        <View style={styles.protocolCheck}>\n                          <Ionicons name=\"checkmark-circle\" size={14} color={Colors.dark.accent} />\n                        </View>\n                      )}\n                    </Pressable>\n                  );\n                })}\n              </View>\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"low\">\n              <View style={styles.encryptionRow}>\n                <MaterialCommunityIcons name=\"shield-key-outline\" size={18} color={Colors.dark.success} />\n                <View style={styles.sectionTextGroup}>\n                  <Text style={styles.sectionTitle}>Encryption Status</Text>\n                  <Text style={styles.sectionDesc}>AES-256-GCM with Perfect Forward Secrecy</Text>\n                </View>\n                <View style={styles.militaryBadge}>\n                  <Text style={styles.militaryBadgeText}>MILITARY</Text>\n                </View>\n              </View>\n            </GlassCard>\n          </ScrollView>\n        </Animated.View>\n      </View>\n    </Modal>\n  );\n}\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  backdropTouch: {\n    ...StyleSheet.absoluteFillObject,\n  },\n  panel: {\n    width: PANEL_WIDTH,\n    maxHeight: '90%',\n    backgroundColor: '#0F0F0F',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.08)',\n    borderRadius: 20,\n    paddingHorizontal: 16,\n    overflow: 'hidden',\n  },\n  panelHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n  panelTitleRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  panelTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 16,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  panelContent: {\n    gap: 14,\n    paddingBottom: 20,\n  },\n  sectionCard: {\n    padding: 16,\n  },\n  sectionRow: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    justifyContent: 'space-between',\n  },\n  sectionLeft: {\n    flexDirection: 'row',\n    flex: 1,\n    gap: 10,\n    marginRight: 10,\n  },\n  sectionIconWrap: {\n    width: 34,\n    height: 34,\n    borderRadius: 10,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  sectionTextGroup: {\n    flex: 1,\n  },\n  sectionTitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    color: Colors.dark.text,\n  },\n  sectionDesc: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.textMuted,\n    marginTop: 3,\n    lineHeight: 16,\n  },\n  warningBanner: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 6,\n    backgroundColor: 'rgba(255,46,99,0.06)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,46,99,0.12)',\n    borderRadius: 10,\n    padding: 10,\n    marginTop: 12,\n  },\n  warningText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.accentCoral,\n    flex: 1,\n  },\n  hopDivider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    marginTop: 14,\n  },\n  hopSectionLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    letterSpacing: 3,\n    marginTop: 12,\n    marginLeft: 4,\n  },\n  hopServerSelect: {\n    marginTop: 8,\n  },\n  protocolHeader: {\n    flexDirection: 'row',\n    gap: 10,\n    marginBottom: 14,\n  },\n  protocolGrid: {\n    gap: 8,\n  },\n  protocolCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 10,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.05)',\n    borderRadius: 12,\n    padding: 12,\n  },\n  protocolCardActive: {\n    borderColor: 'rgba(0,240,255,0.25)',\n    backgroundColor: 'rgba(0,240,255,0.04)',\n  },\n  protocolName: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 13,\n    color: Colors.dark.textSecondary,\n  },\n  protocolNameActive: {\n    color: Colors.dark.accent,\n  },\n  protocolDesc: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n    flex: 1,\n  },\n  protocolCheck: {\n    marginLeft: 'auto',\n  },\n  encryptionRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 10,\n  },\n  militaryBadge: {\n    backgroundColor: 'rgba(0,230,118,0.1)',\n    borderWidth: 1,\n    borderColor: 'rgba(0,230,118,0.2)',\n    paddingHorizontal: 8,\n    paddingVertical: 3,\n    borderRadius: 8,\n  },\n  militaryBadgeText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 7,\n    color: Colors.dark.success,\n    letterSpacing: 2,\n  },\n});\n","path":null,"size_bytes":19045,"size_tokens":null},"lib/auth-context.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport * as SecureStore from 'expo-secure-store';\nimport { Platform } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\ninterface AuthContextType {\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  user: { email: string; displayName: string } | null;\n  login: (email: string, password: string) => Promise<boolean>;\n  signup: (email: string, password: string, displayName: string) => Promise<boolean>;\n  logout: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  isAuthenticated: false,\n  isLoading: true,\n  user: null,\n  login: async () => false,\n  signup: async () => false,\n  logout: async () => {},\n});\n\nexport const useAuth = () => useContext(AuthContext);\n\nconst SESSION_KEY = 'xvpn_session';\nconst USERS_KEY = 'xvpn_users';\n\nasync function secureGet(key: string): Promise<string | null> {\n  if (Platform.OS === 'web') {\n    return AsyncStorage.getItem(key);\n  }\n  return SecureStore.getItemAsync(key);\n}\n\nasync function secureSet(key: string, value: string): Promise<void> {\n  if (Platform.OS === 'web') {\n    return AsyncStorage.setItem(key, value);\n  }\n  return SecureStore.setItemAsync(key, value);\n}\n\nasync function secureDelete(key: string): Promise<void> {\n  if (Platform.OS === 'web') {\n    return AsyncStorage.removeItem(key);\n  }\n  return SecureStore.deleteItemAsync(key);\n}\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [user, setUser] = useState<{ email: string; displayName: string } | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const session = await secureGet(SESSION_KEY);\n        if (session) {\n          const parsed = JSON.parse(session);\n          setUser(parsed);\n          setIsAuthenticated(true);\n        }\n      } catch {\n      } finally {\n        setIsLoading(false);\n      }\n    })();\n  }, []);\n\n  const getUsers = useCallback(async (): Promise<Record<string, { password: string; displayName: string }>> => {\n    try {\n      const data = await secureGet(USERS_KEY);\n      return data ? JSON.parse(data) : {};\n    } catch {\n      return {};\n    }\n  }, []);\n\n  const login = useCallback(async (email: string, password: string): Promise<boolean> => {\n    const users = await getUsers();\n    const normalizedEmail = email.toLowerCase().trim();\n    const userRecord = users[normalizedEmail];\n\n    if (!userRecord || userRecord.password !== password) {\n      return false;\n    }\n\n    const sessionData = { email: normalizedEmail, displayName: userRecord.displayName };\n    await secureSet(SESSION_KEY, JSON.stringify(sessionData));\n    setUser(sessionData);\n    setIsAuthenticated(true);\n    return true;\n  }, [getUsers]);\n\n  const signup = useCallback(async (email: string, password: string, displayName: string): Promise<boolean> => {\n    const users = await getUsers();\n    const normalizedEmail = email.toLowerCase().trim();\n\n    if (users[normalizedEmail]) {\n      return false;\n    }\n\n    users[normalizedEmail] = { password, displayName };\n    await secureSet(USERS_KEY, JSON.stringify(users));\n\n    const sessionData = { email: normalizedEmail, displayName };\n    await secureSet(SESSION_KEY, JSON.stringify(sessionData));\n    setUser(sessionData);\n    setIsAuthenticated(true);\n    return true;\n  }, [getUsers]);\n\n  const logout = useCallback(async () => {\n    await secureDelete(SESSION_KEY);\n    setUser(null);\n    setIsAuthenticated(false);\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ isAuthenticated, isLoading, user, login, signup, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n","path":null,"size_bytes":3797,"size_tokens":null},"lib/lib/fingerprint-context.tsx":{"content":"import React, { createContext, useContext, useState, useCallback, useMemo, useEffect, ReactNode } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport {\n  FingerprintShieldState,\n  DEFAULT_SHIELD_STATE,\n  UserAgentProfile,\n  getTimezoneForServer,\n  getTimezoneOffsetForServer,\n  getRandomUserAgent,\n  rotateUserAgent,\n  getShieldSummary,\n  ShieldSummary,\n} from './fingerprint-shield';\nimport { applyWebRTCMask, applyTimezoneSpoofing, applyCanvasNoise } from './fingerprint-runtime';\n\ninterface FingerprintShieldContextValue {\n  state: FingerprintShieldState;\n  summary: ShieldSummary;\n  setWebRTCMask: (enabled: boolean) => void;\n  setTimezoneSpoofing: (enabled: boolean) => void;\n  setCanvasNoise: (enabled: boolean) => void;\n  setUserAgentRotation: (enabled: boolean) => void;\n  setActiveUserAgent: (profile: UserAgentProfile) => void;\n  cycleUserAgent: () => void;\n  updateForServer: (serverFlag: string | null, city?: string) => void;\n  serverFlag: string | null;\n}\n\nconst FingerprintShieldContext = createContext<FingerprintShieldContextValue | null>(null);\n\nconst STORAGE_KEY = 'xvpn_fingerprint_shield';\n\nexport function FingerprintShieldProvider({ children }: { children: ReactNode }) {\n  const [state, setState] = useState<FingerprintShieldState>(DEFAULT_SHIELD_STATE);\n  const [serverFlag, setServerFlag] = useState<string | null>(null);\n  const [serverCity, setServerCity] = useState<string | undefined>(undefined);\n\n  useEffect(() => {\n    AsyncStorage.getItem(STORAGE_KEY).then(data => {\n      if (data) {\n        const saved = JSON.parse(data);\n        setState(prev => ({ ...prev, ...saved }));\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    applyWebRTCMask(state.webrtcMask);\n  }, [state.webrtcMask]);\n\n  useEffect(() => {\n    if (state.timezoneSpoofing && serverFlag) {\n      const tz = getTimezoneForServer(serverFlag, serverCity);\n      const offset = getTimezoneOffsetForServer(serverFlag, serverCity);\n      applyTimezoneSpoofing(true, tz, offset);\n    } else {\n      applyTimezoneSpoofing(false, null, 0);\n    }\n  }, [state.timezoneSpoofing, serverFlag, serverCity]);\n\n  useEffect(() => {\n    applyCanvasNoise(state.canvasNoise, state.canvasNoiseLevel);\n  }, [state.canvasNoise, state.canvasNoiseLevel]);\n\n  const persistState = useCallback((newState: Partial<FingerprintShieldState>) => {\n    setState(prev => {\n      const updated = { ...prev, ...newState };\n      AsyncStorage.setItem(STORAGE_KEY, JSON.stringify({\n        webrtcMask: updated.webrtcMask,\n        timezoneSpoofing: updated.timezoneSpoofing,\n        canvasNoise: updated.canvasNoise,\n        userAgentRotation: updated.userAgentRotation,\n        activeUserAgent: updated.activeUserAgent,\n        canvasNoiseLevel: updated.canvasNoiseLevel,\n      }));\n      return updated;\n    });\n  }, []);\n\n  const setWebRTCMask = useCallback((enabled: boolean) => {\n    persistState({ webrtcMask: enabled });\n  }, [persistState]);\n\n  const setTimezoneSpoofing = useCallback((enabled: boolean) => {\n    persistState({ timezoneSpoofing: enabled });\n  }, [persistState]);\n\n  const setCanvasNoise = useCallback((enabled: boolean) => {\n    persistState({ canvasNoise: enabled });\n  }, [persistState]);\n\n  const setUserAgentRotation = useCallback((enabled: boolean) => {\n    if (enabled) {\n      const ua = getRandomUserAgent(state.activeUserAgent);\n      persistState({ userAgentRotation: true, currentUserAgentString: ua });\n    } else {\n      persistState({ userAgentRotation: false, currentUserAgentString: null });\n    }\n  }, [persistState, state.activeUserAgent]);\n\n  const setActiveUserAgent = useCallback((profile: UserAgentProfile) => {\n    const ua = getRandomUserAgent(profile);\n    persistState({ activeUserAgent: profile, currentUserAgentString: state.userAgentRotation ? ua : null });\n  }, [persistState, state.userAgentRotation]);\n\n  const cycleUserAgent = useCallback(() => {\n    const nextProfile = rotateUserAgent(state.activeUserAgent);\n    const ua = getRandomUserAgent(nextProfile);\n    persistState({ activeUserAgent: nextProfile, currentUserAgentString: ua });\n  }, [persistState, state.activeUserAgent]);\n\n  const updateForServer = useCallback((flag: string | null, city?: string) => {\n    setServerFlag(flag);\n    setServerCity(city);\n    if (flag && state.timezoneSpoofing) {\n      const tz = getTimezoneForServer(flag, city);\n      setState(prev => ({ ...prev, spoofedTimezone: tz }));\n    } else {\n      setState(prev => ({ ...prev, spoofedTimezone: null }));\n    }\n  }, [state.timezoneSpoofing]);\n\n  const summary = useMemo(() => getShieldSummary(state, serverFlag), [state, serverFlag]);\n\n  const value = useMemo(() => ({\n    state,\n    summary,\n    setWebRTCMask,\n    setTimezoneSpoofing,\n    setCanvasNoise,\n    setUserAgentRotation,\n    setActiveUserAgent,\n    cycleUserAgent,\n    updateForServer,\n    serverFlag,\n  }), [state, summary, setWebRTCMask, setTimezoneSpoofing, setCanvasNoise, setUserAgentRotation, setActiveUserAgent, cycleUserAgent, updateForServer, serverFlag]);\n\n  return (\n    <FingerprintShieldContext.Provider value={value}>\n      {children}\n    </FingerprintShieldContext.Provider>\n  );\n}\n\nexport function useFingerprintShield() {\n  const ctx = useContext(FingerprintShieldContext);\n  if (!ctx) throw new Error('useFingerprintShield must be used within FingerprintShieldProvider');\n  return ctx;\n}\n","path":null,"size_bytes":5364,"size_tokens":null},"app/(tabs)/servers.tsx":{"content":"import React, { useState, useMemo } from 'react';\nimport { View, Text, TextInput, StyleSheet, FlatList, Platform, Pressable } from 'react-native';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Ionicons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport { NoiseBackground } from '@/components/NoiseBackground';\nimport { ServerCard } from '@/components/ServerCard';\nimport { SubscriptionModal } from '@/components/SubscriptionModal';\nimport { useVpn } from '@/lib/vpn-context';\nimport Colors from '@/constants/colors';\n\nexport default function ServersScreen() {\n  const insets = useSafeAreaInsets();\n  const { servers, selectedServer, selectServer, favoriteServerIds, toggleFavorite, isPremium, connect, disconnect, isConnected, isConnecting } = useVpn();\n  const [search, setSearch] = useState('');\n  const [filter, setFilter] = useState<'all' | 'favorites' | 'premium'>('all');\n  const [subscriptionVisible, setSubscriptionVisible] = useState(false);\n  const [pendingServerName, setPendingServerName] = useState<string | undefined>();\n  const topPadding = Platform.OS === 'web' ? 67 : insets.top;\n\n  const filteredServers = useMemo(() => {\n    let list = servers;\n    if (filter === 'favorites') list = list.filter(s => favoriteServerIds.includes(s.id));\n    if (filter === 'premium') list = list.filter(s => s.premium);\n    if (search.trim()) {\n      const q = search.toLowerCase();\n      list = list.filter(s =>\n        s.name.toLowerCase().includes(q) ||\n        s.country.toLowerCase().includes(q) ||\n        s.city.toLowerCase().includes(q)\n      );\n    }\n    return list.sort((a, b) => a.ping - b.ping);\n  }, [servers, filter, search, favoriteServerIds]);\n\n  const handleServerSelect = (server: typeof servers[0]) => {\n    if (server.premium && !isPremium) {\n      setPendingServerName(server.name);\n      setSubscriptionVisible(true);\n      return;\n    }\n    if (isConnected || isConnecting) {\n      disconnect();\n    }\n    selectServer(server);\n    if (Platform.OS !== 'web') {\n      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n    }\n    setTimeout(() => connect(), 100);\n  };\n\n  const FilterChip = ({ label, value }: { label: string; value: typeof filter }) => (\n    <Pressable\n      style={[styles.chip, filter === value && styles.chipActive]}\n      onPress={() => setFilter(value)}\n    >\n      <Text style={[styles.chipText, filter === value && styles.chipTextActive]}>{label}</Text>\n    </Pressable>\n  );\n\n  const premiumCount = servers.filter(s => s.premium).length;\n  const freeCount = servers.filter(s => !s.premium).length;\n\n  return (\n    <NoiseBackground>\n      <View style={[styles.container, { paddingTop: topPadding }]}>\n        <View style={styles.header}>\n          <Text style={styles.title}>Servers</Text>\n          <Text style={styles.subtitle}>\n            {servers.length} locations{isPremium ? '  All Unlocked' : ` (${freeCount} free, ${premiumCount} premium)`}\n          </Text>\n        </View>\n\n        <View style={styles.searchContainer}>\n          <Ionicons name=\"search\" size={16} color={Colors.dark.textMuted} style={styles.searchIcon} />\n          <TextInput\n            style={styles.searchInput}\n            value={search}\n            onChangeText={setSearch}\n            placeholder=\"Search locations...\"\n            placeholderTextColor={Colors.dark.textMuted}\n          />\n        </View>\n\n        <View style={styles.filterRow}>\n          <FilterChip label=\"All\" value=\"all\" />\n          <FilterChip label=\"Favorites\" value=\"favorites\" />\n          <FilterChip label=\"Premium\" value=\"premium\" />\n        </View>\n\n        <FlatList\n          data={filteredServers}\n          keyExtractor={(item) => item.id}\n          renderItem={({ item }) => (\n            <ServerCard\n              server={item}\n              isSelected={selectedServer?.id === item.id}\n              isFavorite={favoriteServerIds.includes(item.id)}\n              onSelect={() => handleServerSelect(item)}\n              onToggleFavorite={() => toggleFavorite(item.id)}\n              locked={item.premium && !isPremium}\n            />\n          )}\n          contentContainerStyle={styles.listContent}\n          showsVerticalScrollIndicator={false}\n          ListEmptyComponent={\n            <View style={styles.emptyContainer}>\n              <Ionicons name=\"globe-outline\" size={48} color={Colors.dark.textMuted} />\n              <Text style={styles.emptyText}>No servers found</Text>\n            </View>\n          }\n        />\n      </View>\n\n      <SubscriptionModal\n        visible={subscriptionVisible}\n        onClose={() => setSubscriptionVisible(false)}\n        serverName={pendingServerName}\n      />\n    </NoiseBackground>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    paddingHorizontal: 24,\n    paddingTop: 12,\n    paddingBottom: 8,\n  },\n  title: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 22,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  subtitle: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 13,\n    color: Colors.dark.textMuted,\n    marginTop: 4,\n  },\n  searchContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginHorizontal: 20,\n    marginVertical: 12,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    borderRadius: 14,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.06)',\n    paddingHorizontal: 14,\n  },\n  searchIcon: {\n    marginRight: 8,\n  },\n  searchInput: {\n    flex: 1,\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 14,\n    color: Colors.dark.text,\n    paddingVertical: 12,\n  },\n  filterRow: {\n    flexDirection: 'row',\n    paddingHorizontal: 20,\n    gap: 8,\n    marginBottom: 12,\n  },\n  chip: {\n    paddingHorizontal: 16,\n    paddingVertical: 7,\n    borderRadius: 20,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.06)',\n  },\n  chipActive: {\n    backgroundColor: 'rgba(0, 240, 255, 0.1)',\n    borderColor: 'rgba(0, 240, 255, 0.3)',\n  },\n  chipText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  chipTextActive: {\n    color: Colors.dark.accent,\n  },\n  listContent: {\n    paddingTop: 4,\n    paddingBottom: 100,\n  },\n  emptyContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingTop: 60,\n    gap: 12,\n  },\n  emptyText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 14,\n    color: Colors.dark.textMuted,\n  },\n});\n","path":null,"size_bytes":6507,"size_tokens":null},"components/WorldMap.tsx":{"content":"import React, { useEffect } from 'react';\nimport { View, StyleSheet, Dimensions, Platform } from 'react-native';\nimport Svg, { Circle, Line, Path, G, Rect } from 'react-native-svg';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withRepeat,\n  withTiming,\n  Easing,\n} from 'react-native-reanimated';\nimport Colors from '@/constants/colors';\nimport type { VpnServer } from '@/lib/vpn-context';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\nconst MAP_WIDTH = SCREEN_WIDTH - 40;\nconst MAP_HEIGHT = MAP_WIDTH * 0.48;\n\ninterface CityNode {\n  serverId: string;\n  x: number;\n  y: number;\n  name: string;\n}\n\nconst CITY_NODES: CityNode[] = [\n  { serverId: '1', x: 0.22, y: 0.32, name: 'New York' },\n  { serverId: '2', x: 0.12, y: 0.35, name: 'Los Angeles' },\n  { serverId: '3', x: 0.47, y: 0.28, name: 'London' },\n  { serverId: '4', x: 0.52, y: 0.30, name: 'Frankfurt' },\n  { serverId: '5', x: 0.85, y: 0.38, name: 'Tokyo' },\n  { serverId: '6', x: 0.78, y: 0.58, name: 'Singapore' },\n  { serverId: '7', x: 0.88, y: 0.78, name: 'Sydney' },\n  { serverId: '8', x: 0.18, y: 0.28, name: 'Toronto' },\n  { serverId: '9', x: 0.50, y: 0.29, name: 'Amsterdam' },\n  { serverId: '10', x: 0.51, y: 0.32, name: 'Zurich' },\n  { serverId: '11', x: 0.49, y: 0.31, name: 'Paris' },\n  { serverId: '12', x: 0.82, y: 0.36, name: 'Seoul' },\n  { serverId: '13', x: 0.28, y: 0.68, name: 'Sao Paulo' },\n  { serverId: '14', x: 0.70, y: 0.48, name: 'Mumbai' },\n  { serverId: '15', x: 0.53, y: 0.24, name: 'Stockholm' },\n];\n\nfunction PingNode({ cx, cy, isSelected, isConnected }: { cx: number; cy: number; isSelected: boolean; isConnected: boolean }) {\n  const pingScale = useSharedValue(1);\n  const pingOpacity = useSharedValue(0.6);\n\n  useEffect(() => {\n    if (isSelected && isConnected) {\n      pingScale.value = withRepeat(withTiming(3, { duration: 1500, easing: Easing.out(Easing.ease) }), -1, false);\n      pingOpacity.value = withRepeat(withTiming(0, { duration: 1500, easing: Easing.out(Easing.ease) }), -1, false);\n    } else if (isSelected) {\n      pingScale.value = withRepeat(withTiming(2.5, { duration: 2000, easing: Easing.out(Easing.ease) }), -1, false);\n      pingOpacity.value = withRepeat(withTiming(0, { duration: 2000, easing: Easing.out(Easing.ease) }), -1, false);\n    } else {\n      pingScale.value = withTiming(1);\n      pingOpacity.value = withTiming(0.4);\n    }\n  }, [isSelected, isConnected]);\n\n  const pingStyle = useAnimatedStyle(() => ({\n    position: 'absolute' as const,\n    left: cx - 12,\n    top: cy - 12,\n    width: 24,\n    height: 24,\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: isConnected && isSelected ? '#00E676' : Colors.dark.accent,\n    opacity: pingOpacity.value,\n    transform: [{ scale: pingScale.value }],\n  }));\n\n  return isSelected ? <Animated.View style={pingStyle} /> : null;\n}\n\ninterface WorldMapProps {\n  selectedServer: VpnServer | null;\n  isConnected: boolean;\n}\n\nexport function WorldMap({ selectedServer, isConnected }: WorldMapProps) {\n  const selectedNode = CITY_NODES.find(n => n.serverId === selectedServer?.id);\n\n  const continentPaths = [\n    'M 60 75 Q 80 60 100 65 Q 110 55 95 50 Q 80 45 70 50 Q 55 55 45 65 Q 50 75 60 75 Z',\n    'M 155 60 Q 180 45 210 55 Q 230 65 220 80 Q 200 95 175 85 Q 160 75 155 60 Z',\n    'M 260 80 Q 290 70 320 75 Q 340 85 330 100 Q 310 115 280 105 Q 260 95 260 80 Z',\n    'M 320 100 Q 350 90 370 100 Q 380 115 365 130 Q 340 140 325 125 Q 315 110 320 100 Z',\n    'M 80 110 Q 100 100 120 115 Q 115 140 95 145 Q 80 135 75 120 Q 78 112 80 110 Z',\n  ];\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.mapContainer, { width: MAP_WIDTH, height: MAP_HEIGHT }]}>\n        <Svg width={MAP_WIDTH} height={MAP_HEIGHT} viewBox={`0 0 ${MAP_WIDTH} ${MAP_HEIGHT}`}>\n          <Rect x={0} y={0} width={MAP_WIDTH} height={MAP_HEIGHT} fill=\"transparent\" />\n\n          {Array.from({ length: 8 }).map((_, i) => (\n            <Line\n              key={`grid-h-${i}`}\n              x1={0}\n              y1={(MAP_HEIGHT / 8) * (i + 1)}\n              x2={MAP_WIDTH}\n              y2={(MAP_HEIGHT / 8) * (i + 1)}\n              stroke=\"rgba(255,255,255,0.02)\"\n              strokeWidth={0.5}\n            />\n          ))}\n          {Array.from({ length: 12 }).map((_, i) => (\n            <Line\n              key={`grid-v-${i}`}\n              x1={(MAP_WIDTH / 12) * (i + 1)}\n              y1={0}\n              x2={(MAP_WIDTH / 12) * (i + 1)}\n              y2={MAP_HEIGHT}\n              stroke=\"rgba(255,255,255,0.02)\"\n              strokeWidth={0.5}\n            />\n          ))}\n\n          {CITY_NODES.map(node => {\n            const nx = node.x * MAP_WIDTH;\n            const ny = node.y * MAP_HEIGHT;\n            const isSelected = node.serverId === selectedServer?.id;\n\n            if (isSelected && selectedNode) {\n              return (\n                <G key={node.serverId}>\n                  <Circle cx={nx} cy={ny} r={isConnected ? 5 : 4} fill={isConnected ? '#00E676' : Colors.dark.accent} opacity={0.9} />\n                  <Circle cx={nx} cy={ny} r={2} fill=\"#fff\" opacity={0.8} />\n                </G>\n              );\n            }\n\n            return (\n              <G key={node.serverId}>\n                <Circle cx={nx} cy={ny} r={2.5} fill={Colors.dark.accent} opacity={0.35} />\n                <Circle cx={nx} cy={ny} r={1} fill={Colors.dark.accent} opacity={0.6} />\n              </G>\n            );\n          })}\n\n          {isConnected && selectedNode && (\n            <>\n              <Line\n                x1={MAP_WIDTH * 0.5}\n                y1={MAP_HEIGHT * 0.5}\n                x2={selectedNode.x * MAP_WIDTH}\n                y2={selectedNode.y * MAP_HEIGHT}\n                stroke={Colors.dark.accent}\n                strokeWidth={0.5}\n                strokeDasharray=\"4 4\"\n                opacity={0.3}\n              />\n              <Circle\n                cx={MAP_WIDTH * 0.5}\n                cy={MAP_HEIGHT * 0.5}\n                r={3}\n                fill={Colors.dark.accentPurple}\n                opacity={0.5}\n              />\n            </>\n          )}\n        </Svg>\n\n        {CITY_NODES.map(node => {\n          const nx = node.x * MAP_WIDTH;\n          const ny = node.y * MAP_HEIGHT;\n          const isSelected = node.serverId === selectedServer?.id;\n          return (\n            <PingNode\n              key={`ping-${node.serverId}`}\n              cx={nx}\n              cy={ny}\n              isSelected={isSelected}\n              isConnected={isConnected}\n            />\n          );\n        })}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    paddingHorizontal: 20,\n  },\n  mapContainer: {\n    backgroundColor: 'rgba(255,255,255,0.02)',\n    borderRadius: 16,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.04)',\n    overflow: 'hidden',\n    ...(Platform.OS === 'web' ? {\n      // @ts-ignore\n      backdropFilter: 'blur(10px)',\n    } : {}),\n  },\n});\n","path":null,"size_bytes":6956,"size_tokens":null},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.11\"\ndependencies = [\n    \"bcrypt>=5.0.0\",\n    \"fastapi>=0.128.8\",\n    \"pyjwt>=2.11.0\",\n    \"sqlalchemy>=2.0.46\",\n    \"uvicorn>=0.40.0\",\n]\n","path":null,"size_bytes":259,"size_tokens":null},"constants/constants/colors.ts":{"content":"const Colors = {\n  dark: {\n    background: '#0F0F0F',\n    backgroundSecondary: '#1A1A1A',\n    backgroundTertiary: '#121212',\n    surface: 'rgba(255,255,255,0.05)',\n    surfaceBorder: 'rgba(255,255,255,0.1)',\n    surfaceBorderLight: 'rgba(255,255,255,0.06)',\n    accent: '#00F0FF',\n    accentPurple: '#C300FF',\n    accentCoral: '#FF2E63',\n    text: '#FFFFFF',\n    textSecondary: '#B0B0B0',\n    textMuted: '#666666',\n    success: '#00E676',\n    warning: '#FFB300',\n    danger: '#FF2E63',\n    tabIconDefault: '#666666',\n    tint: '#00F0FF',\n    tabIconSelected: '#00F0FF',\n    gradientStart: '#0F0F0F',\n    gradientMidPurple: '#1A0033',\n    gradientMidNavy: '#001F3F',\n    glowCyan: 'rgba(0, 240, 255, 0.3)',\n    glowPurple: 'rgba(195, 0, 255, 0.3)',\n    glowCoral: 'rgba(255, 46, 99, 0.2)',\n  },\n};\n\nexport default Colors;\n","path":null,"size_bytes":821,"size_tokens":null},"components/components/FingerprintShieldPanel.tsx":{"content":"import React, { useEffect, useState } from 'react';\nimport { View, Text, StyleSheet, Modal, Pressable, ScrollView, Switch, Platform, Dimensions } from 'react-native';\nimport Animated, {\n  useSharedValue,\n  useAnimatedStyle,\n  withSpring,\n  withTiming,\n} from 'react-native-reanimated';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\nimport { Ionicons, MaterialCommunityIcons } from '@expo/vector-icons';\nimport * as Haptics from 'expo-haptics';\nimport { GlassCard } from '@/components/GlassCard';\nimport { useFingerprintShield } from '@/lib/fingerprint-context';\nimport { USER_AGENT_LABELS, UserAgentProfile } from '@/lib/fingerprint-shield';\nimport Colors from '@/constants/colors';\n\nconst { width: SCREEN_WIDTH } = Dimensions.get('window');\nconst PANEL_WIDTH = Math.min(SCREEN_WIDTH * 0.92, 400);\n\nconst UA_PROFILES: UserAgentProfile[] = ['windows_chrome', 'windows_firefox', 'mac_safari', 'mac_chrome', 'iphone_safari'];\n\ninterface FingerprintShieldPanelProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\nfunction ProtectionMeter({ active, total }: { active: number; total: number }) {\n  const segments = Array.from({ length: total }, (_, i) => i < active);\n  const levelColor = active === 4 ? Colors.dark.success : active >= 2 ? Colors.dark.warning : active >= 1 ? Colors.dark.accentCoral : Colors.dark.textMuted;\n  const levelLabel = active === 4 ? 'MAXIMUM' : active >= 2 ? 'MODERATE' : active >= 1 ? 'BASIC' : 'NONE';\n\n  return (\n    <View style={meterStyles.container}>\n      <View style={meterStyles.barRow}>\n        {segments.map((filled, i) => (\n          <View\n            key={i}\n            style={[\n              meterStyles.segment,\n              { backgroundColor: filled ? levelColor : 'rgba(255,255,255,0.06)' },\n            ]}\n          />\n        ))}\n      </View>\n      <View style={meterStyles.labelRow}>\n        <Text style={[meterStyles.levelText, { color: levelColor }]}>{levelLabel}</Text>\n        <Text style={meterStyles.countText}>{active}/{total} active</Text>\n      </View>\n    </View>\n  );\n}\n\nconst meterStyles = StyleSheet.create({\n  container: {\n    gap: 6,\n  },\n  barRow: {\n    flexDirection: 'row',\n    gap: 3,\n  },\n  segment: {\n    flex: 1,\n    height: 4,\n    borderRadius: 2,\n  },\n  labelRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  levelText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    letterSpacing: 2,\n  },\n  countText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n  },\n});\n\nexport function FingerprintShieldPanel({ visible, onClose }: FingerprintShieldPanelProps) {\n  const insets = useSafeAreaInsets();\n  const {\n    state,\n    summary,\n    setWebRTCMask,\n    setTimezoneSpoofing,\n    setCanvasNoise,\n    setUserAgentRotation,\n    setActiveUserAgent,\n    cycleUserAgent,\n  } = useFingerprintShield();\n\n  const topPadding = Platform.OS === 'web' ? 67 : insets.top;\n  const bottomPadding = Platform.OS === 'web' ? 34 : insets.bottom;\n  const slideX = useSharedValue(PANEL_WIDTH);\n  const [uaExpanded, setUaExpanded] = useState(false);\n\n  useEffect(() => {\n    if (visible) {\n      slideX.value = withSpring(0, { damping: 20, stiffness: 200 });\n    } else {\n      slideX.value = withTiming(PANEL_WIDTH, { duration: 250 });\n    }\n  }, [visible]);\n\n  const panelAnimStyle = useAnimatedStyle(() => ({\n    transform: [{ translateX: slideX.value }],\n  }));\n\n  const hapticToggle = (fn: (v: boolean) => void) => (v: boolean) => {\n    if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    fn(v);\n  };\n\n  return (\n    <Modal\n      visible={visible}\n      transparent\n      animationType=\"fade\"\n      onRequestClose={onClose}\n      statusBarTranslucent\n    >\n      <View style={styles.overlay}>\n        <Pressable style={styles.backdropTouch} onPress={onClose} />\n        <Animated.View style={[styles.panel, panelAnimStyle, { paddingTop: topPadding + 12, paddingBottom: bottomPadding + 12 }]}>\n          <View style={styles.panelHeader}>\n            <View style={styles.panelTitleRow}>\n              <MaterialCommunityIcons name=\"fingerprint\" size={20} color={Colors.dark.accent} />\n              <Text style={styles.panelTitle}>Fingerprint Shield</Text>\n            </View>\n            <Pressable onPress={onClose} hitSlop={12}>\n              <Ionicons name=\"close\" size={22} color={Colors.dark.textSecondary} />\n            </Pressable>\n          </View>\n\n          <ScrollView showsVerticalScrollIndicator={false} contentContainerStyle={styles.panelContent}>\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={Colors.dark.accent}>\n              <View style={styles.meterHeader}>\n                <MaterialCommunityIcons name=\"shield-check\" size={16} color={Colors.dark.accent} />\n                <Text style={styles.meterTitle}>Protection Level</Text>\n              </View>\n              <ProtectionMeter active={summary.activeProtections} total={summary.totalProtections} />\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={state.webrtcMask ? Colors.dark.accentCoral : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(255,46,99,0.1)' }]}>\n                    <MaterialCommunityIcons name=\"web-remove\" size={16} color={Colors.dark.accentCoral} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>WebRTC Mask</Text>\n                    <Text style={styles.sectionDesc}>Blocks STUN queries from leaking your real local IP address through WebRTC</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={state.webrtcMask}\n                  onValueChange={hapticToggle(setWebRTCMask)}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(255,46,99,0.3)' }}\n                  thumbColor={state.webrtcMask ? Colors.dark.accentCoral : '#555'}\n                />\n              </View>\n              {state.webrtcMask && (\n                <View style={styles.statusGrid}>\n                  <StatusPill label=\"Local IP\" status=\"Hidden\" color={Colors.dark.success} />\n                  <StatusPill label=\"STUN\" status=\"Blocked\" color={Colors.dark.success} />\n                  <StatusPill label=\"TURN\" status=\"Blocked\" color={Colors.dark.success} />\n                  <StatusPill label=\"mDNS\" status=\"Enabled\" color={Colors.dark.success} />\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={state.timezoneSpoofing ? Colors.dark.accentPurple : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(195,0,255,0.1)' }]}>\n                    <Ionicons name=\"time-outline\" size={16} color={Colors.dark.accentPurple} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>Timezone Spoofing</Text>\n                    <Text style={styles.sectionDesc}>Syncs browser timezone to match your selected VPN server location</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={state.timezoneSpoofing}\n                  onValueChange={hapticToggle(setTimezoneSpoofing)}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(195,0,255,0.3)' }}\n                  thumbColor={state.timezoneSpoofing ? Colors.dark.accentPurple : '#555'}\n                />\n              </View>\n              {state.timezoneSpoofing && summary.timezone.spoofedTimezone && (\n                <View style={styles.infoBox}>\n                  <View style={styles.infoRow}>\n                    <Text style={styles.infoLabel}>Original</Text>\n                    <Text style={styles.infoValue}>{summary.timezone.originalTimezone}</Text>\n                  </View>\n                  <View style={styles.infoDivider} />\n                  <View style={styles.infoRow}>\n                    <Text style={styles.infoLabel}>Spoofed To</Text>\n                    <Text style={[styles.infoValue, { color: Colors.dark.accentPurple }]}>{summary.timezone.spoofedTimezone}</Text>\n                  </View>\n                  <View style={styles.infoDivider} />\n                  <View style={styles.statusGrid}>\n                    <StatusPill label=\"Intl API\" status=\"Patched\" color={Colors.dark.success} />\n                    <StatusPill label=\"Date API\" status=\"Patched\" color={Colors.dark.success} />\n                  </View>\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={state.canvasNoise ? Colors.dark.warning : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(255,179,0,0.1)' }]}>\n                    <MaterialCommunityIcons name=\"image-filter-hdr\" size={16} color={Colors.dark.warning} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>Canvas Defeat</Text>\n                    <Text style={styles.sectionDesc}>Injects subtle noise into Canvas rendering to prevent GPU/hardware fingerprinting</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={state.canvasNoise}\n                  onValueChange={hapticToggle(setCanvasNoise)}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(255,179,0,0.3)' }}\n                  thumbColor={state.canvasNoise ? Colors.dark.warning : '#555'}\n                />\n              </View>\n              {state.canvasNoise && (\n                <View style={styles.statusGrid}>\n                  <StatusPill label=\"Noise\" status={`${(state.canvasNoiseLevel * 100).toFixed(0)}%`} color={Colors.dark.warning} />\n                  <StatusPill label=\"Hash\" status=\"Randomized\" color={Colors.dark.success} />\n                  <StatusPill label=\"GPU Info\" status=\"Masked\" color={Colors.dark.success} />\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"medium\" glowColor={state.userAgentRotation ? Colors.dark.accent : undefined}>\n              <View style={styles.sectionRow}>\n                <View style={styles.sectionLeft}>\n                  <View style={[styles.sectionIconWrap, { backgroundColor: 'rgba(0,240,255,0.1)' }]}>\n                    <MaterialCommunityIcons name=\"account-switch\" size={16} color={Colors.dark.accent} />\n                  </View>\n                  <View style={styles.sectionTextGroup}>\n                    <Text style={styles.sectionTitle}>User-Agent Rotation</Text>\n                    <Text style={styles.sectionDesc}>Cycles between common browser strings to appear as a standard retail user</Text>\n                  </View>\n                </View>\n                <Switch\n                  value={state.userAgentRotation}\n                  onValueChange={hapticToggle(setUserAgentRotation)}\n                  trackColor={{ false: 'rgba(255,255,255,0.1)', true: 'rgba(0,240,255,0.3)' }}\n                  thumbColor={state.userAgentRotation ? Colors.dark.accent : '#555'}\n                />\n              </View>\n\n              <View style={styles.uaDivider} />\n              <Text style={styles.uaSectionLabel}>BROWSER PROFILE</Text>\n\n              <Pressable\n                style={styles.uaTrigger}\n                onPress={() => {\n                  if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                  setUaExpanded(!uaExpanded);\n                }}\n              >\n                <Text style={styles.uaTriggerText}>{USER_AGENT_LABELS[state.activeUserAgent]}</Text>\n                <Ionicons name={uaExpanded ? 'chevron-up' : 'chevron-down'} size={14} color={Colors.dark.textMuted} />\n              </Pressable>\n\n              {uaExpanded && (\n                <View style={styles.uaList}>\n                  {UA_PROFILES.map(profile => {\n                    const isActive = state.activeUserAgent === profile;\n                    return (\n                      <Pressable\n                        key={profile}\n                        style={[styles.uaOption, isActive && styles.uaOptionActive]}\n                        onPress={() => {\n                          if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n                          setActiveUserAgent(profile);\n                          setUaExpanded(false);\n                        }}\n                      >\n                        <Text style={[styles.uaOptionText, isActive && styles.uaOptionTextActive]}>\n                          {USER_AGENT_LABELS[profile]}\n                        </Text>\n                        {isActive && <Ionicons name=\"checkmark-circle\" size={14} color={Colors.dark.accent} />}\n                      </Pressable>\n                    );\n                  })}\n                </View>\n              )}\n\n              {state.userAgentRotation && (\n                <Pressable\n                  style={styles.cycleButton}\n                  onPress={() => {\n                    if (Platform.OS !== 'web') Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n                    cycleUserAgent();\n                  }}\n                >\n                  <MaterialCommunityIcons name=\"refresh\" size={14} color={Colors.dark.accent} />\n                  <Text style={styles.cycleButtonText}>Rotate Now</Text>\n                </Pressable>\n              )}\n\n              {state.userAgentRotation && state.currentUserAgentString && (\n                <View style={styles.uaStringBox}>\n                  <Text style={styles.uaStringLabel}>ACTIVE UA STRING</Text>\n                  <Text style={styles.uaString} numberOfLines={2}>{state.currentUserAgentString}</Text>\n                </View>\n              )}\n            </GlassCard>\n\n            <GlassCard style={styles.sectionCard} intensity=\"low\">\n              <View style={styles.disclaimerRow}>\n                <Ionicons name=\"information-circle-outline\" size={16} color={Colors.dark.textMuted} />\n                <Text style={styles.disclaimerText}>\n                  Client-side fingerprint shield works alongside the server-side protection engine for comprehensive anti-tracking defense.\n                </Text>\n              </View>\n            </GlassCard>\n          </ScrollView>\n        </Animated.View>\n      </View>\n    </Modal>\n  );\n}\n\nfunction StatusPill({ label, status, color }: { label: string; status: string; color: string }) {\n  return (\n    <View style={pillStyles.container}>\n      <View style={[pillStyles.dot, { backgroundColor: color }]} />\n      <Text style={pillStyles.label}>{label}</Text>\n      <Text style={[pillStyles.status, { color }]}>{status}</Text>\n    </View>\n  );\n}\n\nconst pillStyles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.05)',\n    borderRadius: 8,\n    paddingHorizontal: 8,\n    paddingVertical: 5,\n  },\n  dot: {\n    width: 4,\n    height: 4,\n    borderRadius: 2,\n  },\n  label: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 9,\n    color: Colors.dark.textMuted,\n  },\n  status: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 7,\n    letterSpacing: 1,\n    marginLeft: 2,\n  },\n});\n\nconst styles = StyleSheet.create({\n  overlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n  },\n  backdropTouch: {\n    flex: 1,\n  },\n  panel: {\n    width: PANEL_WIDTH,\n    backgroundColor: '#0F0F0F',\n    borderLeftWidth: 1,\n    borderColor: 'rgba(255,255,255,0.06)',\n    paddingHorizontal: 16,\n  },\n  panelHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 20,\n  },\n  panelTitleRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n  },\n  panelTitle: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 14,\n    color: Colors.dark.text,\n    letterSpacing: 2,\n  },\n  panelContent: {\n    gap: 14,\n    paddingBottom: 20,\n  },\n  sectionCard: {\n    padding: 16,\n  },\n  sectionRow: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    justifyContent: 'space-between',\n  },\n  sectionLeft: {\n    flexDirection: 'row',\n    flex: 1,\n    gap: 10,\n    marginRight: 10,\n  },\n  sectionIconWrap: {\n    width: 34,\n    height: 34,\n    borderRadius: 10,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  sectionTextGroup: {\n    flex: 1,\n  },\n  sectionTitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 14,\n    color: Colors.dark.text,\n  },\n  sectionDesc: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 11,\n    color: Colors.dark.textMuted,\n    marginTop: 3,\n    lineHeight: 16,\n  },\n  meterHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8,\n    marginBottom: 10,\n  },\n  meterTitle: {\n    fontFamily: 'SpaceGrotesk_600SemiBold',\n    fontSize: 13,\n    color: Colors.dark.text,\n  },\n  statusGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 6,\n    marginTop: 12,\n  },\n  infoBox: {\n    marginTop: 12,\n    backgroundColor: 'rgba(255,255,255,0.02)',\n    borderRadius: 10,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.04)',\n    padding: 10,\n    gap: 6,\n  },\n  infoRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  infoLabel: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n  },\n  infoValue: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 9,\n    color: Colors.dark.textSecondary,\n    letterSpacing: 1,\n  },\n  infoDivider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n  },\n  uaDivider: {\n    height: 1,\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    marginTop: 14,\n  },\n  uaSectionLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 8,\n    color: Colors.dark.textMuted,\n    letterSpacing: 3,\n    marginTop: 12,\n    marginBottom: 6,\n    marginLeft: 4,\n  },\n  uaTrigger: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    backgroundColor: 'rgba(255,255,255,0.04)',\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.06)',\n    borderRadius: 10,\n    paddingHorizontal: 12,\n    paddingVertical: 10,\n  },\n  uaTriggerText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  uaList: {\n    marginTop: 6,\n    backgroundColor: 'rgba(255,255,255,0.03)',\n    borderRadius: 10,\n    borderWidth: 1,\n    borderColor: 'rgba(255,255,255,0.05)',\n  },\n  uaOption: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingVertical: 10,\n    paddingHorizontal: 12,\n    borderRadius: 8,\n  },\n  uaOptionActive: {\n    backgroundColor: 'rgba(0,240,255,0.06)',\n  },\n  uaOptionText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 12,\n    color: Colors.dark.textSecondary,\n  },\n  uaOptionTextActive: {\n    color: Colors.dark.accent,\n  },\n  cycleButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    gap: 6,\n    marginTop: 10,\n    backgroundColor: 'rgba(0,240,255,0.06)',\n    borderWidth: 1,\n    borderColor: 'rgba(0,240,255,0.15)',\n    borderRadius: 10,\n    paddingVertical: 10,\n  },\n  cycleButtonText: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 10,\n    color: Colors.dark.accent,\n    letterSpacing: 2,\n  },\n  uaStringBox: {\n    marginTop: 10,\n    backgroundColor: 'rgba(0,0,0,0.3)',\n    borderRadius: 8,\n    padding: 10,\n    gap: 4,\n  },\n  uaStringLabel: {\n    fontFamily: 'Orbitron_700Bold',\n    fontSize: 7,\n    color: Colors.dark.textMuted,\n    letterSpacing: 2,\n  },\n  uaString: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 9,\n    color: Colors.dark.textSecondary,\n    lineHeight: 14,\n  },\n  disclaimerRow: {\n    flexDirection: 'row',\n    gap: 8,\n    alignItems: 'flex-start',\n  },\n  disclaimerText: {\n    fontFamily: 'SpaceGrotesk_400Regular',\n    fontSize: 10,\n    color: Colors.dark.textMuted,\n    flex: 1,\n    lineHeight: 15,\n  },\n});\n","path":null,"size_bytes":20698,"size_tokens":null}},"version":2}